{"file_contents":{"MLStudio-main/server/models/MaterialImage.js":{"content":"import mongoose from 'mongoose';\n\nconst materialImageSchema = new mongoose.Schema({\n  filename: { type: String, required: true },\n  material_key: { type: String, required: true, index: true },\n  material_official: { type: String, required: true },\n  data: { type: Buffer, required: true },\n  content_type: { type: String, default: 'image/jpeg' },\n  width: { type: Number, default: 224 },\n  height: { type: Number, default: 224 },\n  embodied_energy_mj_per_kg: { type: Number, default: null },\n  embodied_energy_mj_per_m2: { type: Number, default: null },\n  embodied_energy_mj_per_item: { type: Number, default: null },\n  embodied_carbon_kgco2_kg: { type: Number, default: null },\n  embodied_carbon_kgco2_m2: { type: Number, default: null },\n  embodied_carbon_kgco2_item: { type: Number, default: null },\n  density_kg_m3: { type: Number, default: null },\n  weight_kg_m2: { type: Number, default: null },\n  source: { type: String, default: null },\n  segmentation_mask: { type: Buffer, default: null },\n  regions: [{\n    material_key: String,\n    bbox: [Number],\n    confidence: Number\n  }],\n  createdAt: { type: Date, default: Date.now }\n});\n\nmaterialImageSchema.index({ material_key: 1, createdAt: -1 });\n\nexport default mongoose.model('MaterialImage', materialImageSchema);\n","path":null,"size_bytes":1273,"size_tokens":null},"client/src/pages/profile.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Link, useLocation } from \"wouter\";\nimport { ArrowLeft, Camera, Save, Loader2, User, CreditCard, Settings as SettingsIcon } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { Badge } from \"@/components/ui/badge\";\n\nexport default function Profile() {\n  const { user, updateUser, uploadAvatar } = useAuth();\n  const [isSaving, setIsSaving] = useState(false);\n  const [isUploading, setIsUploading] = useState(false);\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  const [formData, setFormData] = useState({\n    firstName: '',\n    lastName: '',\n    email: '',\n    company: '',\n    jobTitle: '',\n    bio: ''\n  });\n\n  useEffect(() => {\n    if (user) {\n      setFormData({\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        email: user.email || '',\n        company: user.company || '',\n        jobTitle: user.jobTitle || '',\n        bio: user.bio || ''\n      });\n    }\n  }, [user]);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleSave = async () => {\n    if (!user) return;\n    \n    setIsSaving(true);\n    try {\n      await updateUser({\n        firstName: formData.firstName,\n        lastName: formData.lastName,\n        company: formData.company,\n        jobTitle: formData.jobTitle,\n        bio: formData.bio\n      });\n      toast({\n        title: \"Profile Updated\",\n        description: \"Your changes have been saved successfully.\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Update Failed\",\n        description: error.message || \"Failed to update profile\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleAvatarClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleAvatarChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"Invalid File\",\n        description: \"Please select an image file\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setIsUploading(true);\n    try {\n      await uploadAvatar(file);\n      toast({\n        title: \"Avatar Updated\",\n        description: \"Your profile picture has been changed.\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Upload Failed\",\n        description: error.message || \"Failed to upload avatar\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const getPlanBadgeVariant = (): \"default\" | \"secondary\" | \"outline\" => {\n    switch (user?.subscriptionPlan) {\n      case 'pro': return 'default';\n      case 'enterprise': return 'secondary';\n      default: return 'outline';\n    }\n  };\n\n  const getPlanLabel = () => {\n    switch (user?.subscriptionPlan) {\n      case 'pro': return 'Pro Plan';\n      case 'enterprise': return 'Enterprise';\n      default: return 'Free Plan';\n    }\n  };\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <motion.div \n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.4 }}\n        className=\"container mx-auto px-4 pt-8\"\n      >\n        <div className=\"flex items-center justify-between gap-4 mb-8 flex-wrap\">\n          <div>\n            <Link href=\"/dashboard\">\n              <Button variant=\"ghost\" className=\"mb-2 pl-0 hover:pl-2 transition-all text-muted-foreground\" data-testid=\"button-back-dashboard\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Dashboard\n              </Button>\n            </Link>\n            <h1 className=\"text-3xl font-display font-bold\">Account Settings</h1>\n            <p className=\"text-muted-foreground\">Manage your profile and preferences.</p>\n          </div>\n          <Button onClick={handleSave} disabled={isSaving} data-testid=\"button-save-profile\">\n            {isSaving ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\n            {isSaving ? \"Saving...\" : \"Save Changes\"}\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\n          <Card className=\"h-fit border-none shadow-md lg:col-span-1 overflow-hidden\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex flex-col items-center text-center mb-6\">\n                <div className=\"relative mb-4 group\">\n                  <Avatar className=\"h-24 w-24 border-2 border-primary/20 transition-transform group-hover:scale-105\">\n                    <AvatarImage src={user.avatar} alt={`${user.firstName} ${user.lastName}`} />\n                    <AvatarFallback className=\"text-xl font-bold\">\n                      {user.firstName?.charAt(0)}{user.lastName?.charAt(0)}\n                    </AvatarFallback>\n                  </Avatar>\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleAvatarChange}\n                    className=\"hidden\"\n                    data-testid=\"input-avatar-upload\"\n                  />\n                  <Button \n                    size=\"icon\" \n                    variant=\"secondary\" \n                    className=\"absolute bottom-0 right-0 rounded-full\"\n                    onClick={handleAvatarClick}\n                    disabled={isUploading}\n                    data-testid=\"button-change-avatar\"\n                  >\n                    {isUploading ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      <Camera className=\"h-4 w-4\" />\n                    )}\n                  </Button>\n                </div>\n                <h2 className=\"font-display font-bold text-xl\" data-testid=\"text-user-name\">\n                  {user.firstName} {user.lastName}\n                </h2>\n                <p className=\"text-sm text-muted-foreground\" data-testid=\"text-user-title\">\n                  {user.jobTitle || 'No title set'}\n                </p>\n                <Badge variant={getPlanBadgeVariant()} className=\"mt-3\" data-testid=\"badge-subscription-plan\">\n                  {getPlanLabel()}\n                </Badge>\n              </div>\n              \n              <div className=\"space-y-1\">\n                <Button \n                  variant=\"ghost\" \n                  className=\"w-full justify-start font-medium bg-secondary/50 text-primary\"\n                  data-testid=\"button-nav-profile\"\n                >\n                  <User className=\"w-4 h-4 mr-2\" /> Profile\n                </Button>\n                <Button \n                  variant=\"ghost\" \n                  className=\"w-full justify-start font-medium\" \n                  onClick={() => setLocation(\"/subscription\")}\n                  data-testid=\"button-nav-subscription\"\n                >\n                  <CreditCard className=\"w-4 h-4 mr-2\" /> Subscription\n                </Button>\n                <Button \n                  variant=\"ghost\" \n                  className=\"w-full justify-start font-medium\" \n                  onClick={() => setLocation(\"/settings\")}\n                  data-testid=\"button-nav-settings\"\n                >\n                  <SettingsIcon className=\"w-4 h-4 mr-2\" /> Preferences\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n\n          <div className=\"lg:col-span-3 space-y-6\">\n            <motion.div\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.1 }}\n            >\n              <Card className=\"border-none shadow-md\">\n                <CardHeader>\n                  <CardTitle>Personal Information</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"firstName\">First Name</Label>\n                      <Input \n                        id=\"firstName\" \n                        name=\"firstName\"\n                        value={formData.firstName}\n                        onChange={handleInputChange}\n                        className=\"bg-secondary/20\"\n                        data-testid=\"input-first-name\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"lastName\">Last Name</Label>\n                      <Input \n                        id=\"lastName\" \n                        name=\"lastName\"\n                        value={formData.lastName}\n                        onChange={handleInputChange}\n                        className=\"bg-secondary/20\"\n                        data-testid=\"input-last-name\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"email\">Email Address</Label>\n                    <Input \n                      id=\"email\" \n                      name=\"email\"\n                      value={formData.email}\n                      disabled\n                      className=\"bg-secondary/20 opacity-60\"\n                      data-testid=\"input-email\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">Email cannot be changed</p>\n                  </div>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"company\">Company / Organization</Label>\n                      <Input \n                        id=\"company\" \n                        name=\"company\"\n                        value={formData.company}\n                        onChange={handleInputChange}\n                        placeholder=\"Enter your company name\"\n                        className=\"bg-secondary/20\"\n                        data-testid=\"input-company\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"jobTitle\">Job Title</Label>\n                      <Input \n                        id=\"jobTitle\" \n                        name=\"jobTitle\"\n                        value={formData.jobTitle}\n                        onChange={handleInputChange}\n                        placeholder=\"Enter your job title\"\n                        className=\"bg-secondary/20\"\n                        data-testid=\"input-job-title\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"bio\">Bio</Label>\n                    <Textarea \n                      id=\"bio\"\n                      name=\"bio\"\n                      value={formData.bio}\n                      onChange={handleInputChange}\n                      placeholder=\"Tell us a bit about yourself...\"\n                      className=\"min-h-[100px] bg-secondary/20 resize-none\"\n                      data-testid=\"input-bio\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">{formData.bio.length}/500 characters</p>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.2 }}\n            >\n              <Card className=\"border-none shadow-md\">\n                <CardHeader>\n                  <CardTitle>Account Statistics</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                    <div className=\"p-4 bg-secondary/30 rounded-lg text-center\">\n                      <p className=\"text-2xl font-bold text-primary\" data-testid=\"stat-total-scans\">\n                        {user.totalScans}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">Total Scans</p>\n                    </div>\n                    <div className=\"p-4 bg-secondary/30 rounded-lg text-center\">\n                      <p className=\"text-2xl font-bold text-green-600\" data-testid=\"stat-carbon-saved\">\n                        {user.carbonSaved.toFixed(1)}kg\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">Carbon Saved</p>\n                    </div>\n                    <div className=\"p-4 bg-secondary/30 rounded-lg text-center\">\n                      <p className=\"text-2xl font-bold capitalize\" data-testid=\"stat-subscription-status\">\n                        {user.subscriptionStatus}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">Account Status</p>\n                    </div>\n                    <div className=\"p-4 bg-secondary/30 rounded-lg text-center\">\n                      <p className=\"text-2xl font-bold capitalize\" data-testid=\"stat-plan\">\n                        {user.subscriptionPlan}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">Current Plan</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          </div>\n        </div>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":14381,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1522,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"@neondatabase/serverless\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1439,"size_tokens":null},"MLStudio-main/server/config/materials.js":{"content":"import CustomMaterial from '../models/CustomMaterial.js';\n\nexport const ICE_MATERIALS = {\n  bricks: {\n    key: 'bricks',\n    name: 'Bricks (common)',\n    description: 'Common clay bricks used in construction',\n    embodiedEnergy_MJ_kg: 3.0,\n    embodiedCarbon_kgCO2_kg: 0.24,\n    density_kg_m3: 1700,\n    alternatives: ['concrete_block', 'aerated_block']\n  },\n  concrete: {\n    key: 'concrete',\n    name: 'Concrete (1:1.5:3 eg in-situ floor slabs, structure)',\n    description: 'Standard mix concrete for structural elements',\n    embodiedEnergy_MJ_kg: 0.95,\n    embodiedCarbon_kgCO2_kg: 0.13,\n    density_kg_m3: 2400,\n    alternatives: ['rammed_earth', 'limestone_block']\n  },\n  aggregate: {\n    key: 'aggregate',\n    name: 'Aggregate',\n    description: 'Crushed stone or gravel for construction',\n    embodiedEnergy_MJ_kg: 0.083,\n    embodiedCarbon_kgCO2_kg: 0.0048,\n    density_kg_m3: 1500,\n    alternatives: []\n  },\n  aerated_block: {\n    key: 'aerated_block',\n    name: 'Aerated block',\n    description: 'Autoclaved aerated concrete blocks',\n    embodiedEnergy_MJ_kg: 3.5,\n    embodiedCarbon_kgCO2_kg: 0.30,\n    density_kg_m3: 600,\n    alternatives: ['concrete_block', 'bricks']\n  },\n  concrete_block: {\n    key: 'concrete_block',\n    name: 'Concrete block (Medium density 10 N/mm2)',\n    description: 'Medium density concrete masonry blocks',\n    embodiedEnergy_MJ_kg: 0.67,\n    embodiedCarbon_kgCO2_kg: 0.073,\n    density_kg_m3: 1350,\n    alternatives: ['bricks', 'aerated_block']\n  },\n  limestone_block: {\n    key: 'limestone_block',\n    name: 'Limestone block',\n    description: 'Natural limestone building blocks',\n    embodiedEnergy_MJ_kg: 0.85,\n    embodiedCarbon_kgCO2_kg: 0.017,\n    density_kg_m3: 2180,\n    alternatives: ['concrete', 'rammed_earth']\n  },\n  rammed_earth: {\n    key: 'rammed_earth',\n    name: 'Rammed earth (no cement content)',\n    description: 'Compacted earth construction without cement',\n    embodiedEnergy_MJ_kg: 0.45,\n    embodiedCarbon_kgCO2_kg: 0.023,\n    density_kg_m3: 1900,\n    alternatives: ['concrete', 'limestone_block']\n  },\n  timber: {\n    key: 'timber',\n    name: 'Timber (general â€“ excludes sequestration)',\n    description: 'General timber products',\n    embodiedEnergy_MJ_kg: 8.5,\n    embodiedCarbon_kgCO2_kg: 0.46,\n    density_kg_m3: 600,\n    alternatives: []\n  },\n  steel: {\n    key: 'steel',\n    name: 'Steel (general - average recycled content)',\n    description: 'General steel products with average recycled content',\n    embodiedEnergy_MJ_kg: 20.1,\n    embodiedCarbon_kgCO2_kg: 1.37,\n    density_kg_m3: 7850,\n    alternatives: ['timber']\n  },\n  glass: {\n    key: 'glass',\n    name: 'Glass (float)',\n    description: 'Float glass for windows and facades',\n    embodiedEnergy_MJ_kg: 15.0,\n    embodiedCarbon_kgCO2_kg: 0.85,\n    density_kg_m3: 2500,\n    alternatives: []\n  },\n  aluminum: {\n    key: 'aluminum',\n    name: 'Aluminum (general)',\n    description: 'General aluminum products',\n    embodiedEnergy_MJ_kg: 155,\n    embodiedCarbon_kgCO2_kg: 8.24,\n    density_kg_m3: 2700,\n    alternatives: ['steel']\n  },\n  insulation_mineral_wool: {\n    key: 'insulation_mineral_wool',\n    name: 'Mineral wool insulation',\n    description: 'Mineral wool thermal insulation',\n    embodiedEnergy_MJ_kg: 16.6,\n    embodiedCarbon_kgCO2_kg: 1.28,\n    density_kg_m3: 30,\n    alternatives: ['insulation_cellulose']\n  },\n  insulation_cellulose: {\n    key: 'insulation_cellulose',\n    name: 'Cellulose insulation',\n    description: 'Recycled paper cellulose insulation',\n    embodiedEnergy_MJ_kg: 0.94,\n    embodiedCarbon_kgCO2_kg: 0.06,\n    density_kg_m3: 45,\n    alternatives: ['insulation_mineral_wool']\n  },\n  plasterboard: {\n    key: 'plasterboard',\n    name: 'Plasterboard (gypsum)',\n    description: 'Gypsum plasterboard for walls and ceilings',\n    embodiedEnergy_MJ_kg: 6.75,\n    embodiedCarbon_kgCO2_kg: 0.38,\n    density_kg_m3: 800,\n    alternatives: []\n  },\n  ceramic_tiles: {\n    key: 'ceramic_tiles',\n    name: 'Ceramic tiles',\n    description: 'Ceramic tiles for floors and walls',\n    embodiedEnergy_MJ_kg: 12.0,\n    embodiedCarbon_kgCO2_kg: 0.78,\n    density_kg_m3: 2000,\n    alternatives: []\n  }\n};\n\nexport const MATERIAL_KEYS = Object.keys(ICE_MATERIALS);\nexport const MATERIAL_NAMES = Object.values(ICE_MATERIALS).map(m => m.name);\n\nexport async function getMaterialByKey(key) {\n  if (ICE_MATERIALS[key]) {\n    return ICE_MATERIALS[key];\n  }\n  \n  try {\n    const customMaterial = await CustomMaterial.findOne({ key });\n    if (customMaterial) {\n      return {\n        key: customMaterial.key,\n        name: customMaterial.name,\n        description: customMaterial.description,\n        embodiedEnergy_MJ_kg: customMaterial.embodiedEnergy_MJ_kg,\n        embodiedCarbon_kgCO2_kg: customMaterial.embodiedCarbon_kgCO2_kg,\n        density_kg_m3: customMaterial.density_kg_m3,\n        alternatives: customMaterial.alternatives || [],\n        isCustom: true\n      };\n    }\n  } catch (error) {\n    console.error('Error fetching custom material:', error);\n  }\n  \n  return null;\n}\n\nexport async function getAllMaterials() {\n  const iceMaterials = Object.values(ICE_MATERIALS).map(m => ({\n    ...m,\n    isCustom: false\n  }));\n  \n  try {\n    const customMaterials = await CustomMaterial.find({});\n    const customFormatted = customMaterials.map(m => ({\n      key: m.key,\n      name: m.name,\n      description: m.description,\n      embodiedEnergy_MJ_kg: m.embodiedEnergy_MJ_kg,\n      embodiedCarbon_kgCO2_kg: m.embodiedCarbon_kgCO2_kg,\n      density_kg_m3: m.density_kg_m3,\n      alternatives: m.alternatives || [],\n      isCustom: true\n    }));\n    \n    return [...iceMaterials, ...customFormatted];\n  } catch (error) {\n    console.error('Error fetching custom materials:', error);\n    return iceMaterials;\n  }\n}\n\nexport function getMaterialByName(name) {\n  return Object.values(ICE_MATERIALS).find(m => m.name === name) || null;\n}\n","path":null,"size_bytes":5879,"size_tokens":null},"MLStudio-main/client/src/pages/Dashboard.jsx":{"content":"import { useState, useEffect, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  Database, \n  FolderOpen, \n  Box, \n  TrendingUp,\n  Play,\n  CheckCircle,\n  AlertCircle,\n  Leaf,\n  Zap,\n  Target\n} from 'lucide-react';\nimport { PieChart, Pie, Cell, ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip } from 'recharts';\nimport { TrainingContext } from '../App';\n\nconst COLORS = ['#ef4444', '#6b7280', '#a78bfa', '#60a5fa', '#9ca3af', '#fbbf24', '#78350f', '#84cc16', '#06b6d4', '#64748b', '#f472b6', '#22c55e', '#e2e8f0', '#fb923c', '#8b5cf6'];\n\nfunction Dashboard() {\n  const navigate = useNavigate();\n  const { trainingStatus } = useContext(TrainingContext);\n  const [stats, setStats] = useState(null);\n  const [models, setModels] = useState([]);\n  const [allClasses, setAllClasses] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    try {\n      const [statsRes, modelsRes, classesRes] = await Promise.all([\n        fetch('/api/dataset/stats'),\n        fetch('/api/models'),\n        fetch('/api/classes')\n      ]);\n      \n      const statsData = await statsRes.json();\n      const modelsData = await modelsRes.json();\n      const classesData = await classesRes.json();\n      \n      setStats(statsData);\n      setModels(modelsData);\n      setAllClasses(classesData);\n    } catch (error) {\n      console.error('Error fetching dashboard data:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const activeModel = models.find(m => m.isActive);\n\n  const pieData = stats?.classDistribution?.filter(item => item.count > 0).map((item, index) => ({\n    name: item.classId.replace(/_/g, ' '),\n    value: item.count,\n    color: COLORS[index % COLORS.length]\n  })) || [];\n\n  return (\n    <div>\n      <div className=\"page-header\">\n        <h2>Dashboard</h2>\n        <p>Material Detection Model Training Studio</p>\n      </div>\n\n      <div className=\"card\" style={{ \n        marginBottom: '24px', \n        background: 'linear-gradient(135deg, #064e3b 0%, #1e293b 100%)',\n        border: '1px solid #10b981'\n      }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '20px' }}>\n          <div style={{ \n            width: '80px', \n            height: '80px', \n            borderRadius: '16px', \n            background: 'rgba(16, 185, 129, 0.2)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center'\n          }}>\n            <Leaf size={40} color=\"#10b981\" />\n          </div>\n          <div>\n            <h3 style={{ color: '#f8fafc', marginBottom: '8px', fontSize: '20px' }}>\n              Carbon Footprint Analysis Ready\n            </h3>\n            <p className=\"text-muted\" style={{ maxWidth: '600px' }}>\n              Train ML models to detect {allClasses.length} construction materials. \n              Upload images, train the model, and deploy to your carbon footprint analysis app \n              for automatic material detection and embodied carbon calculations.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"stats-grid\">\n        <div \n          className=\"stat-card cursor-pointer hover:border-blue-500 transition-colors\"\n          onClick={() => navigate('/classes')}\n          style={{ cursor: 'pointer' }}\n        >\n          <div className=\"stat-card-icon blue\">\n            <FolderOpen size={20} />\n          </div>\n          <div className=\"stat-value\">{allClasses.length}</div>\n          <div className=\"stat-label\">Material Classes</div>\n        </div>\n        \n        <div \n          className=\"stat-card cursor-pointer hover:border-green-500 transition-colors\"\n          onClick={() => navigate('/datasets')}\n          style={{ cursor: 'pointer' }}\n        >\n          <div className=\"stat-card-icon green\">\n            <Database size={20} />\n          </div>\n          <div className=\"stat-value\">{stats?.totalSamples || 0}</div>\n          <div className=\"stat-label\">Training Images (MongoDB)</div>\n        </div>\n        \n        <div \n          className=\"stat-card cursor-pointer hover:border-purple-500 transition-colors\"\n          onClick={() => navigate('/models')}\n          style={{ cursor: 'pointer' }}\n        >\n          <div className=\"stat-card-icon purple\">\n            <Box size={20} />\n          </div>\n          <div className=\"stat-value\">{models.length}</div>\n          <div className=\"stat-label\">Trained Models</div>\n        </div>\n        \n        <div \n          className=\"stat-card cursor-pointer hover:border-orange-500 transition-colors\"\n          onClick={() => navigate('/models')}\n          style={{ cursor: 'pointer' }}\n        >\n          <div className=\"stat-card-icon orange\">\n            <TrendingUp size={20} />\n          </div>\n          <div className=\"stat-value\">\n            {activeModel ? `${(activeModel.metrics?.valAccuracy * 100).toFixed(1)}%` : 'N/A'}\n          </div>\n          <div className=\"stat-label\">Active Model Accuracy</div>\n        </div>\n      </div>\n\n      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>\n        <div className=\"card\">\n          <div className=\"card-header\">\n            <h3 className=\"card-title\">Dataset Distribution</h3>\n          </div>\n          {pieData.length > 0 && pieData.some(d => d.value > 0) ? (\n            <div style={{ height: '280px' }}>\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <PieChart>\n                  <Pie\n                    data={pieData}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    innerRadius={60}\n                    outerRadius={100}\n                    paddingAngle={2}\n                    dataKey=\"value\"\n                    label={({ name, percent }) => `${name} (${(percent * 100).toFixed(0)}%)`}\n                    labelLine={false}\n                  >\n                    {pieData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={entry.color} />\n                    ))}\n                  </Pie>\n                  <Tooltip \n                    contentStyle={{ \n                      background: '#1e293b', \n                      border: '1px solid #334155',\n                      borderRadius: '8px'\n                    }}\n                  />\n                </PieChart>\n              </ResponsiveContainer>\n            </div>\n          ) : (\n            <div className=\"empty-state\">\n              <Database size={48} />\n              <h3>No training data yet</h3>\n              <p>Upload images to the Dataset Manager to see distribution</p>\n            </div>\n          )}\n        </div>\n\n        <div className=\"card\">\n          <div className=\"card-header\">\n            <h3 className=\"card-title\">Samples per Class</h3>\n          </div>\n          {stats?.classDistribution?.length > 0 ? (\n            <div style={{ height: '280px' }}>\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <BarChart data={stats.classDistribution} layout=\"vertical\">\n                  <XAxis type=\"number\" stroke=\"#64748b\" />\n                  <YAxis \n                    type=\"category\" \n                    dataKey=\"classId\"\n                    stroke=\"#64748b\"\n                    width={100}\n                    tick={{ fill: '#94a3b8', fontSize: 11 }}\n                    tickFormatter={(v) => v.replace(/_/g, ' ')}\n                  />\n                  <Tooltip \n                    contentStyle={{ \n                      background: '#1e293b', \n                      border: '1px solid #334155',\n                      borderRadius: '8px'\n                    }}\n                  />\n                  <Bar dataKey=\"count\" fill=\"#3b82f6\" radius={[0, 4, 4, 0]} />\n                </BarChart>\n              </ResponsiveContainer>\n            </div>\n          ) : (\n            <div className=\"empty-state\">\n              <FolderOpen size={48} />\n              <h3>No classes yet</h3>\n              <p>Classes are loaded from ICE database</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px', marginTop: '24px' }}>\n        <div className=\"card\">\n          <div className=\"card-header\">\n            <h3 className=\"card-title\">Training Status</h3>\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>\n            <div className=\"status-indicator\">\n              <span className={`status-dot ${trainingStatus.status === 'running' ? 'running' : 'idle'}`}></span>\n              <span style={{ textTransform: 'capitalize', color: 'var(--text-primary)' }}>\n                {trainingStatus.status}\n              </span>\n            </div>\n          </div>\n          \n          {trainingStatus.status === 'idle' ? (\n            <div>\n              <p className=\"text-muted text-sm\" style={{ marginBottom: '16px' }}>\n                Ready to train. Need at least 2 classes with 10+ total images.\n              </p>\n              <button \n                className=\"btn btn-primary\"\n                onClick={() => navigate('/training')}\n              >\n                <Play size={16} />\n                Start Training\n              </button>\n            </div>\n          ) : trainingStatus.status === 'running' ? (\n            <div>\n              <p className=\"text-muted text-sm\">\n                Training in progress. Check the Training page for details.\n              </p>\n              <button \n                className=\"btn btn-secondary mt-4\"\n                onClick={() => navigate('/training')}\n              >\n                View Progress\n              </button>\n            </div>\n          ) : trainingStatus.status === 'completed' ? (\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', color: '#10b981' }}>\n              <CheckCircle size={20} />\n              <span>Training completed successfully!</span>\n            </div>\n          ) : (\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', color: '#ef4444' }}>\n              <AlertCircle size={20} />\n              <span>Training failed. Check logs for details.</span>\n            </div>\n          )}\n        </div>\n\n        <div className=\"card\">\n          <div className=\"card-header\">\n            <h3 className=\"card-title\">Active Model</h3>\n            <button \n              className=\"btn btn-outline btn-sm\"\n              onClick={() => navigate('/models')}\n            >\n              Manage Models\n            </button>\n          </div>\n          \n          {activeModel ? (\n            <div>\n              <h4 style={{ color: 'var(--text-primary)', fontSize: '18px', marginBottom: '12px' }}>\n                {activeModel.name}\n              </h4>\n              <div className=\"metrics-grid\" style={{ gridTemplateColumns: 'repeat(2, 1fr)' }}>\n                <div className=\"metric-box\">\n                  <div className=\"metric-value\" style={{ color: '#10b981' }}>\n                    {(activeModel.metrics?.valAccuracy * 100).toFixed(1)}%\n                  </div>\n                  <div className=\"metric-label\">Validation Accuracy</div>\n                </div>\n                <div className=\"metric-box\">\n                  <div className=\"metric-value\" style={{ color: '#3b82f6' }}>\n                    {activeModel.metrics?.valLoss?.toFixed(4) || 'N/A'}\n                  </div>\n                  <div className=\"metric-label\">Validation Loss</div>\n                </div>\n              </div>\n              <div className=\"text-muted text-sm mt-4\">\n                <Target size={14} style={{ display: 'inline', marginRight: '6px' }} />\n                Trained on {activeModel.classes?.length || 0} material classes\n              </div>\n            </div>\n          ) : (\n            <div className=\"empty-state\" style={{ padding: '40px 20px' }}>\n              <Box size={48} />\n              <h3>No active model</h3>\n              <p>Train a model and it will be automatically activated</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"card\" style={{ marginTop: '24px' }}>\n        <div className=\"card-header\">\n          <h3 className=\"card-title\">Quick Actions</h3>\n        </div>\n        <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>\n          <button className=\"btn btn-outline\" onClick={() => navigate('/classes')}>\n            <FolderOpen size={16} />\n            View Material Classes\n          </button>\n          <button className=\"btn btn-outline\" onClick={() => navigate('/datasets')}>\n            <Database size={16} />\n            Upload Images\n          </button>\n          <button className=\"btn btn-outline\" onClick={() => navigate('/training')}>\n            <Play size={16} />\n            Train Model\n          </button>\n          <button className=\"btn btn-outline\" onClick={() => navigate('/models')}>\n            <Box size={16} />\n            Manage Models\n          </button>\n        </div>\n      </div>\n\n      <div className=\"card\" style={{ marginTop: '24px', background: 'var(--bg-primary)' }}>\n        <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>\n          <Zap size={20} style={{ display: 'inline', marginRight: '8px', color: '#f97316' }} />\n          Workflow Guide\n        </h3>\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px' }}>\n          <div style={{ textAlign: 'center', padding: '16px' }}>\n            <div style={{ \n              width: '48px', \n              height: '48px', \n              borderRadius: '50%', \n              background: '#3b82f620',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              margin: '0 auto 12px'\n            }}>\n              <span style={{ color: '#3b82f6', fontWeight: 'bold', fontSize: '18px' }}>1</span>\n            </div>\n            <div style={{ color: 'var(--text-primary)', fontWeight: '500', marginBottom: '4px' }}>Upload Images</div>\n            <div className=\"text-muted text-sm\">Add labeled images per material class</div>\n          </div>\n          <div style={{ textAlign: 'center', padding: '16px' }}>\n            <div style={{ \n              width: '48px', \n              height: '48px', \n              borderRadius: '50%', \n              background: '#10b98120',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              margin: '0 auto 12px'\n            }}>\n              <span style={{ color: '#10b981', fontWeight: 'bold', fontSize: '18px' }}>2</span>\n            </div>\n            <div style={{ color: 'var(--text-primary)', fontWeight: '500', marginBottom: '4px' }}>Train Model</div>\n            <div className=\"text-muted text-sm\">One-click training with progress monitoring</div>\n          </div>\n          <div style={{ textAlign: 'center', padding: '16px' }}>\n            <div style={{ \n              width: '48px', \n              height: '48px', \n              borderRadius: '50%', \n              background: '#8b5cf620',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              margin: '0 auto 12px'\n            }}>\n              <span style={{ color: '#8b5cf6', fontWeight: 'bold', fontSize: '18px' }}>3</span>\n            </div>\n            <div style={{ color: 'var(--text-primary)', fontWeight: '500', marginBottom: '4px' }}>Review Metrics</div>\n            <div className=\"text-muted text-sm\">Check accuracy and compare models</div>\n          </div>\n          <div style={{ textAlign: 'center', padding: '16px' }}>\n            <div style={{ \n              width: '48px', \n              height: '48px', \n              borderRadius: '50%', \n              background: '#f9731620',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              margin: '0 auto 12px'\n            }}>\n              <span style={{ color: '#f97316', fontWeight: 'bold', fontSize: '18px' }}>4</span>\n            </div>\n            <div style={{ color: 'var(--text-primary)', fontWeight: '500', marginBottom: '4px' }}>Deploy</div>\n            <div className=\"text-muted text-sm\">Activate best model for your app</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Dashboard;\n","path":null,"size_bytes":16458,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"client/src/pages/api-docs.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout, Code, Terminal, Copy, Check } from \"lucide-react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useState } from \"react\";\n\nexport default function ApiDocs() {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopy = () => {\n    navigator.clipboard.writeText('curl -X POST https://api.ecobuild.ai/v1/analyze \\\\ \\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\\ \\n  -F \"image=@material.jpg\"');\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-12 max-w-5xl\">\n        <div className=\"flex flex-col md:flex-row gap-12\">\n            <div className=\"md:w-1/3 space-y-6\">\n                <div>\n                    <h1 className=\"text-4xl font-display font-bold mb-4\">API Reference</h1>\n                    <p className=\"text-muted-foreground\">\n                        Integrate EcoBuild's powerful material analysis engine directly into your own applications.\n                    </p>\n                </div>\n                \n                <div className=\"space-y-2\">\n                    <h3 className=\"font-bold text-sm uppercase tracking-wider text-muted-foreground\">Endpoints</h3>\n                    <nav className=\"flex flex-col space-y-1\">\n                        <a href=\"#analyze\" className=\"px-3 py-2 bg-primary/10 text-primary rounded-md font-medium text-sm\">POST /v1/analyze</a>\n                        <a href=\"#\" className=\"px-3 py-2 text-muted-foreground hover:bg-secondary/50 rounded-md font-medium text-sm\">GET /v1/materials</a>\n                        <a href=\"#\" className=\"px-3 py-2 text-muted-foreground hover:bg-secondary/50 rounded-md font-medium text-sm\">GET /v1/materials/{'{id}'}</a>\n                        <a href=\"#\" className=\"px-3 py-2 text-muted-foreground hover:bg-secondary/50 rounded-md font-medium text-sm\">POST /v1/projects</a>\n                    </nav>\n                </div>\n            </div>\n\n            <div className=\"md:w-2/3 space-y-12\">\n                <section id=\"analyze\" className=\"space-y-6\">\n                    <div className=\"flex items-center gap-3\">\n                        <span className=\"bg-blue-500/10 text-blue-600 px-3 py-1 rounded font-mono text-sm font-bold border border-blue-500/20\">POST</span>\n                        <h2 className=\"text-2xl font-bold font-mono\">/v1/analyze</h2>\n                    </div>\n                    <p className=\"text-muted-foreground\">\n                        Upload an image of a construction material to receive instantaneous identification, carbon footprint analysis, and recommended sustainable alternatives.\n                    </p>\n\n                    <Card className=\"bg-slate-950 border-slate-800 text-slate-300 overflow-hidden\">\n                        <div className=\"flex items-center justify-between px-4 py-2 border-b border-slate-800 bg-slate-900\">\n                            <div className=\"flex items-center gap-2 text-xs font-mono\">\n                                <Terminal className=\"w-4 h-4\" />\n                                <span>cURL Request</span>\n                            </div>\n                            <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6 text-slate-400 hover:text-white\" onClick={handleCopy}>\n                                {copied ? <Check className=\"w-3 h-3\" /> : <Copy className=\"w-3 h-3\" />}\n                            </Button>\n                        </div>\n                        <CardContent className=\"p-4 font-mono text-sm overflow-x-auto\">\n                            <pre>\n{`curl -X POST https://api.ecobuild.ai/v1/analyze \\\\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\\\n  -F \"image=@material.jpg\"`}\n                            </pre>\n                        </CardContent>\n                    </Card>\n\n                    <div className=\"space-y-4\">\n                        <h3 className=\"font-bold\">Response</h3>\n                        <Card className=\"bg-slate-950 border-slate-800 text-green-400 overflow-hidden\">\n                             <CardContent className=\"p-4 font-mono text-sm overflow-x-auto\">\n                                <pre>\n{`{\n  \"status\": \"success\",\n  \"data\": {\n    \"material\": \"Concrete (C25/30)\",\n    \"confidence\": 0.98,\n    \"properties\": {\n      \"density\": 2400,\n      \"carbon_footprint\": 410\n    },\n    \"alternatives\": [\n      {\n        \"name\": \"Hempcrete\",\n        \"savings_percentage\": 92\n      }\n    ]\n  }\n}`}\n                                </pre>\n                            </CardContent>\n                        </Card>\n                    </div>\n                </section>\n            </div>\n        </div>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":5667,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"MLStudio-main/client/src/pages/Models.jsx":{"content":"import { useState, useEffect } from 'react';\nimport { \n  Box, \n  CheckCircle, \n  Trash2,\n  Star,\n  Clock,\n  Layers,\n  Target,\n  TrendingUp,\n  AlertTriangle,\n  RefreshCw\n} from 'lucide-react';\n\nfunction Models() {\n  const [models, setModels] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [deleting, setDeleting] = useState(null);\n\n  useEffect(() => {\n    fetchModels();\n  }, []);\n\n  const fetchModels = async () => {\n    try {\n      const response = await fetch('/api/models');\n      const data = await response.json();\n      setModels(data);\n    } catch (error) {\n      console.error('Error fetching models:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const activateModel = async (modelId) => {\n    try {\n      const response = await fetch(`/api/models/${modelId}/activate`, {\n        method: 'POST'\n      });\n\n      if (response.ok) {\n        setModels(models.map(m => ({\n          ...m,\n          isActive: m.id === modelId\n        })));\n      }\n    } catch (error) {\n      console.error('Error activating model:', error);\n    }\n  };\n\n  const deleteModel = async (modelId, isActive) => {\n    const message = isActive \n      ? 'This is the active model. Deleting it will activate the next best model. Continue?'\n      : 'Are you sure you want to delete this model? This action cannot be undone.';\n    \n    if (!confirm(message)) return;\n\n    setDeleting(modelId);\n    try {\n      const response = await fetch(`/api/models/${modelId}?force=true`, {\n        method: 'DELETE'\n      });\n\n      if (response.ok) {\n        fetchModels();\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Failed to delete model');\n      }\n    } catch (error) {\n      console.error('Error deleting model:', error);\n    } finally {\n      setDeleting(null);\n    }\n  };\n\n  const activeModel = models.find(m => m.isActive);\n  const completedModels = models.filter(m => m.status === 'completed');\n\n  if (loading) {\n    return (\n      <div className=\"card\">\n        <div className=\"empty-state\">\n          <RefreshCw size={48} className=\"spinning\" />\n          <h3>Loading models...</h3>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"page-header\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h2>Model Management</h2>\n            <p>View, compare, and manage trained material detection models</p>\n          </div>\n          <button className=\"btn btn-outline\" onClick={fetchModels}>\n            <RefreshCw size={16} />\n            Refresh\n          </button>\n        </div>\n      </div>\n\n      {activeModel && (\n        <div className=\"card\" style={{ borderColor: '#10b981', background: 'rgba(16, 185, 129, 0.1)' }}>\n          <div className=\"card-header\">\n            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\n              <Star size={24} color=\"#10b981\" fill=\"#10b981\" />\n              <div>\n                <h3 className=\"card-title\">Active Model - Ready for Deployment</h3>\n                <p className=\"text-muted text-sm\">This model will be used for predictions in your carbon footprint app</p>\n              </div>\n            </div>\n          </div>\n          \n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px', marginTop: '16px' }}>\n            <div className=\"metric-box\">\n              <div className=\"metric-value\" style={{ color: '#10b981' }}>\n                {activeModel.metrics?.valAccuracy ? \n                  `${(activeModel.metrics.valAccuracy * 100).toFixed(1)}%` : 'N/A'}\n              </div>\n              <div className=\"metric-label\">Validation Accuracy</div>\n            </div>\n            <div className=\"metric-box\">\n              <div className=\"metric-value\" style={{ color: '#3b82f6' }}>\n                {activeModel.metrics?.valLoss?.toFixed(4) || 'N/A'}\n              </div>\n              <div className=\"metric-label\">Validation Loss</div>\n            </div>\n            <div className=\"metric-box\">\n              <div className=\"metric-value\" style={{ color: '#8b5cf6' }}>\n                {activeModel.classes?.length || 0}\n              </div>\n              <div className=\"metric-label\">Material Classes</div>\n            </div>\n            <div className=\"metric-box\">\n              <div className=\"metric-value\" style={{ color: '#f97316' }}>\n                {activeModel.samplesUsed || 'N/A'}\n              </div>\n              <div className=\"metric-label\">Training Samples</div>\n            </div>\n          </div>\n          \n          <div style={{ marginTop: '16px', display: 'flex', gap: '16px', flexWrap: 'wrap' }}>\n            {activeModel.classes?.map(cls => (\n              <span key={cls} className=\"badge badge-success\" style={{ fontSize: '12px' }}>\n                {cls.replace(/_/g, ' ')}\n              </span>\n            ))}\n          </div>\n          \n          <div className=\"text-muted text-sm mt-4\">\n            <Clock size={14} style={{ display: 'inline', marginRight: '6px' }} />\n            Trained: {new Date(activeModel.createdAt).toLocaleString()}\n          </div>\n        </div>\n      )}\n\n      <div className=\"card\">\n        <div className=\"card-header\">\n          <h3 className=\"card-title\">All Models ({models.length})</h3>\n        </div>\n\n        {models.length === 0 ? (\n          <div className=\"empty-state\">\n            <Box size={64} />\n            <h3>No trained models yet</h3>\n            <p>Train a model from the Training page to see it here</p>\n            <a href=\"/training\" className=\"btn btn-primary mt-4\">\n              Go to Training\n            </a>\n          </div>\n        ) : (\n          <div className=\"models-list\">\n            {models.map(model => (\n              <div \n                key={model.id} \n                className={`model-card ${model.isActive ? 'active' : ''}`}\n              >\n                <div className=\"model-info\">\n                  <h4>\n                    {model.name}\n                    {model.isActive && (\n                      <span className=\"badge badge-success\" style={{ marginLeft: '8px' }}>\n                        <CheckCircle size={12} /> Active\n                      </span>\n                    )}\n                    {model.status === 'training' && (\n                      <span className=\"badge badge-info\" style={{ marginLeft: '8px' }}>\n                        Training...\n                      </span>\n                    )}\n                    {model.status === 'failed' && (\n                      <span className=\"badge badge-danger\" style={{ marginLeft: '8px' }}>\n                        Failed\n                      </span>\n                    )}\n                    {model.status === 'stopped' && (\n                      <span className=\"badge badge-warning\" style={{ marginLeft: '8px' }}>\n                        Stopped\n                      </span>\n                    )}\n                  </h4>\n                  <div className=\"model-meta\">\n                    <span>\n                      <Layers size={14} style={{ marginRight: '4px' }} />\n                      {model.classes?.length || 0} classes\n                    </span>\n                    <span>\n                      <TrendingUp size={14} style={{ marginRight: '4px' }} />\n                      Accuracy: {model.metrics?.valAccuracy ? \n                        `${(model.metrics.valAccuracy * 100).toFixed(1)}%` : 'N/A'}\n                    </span>\n                    <span>\n                      Loss: {model.metrics?.valLoss?.toFixed(4) || 'N/A'}\n                    </span>\n                    <span>\n                      <Clock size={14} style={{ marginRight: '4px' }} />\n                      {new Date(model.createdAt).toLocaleDateString()}\n                    </span>\n                  </div>\n                  \n                  {model.classes && model.classes.length > 0 && (\n                    <div style={{ marginTop: '8px', display: 'flex', gap: '6px', flexWrap: 'wrap' }}>\n                      {model.classes.slice(0, 5).map(cls => (\n                        <span key={cls} className=\"badge badge-info\" style={{ fontSize: '11px' }}>\n                          {cls.replace(/_/g, ' ')}\n                        </span>\n                      ))}\n                      {model.classes.length > 5 && (\n                        <span className=\"badge badge-info\" style={{ fontSize: '11px' }}>\n                          +{model.classes.length - 5} more\n                        </span>\n                      )}\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"model-actions\">\n                  {!model.isActive && model.status === 'completed' && (\n                    <button \n                      className=\"btn btn-success btn-sm\"\n                      onClick={() => activateModel(model.id)}\n                    >\n                      <CheckCircle size={14} />\n                      Activate\n                    </button>\n                  )}\n                  <button \n                    className=\"btn btn-danger btn-sm\"\n                    onClick={() => deleteModel(model.id, model.isActive)}\n                    disabled={deleting === model.id}\n                  >\n                    {deleting === model.id ? (\n                      <RefreshCw size={14} className=\"spinning\" />\n                    ) : (\n                      <Trash2 size={14} />\n                    )}\n                    Delete\n                  </button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {completedModels.length >= 2 && (\n        <div className=\"card\" style={{ marginTop: '24px' }}>\n          <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>\n            <Target size={20} style={{ display: 'inline', marginRight: '8px' }} />\n            Model Comparison\n          </h3>\n          <div style={{ overflowX: 'auto' }}>\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\n              <thead>\n                <tr style={{ borderBottom: '1px solid var(--border-color)' }}>\n                  <th style={{ padding: '12px', textAlign: 'left', color: 'var(--text-muted)' }}>Model</th>\n                  <th style={{ padding: '12px', textAlign: 'right', color: 'var(--text-muted)' }}>Val Accuracy</th>\n                  <th style={{ padding: '12px', textAlign: 'right', color: 'var(--text-muted)' }}>Val Loss</th>\n                  <th style={{ padding: '12px', textAlign: 'right', color: 'var(--text-muted)' }}>Train Accuracy</th>\n                  <th style={{ padding: '12px', textAlign: 'right', color: 'var(--text-muted)' }}>Samples Used</th>\n                  <th style={{ padding: '12px', textAlign: 'center', color: 'var(--text-muted)' }}>Status</th>\n                </tr>\n              </thead>\n              <tbody>\n                {completedModels.map(model => (\n                  <tr key={model.id} style={{ borderBottom: '1px solid var(--bg-primary)' }}>\n                    <td style={{ padding: '12px', color: 'var(--text-primary)' }}>{model.name}</td>\n                    <td style={{ padding: '12px', textAlign: 'right', color: '#10b981', fontWeight: 600 }}>\n                      {model.metrics?.valAccuracy ? \n                        `${(model.metrics.valAccuracy * 100).toFixed(2)}%` : 'N/A'}\n                    </td>\n                    <td style={{ padding: '12px', textAlign: 'right', color: '#f97316' }}>\n                      {model.metrics?.valLoss?.toFixed(4) || 'N/A'}\n                    </td>\n                    <td style={{ padding: '12px', textAlign: 'right', color: '#3b82f6' }}>\n                      {model.metrics?.accuracy ? \n                        `${(model.metrics.accuracy * 100).toFixed(2)}%` : 'N/A'}\n                    </td>\n                    <td style={{ padding: '12px', textAlign: 'right', color: '#8b5cf6' }}>\n                      {model.samplesUsed || 'N/A'}\n                    </td>\n                    <td style={{ padding: '12px', textAlign: 'center' }}>\n                      {model.isActive ? (\n                        <span className=\"badge badge-success\">Active</span>\n                      ) : (\n                        <span className=\"badge badge-info\">Ready</span>\n                      )}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      <div className=\"card\" style={{ marginTop: '24px', background: 'var(--bg-primary)' }}>\n        <h3 className=\"card-title\" style={{ marginBottom: '12px' }}>Deployment Instructions</h3>\n        <p className=\"text-muted\" style={{ lineHeight: '1.6' }}>\n          The active model can be accessed via the <code style={{ \n            background: 'var(--bg-secondary)', \n            padding: '2px 8px', \n            borderRadius: '4px',\n            color: '#10b981'\n          }}>/api/models/active</code> endpoint. \n          Use this to load the model configuration and labels for predictions in your carbon footprint analysis application.\n          Models can be tested on the <a href=\"/testing\" style={{ color: '#3b82f6' }}>Model Testing</a> page.\n        </p>\n      </div>\n    </div>\n  );\n}\n\nexport default Models;\n","path":null,"size_bytes":13304,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"client/src/components/carbon-stats.tsx":{"content":"import { \n  BarChart, \n  Bar, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer,\n  Cell\n} from 'recharts';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { AlertTriangle, Leaf, TrendingDown } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nconst data = [\n  { name: 'Standard Concrete', carbon: 400, color: '#ef4444' }, // Red\n  { name: 'Hempcrete', carbon: 120, color: '#16a34a' }, // Green\n  { name: 'Recycled Steel', carbon: 250, color: '#eab308' }, // Yellow\n  { name: 'Bamboo', carbon: 80, color: '#16a34a' }, // Green\n];\n\nexport function CarbonStats() {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n      <motion.div \n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.2 }}\n      >\n        <Card className=\"h-full border-none shadow-lg bg-white/90 backdrop-blur\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Leaf className=\"w-5 h-5 text-primary\" />\n              Carbon Footprint Comparison\n            </CardTitle>\n            <CardDescription>kg CO2e per cubic meter</CardDescription>\n          </CardHeader>\n          <CardContent className=\"h-[300px]\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <BarChart data={data} layout=\"vertical\" margin={{ left: 40 }}>\n                <CartesianGrid strokeDasharray=\"3 3\" horizontal={false} stroke=\"#e5e7eb\" />\n                <XAxis type=\"number\" hide />\n                <YAxis \n                  dataKey=\"name\" \n                  type=\"category\" \n                  tick={{ fill: '#4b5563', fontSize: 12, fontWeight: 500 }} \n                  width={100}\n                  axisLine={false}\n                  tickLine={false}\n                />\n                <Tooltip \n                  cursor={{ fill: 'transparent' }}\n                  contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 10px 15px -3px rgb(0 0 0 / 0.1)' }}\n                />\n                <Bar dataKey=\"carbon\" radius={[0, 4, 4, 0]} barSize={30}>\n                  {data.map((entry, index) => (\n                    <Cell key={`cell-${index}`} fill={entry.color} />\n                  ))}\n                </Bar>\n              </BarChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n      </motion.div>\n\n      <div className=\"grid grid-cols-1 gap-6\">\n        <motion.div \n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.3 }}\n        >\n          <Card className=\"bg-accent text-white border-none shadow-lg\">\n            <CardContent className=\"pt-6 flex items-start justify-between\">\n              <div>\n                <p className=\"text-white/80 font-medium mb-1\">Impact Alert</p>\n                <h3 className=\"text-3xl font-bold font-display mb-2\">High Carbon</h3>\n                <p className=\"text-sm text-white/90\">\n                  Selected material exceeds sustainable threshold by 230%.\n                </p>\n              </div>\n              <div className=\"bg-white/20 p-3 rounded-full\">\n                <AlertTriangle className=\"w-8 h-8 text-white\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div \n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.4 }}\n        >\n          <Card className=\"bg-primary text-white border-none shadow-lg overflow-hidden relative\">\n            <div className=\"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16 blur-2xl\"></div>\n            <CardContent className=\"pt-6 flex items-start justify-between relative z-10\">\n              <div>\n                <p className=\"text-white/80 font-medium mb-1\">Potential Savings</p>\n                <h3 className=\"text-3xl font-bold font-display mb-2\">-68% CO2</h3>\n                <p className=\"text-sm text-white/90\">\n                  By switching to Hempcrete or Bamboo.\n                </p>\n              </div>\n              <div className=\"bg-white/20 p-3 rounded-full\">\n                <TrendingDown className=\"w-8 h-8 text-white\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":4393,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/pages/pricing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout, CheckCircle2, Crown, Zap } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardFooter } from \"@/components/ui/card\";\n\nexport default function Pricing() {\n  const plans = [\n    {\n      name: \"Starter\",\n      price: 0,\n      description: \"For individuals exploring sustainable materials.\",\n      features: [\"3 Material Scans / Month\", \"Basic Carbon Stats\", \"Community Support\"],\n    },\n    {\n      name: \"Professional\",\n      price: 29,\n      description: \"For architects needing advanced analysis.\",\n      features: [\"Unlimited Material Scans\", \"Advanced Lifecycle Analysis\", \"Export PDF Reports\", \"Project Management Dashboard\", \"Priority Support\"],\n      popular: true,\n      icon: Zap,\n    },\n    {\n      name: \"Enterprise\",\n      price: 99,\n      description: \"For large firms and organizations.\",\n      features: [\"Everything in Pro\", \"API Access\", \"Custom Integrations\", \"Dedicated Success Manager\", \"Team Collaboration (10+ Users)\"],\n      icon: Crown,\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-20\">\n        <div className=\"text-center max-w-3xl mx-auto mb-16\">\n            <h1 className=\"text-4xl md:text-5xl font-display font-bold mb-6\">Simple, Transparent Pricing</h1>\n            <p className=\"text-xl text-muted-foreground\">\n                Start for free, upgrade when you need more power. No hidden fees.\n            </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto\">\n            {plans.map((plan, index) => (\n                <Card key={index} className={`h-full flex flex-col relative overflow-hidden transition-all duration-300 ${plan.popular ? 'border-2 border-primary shadow-xl scale-105 z-10' : 'border-none shadow-md hover:shadow-xl'}`}>\n                {plan.popular && (\n                    <div className=\"absolute top-0 left-0 w-full bg-primary py-1 text-center text-xs font-bold text-white uppercase tracking-wider\">\n                    Most Popular\n                    </div>\n                )}\n                <CardHeader className={`text-center pb-2 ${plan.popular ? 'pt-8' : ''}`}>\n                    {plan.icon && <div className={`mx-auto w-12 h-12 rounded-full flex items-center justify-center mb-4 ${plan.popular ? 'bg-primary/10 text-primary' : 'bg-secondary/50 text-foreground'}`}><plan.icon className=\"w-6 h-6\" /></div>}\n                    <h3 className={`font-display font-bold text-xl ${plan.popular ? 'text-primary' : ''}`}>{plan.name}</h3>\n                    <p className=\"text-xs text-muted-foreground h-8 px-4\">{plan.description}</p>\n                    <div className=\"flex items-baseline justify-center mt-4\">\n                    <span className=\"text-4xl font-bold\">${plan.price}</span>\n                    <span className=\"text-muted-foreground ml-1\">/mo</span>\n                    </div>\n                </CardHeader>\n                <CardContent className=\"space-y-4 pt-4 flex-grow\">\n                    <ul className=\"space-y-3 text-sm\">\n                    {plan.features.map((feature, i) => (\n                        <li key={i} className=\"flex items-start\">\n                        <CheckCircle2 className={`w-4 h-4 mr-2 shrink-0 mt-0.5 ${plan.popular ? 'text-primary' : 'text-green-600'}`} />\n                        <span className=\"text-muted-foreground\">{feature}</span>\n                        </li>\n                    ))}\n                    </ul>\n                </CardContent>\n                <CardFooter>\n                    <Link href=\"/auth\" className=\"w-full\">\n                        <Button \n                        variant={plan.popular ? \"default\" : \"outline\"} \n                        className={`w-full ${plan.popular ? 'font-bold shadow-lg shadow-primary/20' : ''}`}\n                        >\n                        Get Started\n                        </Button>\n                    </Link>\n                </CardFooter>\n                </Card>\n            ))}\n        </div>\n\n        <div className=\"mt-20 text-center\">\n            <h3 className=\"text-2xl font-bold mb-4\">Frequently Asked Questions</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto text-left mt-8\">\n                <div>\n                    <h4 className=\"font-bold mb-2\">Can I cancel anytime?</h4>\n                    <p className=\"text-sm text-muted-foreground\">Yes, you can cancel your subscription at any time. Your access will remain active until the end of your billing period.</p>\n                </div>\n                <div>\n                    <h4 className=\"font-bold mb-2\">Do you offer student discounts?</h4>\n                    <p className=\"text-sm text-muted-foreground\">Yes! Students with a valid .edu email address get 50% off the Professional plan.</p>\n                </div>\n                <div>\n                    <h4 className=\"font-bold mb-2\">Is the carbon data certified?</h4>\n                    <p className=\"text-sm text-muted-foreground\">Our data is sourced from verified Environmental Product Declarations (EPDs) compliant with ISO 14025.</p>\n                </div>\n                <div>\n                    <h4 className=\"font-bold mb-2\">What payment methods do you accept?</h4>\n                    <p className=\"text-sm text-muted-foreground\">We accept all major credit cards, PayPal, and wire transfers for Enterprise accounts.</p>\n                </div>\n            </div>\n        </div>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":6445,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"MLStudio-main/server/models/TrainedModel.js":{"content":"import mongoose from 'mongoose';\n\nconst trainedModelSchema = new mongoose.Schema({\n  modelId: { type: String, required: true, unique: true },\n  name: { type: String, required: true },\n  status: { type: String, enum: ['training', 'completed', 'failed', 'stopped'], default: 'training' },\n  isActive: { type: Boolean, default: false },\n  classes: [String],\n  classLabels: { type: Map, of: String },\n  config: {\n    epochs: { type: Number, default: 10 },\n    batchSize: { type: Number, default: 16 },\n    learningRate: { type: Number, default: 0.0001 },\n    validationSplit: { type: Number, default: 0.2 },\n    enableSegmentation: { type: Boolean, default: false }\n  },\n  metrics: {\n    accuracy: { type: Number, default: 0 },\n    valAccuracy: { type: Number, default: 0 },\n    loss: { type: Number, default: 0 },\n    valLoss: { type: Number, default: 0 },\n    confusionMatrix: [[Number]],\n    classAccuracies: { type: Map, of: Number }\n  },\n  trainingHistory: {\n    loss: [Number],\n    accuracy: [Number],\n    valLoss: [Number],\n    valAccuracy: [Number]\n  },\n  logs: [{\n    message: String,\n    level: { type: String, default: 'info' },\n    timestamp: { type: Date, default: Date.now }\n  }],\n  modelData: { type: Buffer },\n  labelsJson: { type: String },\n  samplesUsed: { type: Number, default: 0 },\n  startedAt: { type: Date, default: Date.now },\n  completedAt: { type: Date }\n});\n\nexport default mongoose.model('TrainedModel', trainedModelSchema);\n","path":null,"size_bytes":1449,"size_tokens":null},"MLStudio-main/client/src/pages/Classes.jsx":{"content":"import { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  FolderOpen,\n  Image,\n  Leaf,\n  Zap,\n  RefreshCw,\n  Plus,\n  Edit2,\n  Trash2,\n  X,\n  Save,\n  Layers,\n  Settings,\n  ExternalLink\n} from 'lucide-react';\n\nconst MATERIAL_COLORS = {\n  bricks: '#ef4444',\n  concrete: '#6b7280',\n  aggregate: '#a78bfa',\n  aerated_block: '#60a5fa',\n  concrete_block: '#9ca3af',\n  limestone_block: '#fbbf24',\n  rammed_earth: '#78350f',\n  timber: '#84cc16',\n  steel: '#475569',\n  glass: '#06b6d4',\n  aluminum: '#64748b',\n  insulation_mineral_wool: '#f472b6',\n  insulation_cellulose: '#22c55e',\n  plasterboard: '#e2e8f0',\n  ceramic_tiles: '#fb923c'\n};\n\nconst DEFAULT_CATEGORIES = [\n  { id: 'ice', name: 'ICE Database Materials', description: 'Inventory of Carbon and Energy database materials', isDefault: true },\n  { id: 'custom', name: 'Custom Classes', description: 'User-defined material classes', isDefault: true }\n];\n\nfunction Classes() {\n  const navigate = useNavigate();\n  const [classes, setClasses] = useState([]);\n  const [categories, setCategories] = useState(() => {\n    const saved = localStorage.getItem('materialCategories');\n    return saved ? JSON.parse(saved) : DEFAULT_CATEGORIES;\n  });\n  const [loading, setLoading] = useState(true);\n  const [classSamples, setClassSamples] = useState({});\n  const [showModal, setShowModal] = useState(false);\n  const [showCategoryModal, setShowCategoryModal] = useState(false);\n  const [editingClass, setEditingClass] = useState(null);\n  const [editingCategory, setEditingCategory] = useState(null);\n  const [formData, setFormData] = useState({\n    key: '',\n    name: '',\n    description: '',\n    embodiedEnergy: '',\n    embodiedCarbon: '',\n    density: '',\n    alternatives: '',\n    category: 'custom'\n  });\n  const [categoryFormData, setCategoryFormData] = useState({\n    id: '',\n    name: '',\n    description: ''\n  });\n\n  useEffect(() => {\n    fetchClasses();\n  }, []);\n\n  useEffect(() => {\n    localStorage.setItem('materialCategories', JSON.stringify(categories));\n  }, [categories]);\n\n  const fetchClasses = async () => {\n    try {\n      const response = await fetch('/api/classes');\n      const data = await response.json();\n      setClasses(data);\n      \n      data.forEach(cls => {\n        fetchClassSamples(cls.id);\n      });\n    } catch (error) {\n      console.error('Error fetching classes:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchClassSamples = async (classId) => {\n    try {\n      const response = await fetch(`/api/classes/${classId}/samples`);\n      const samples = await response.json();\n      setClassSamples(prev => ({ ...prev, [classId]: samples.slice(0, 4) }));\n    } catch (error) {\n      console.error('Error fetching samples:', error);\n    }\n  };\n\n  const getMaterialColor = (classId) => {\n    return MATERIAL_COLORS[classId] || '#3b82f6';\n  };\n\n  const openAddModal = () => {\n    setEditingClass(null);\n    setFormData({\n      key: '',\n      name: '',\n      description: '',\n      embodiedEnergy: '',\n      embodiedCarbon: '',\n      density: '',\n      alternatives: '',\n      category: 'custom'\n    });\n    setShowModal(true);\n  };\n\n  const openEditModal = (cls) => {\n    setEditingClass(cls);\n    setFormData({\n      key: cls.id,\n      name: cls.name,\n      description: cls.description || '',\n      embodiedEnergy: cls.embodiedEnergy || '',\n      embodiedCarbon: cls.embodiedCarbon || '',\n      density: cls.density || '',\n      alternatives: cls.alternatives?.join(', ') || '',\n      category: cls.category || 'custom'\n    });\n    setShowModal(true);\n  };\n\n  const openAddCategoryModal = () => {\n    setEditingCategory(null);\n    setCategoryFormData({\n      id: '',\n      name: '',\n      description: ''\n    });\n    setShowCategoryModal(true);\n  };\n\n  const openEditCategoryModal = (cat) => {\n    setEditingCategory(cat);\n    setCategoryFormData({\n      id: cat.id,\n      name: cat.name,\n      description: cat.description || ''\n    });\n    setShowCategoryModal(true);\n  };\n\n  const handleCategorySubmit = (e) => {\n    e.preventDefault();\n    \n    if (editingCategory) {\n      setCategories(prev => prev.map(cat => \n        cat.id === editingCategory.id \n          ? { ...cat, name: categoryFormData.name, description: categoryFormData.description }\n          : cat\n      ));\n    } else {\n      const newId = categoryFormData.id.toLowerCase().replace(/\\s+/g, '_');\n      if (categories.some(c => c.id === newId)) {\n        alert('Category ID already exists');\n        return;\n      }\n      setCategories(prev => [...prev, {\n        id: newId,\n        name: categoryFormData.name,\n        description: categoryFormData.description,\n        isDefault: false\n      }]);\n    }\n    setShowCategoryModal(false);\n  };\n\n  const deleteCategory = (catId) => {\n    const cat = categories.find(c => c.id === catId);\n    if (cat?.isDefault) {\n      alert('Cannot delete default categories');\n      return;\n    }\n    if (!confirm(`Are you sure you want to delete the category \"${cat?.name}\"?`)) return;\n    setCategories(prev => prev.filter(c => c.id !== catId));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    const payload = {\n      key: formData.key,\n      name: formData.name,\n      description: formData.description,\n      embodiedEnergy: parseFloat(formData.embodiedEnergy) || 0,\n      embodiedCarbon: parseFloat(formData.embodiedCarbon) || 0,\n      density: parseFloat(formData.density) || 0,\n      alternatives: formData.alternatives.split(',').map(s => s.trim()).filter(Boolean),\n      category: formData.category\n    };\n\n    try {\n      const url = editingClass \n        ? `/api/classes/${editingClass.id}`\n        : '/api/classes';\n      \n      const response = await fetch(url, {\n        method: editingClass ? 'PUT' : 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      });\n\n      if (response.ok) {\n        setShowModal(false);\n        fetchClasses();\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Failed to save class');\n      }\n    } catch (error) {\n      console.error('Error saving class:', error);\n      alert('Failed to save class');\n    }\n  };\n\n  const deleteClass = async (classId) => {\n    if (!confirm('Are you sure you want to delete this class? All associated images will also be deleted.')) return;\n\n    try {\n      const response = await fetch(`/api/classes/${classId}`, {\n        method: 'DELETE'\n      });\n\n      if (response.ok) {\n        fetchClasses();\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Failed to delete class');\n      }\n    } catch (error) {\n      console.error('Error deleting class:', error);\n    }\n  };\n\n  const iceClasses = classes.filter(c => !c.isCustom);\n  const customClasses = classes.filter(c => c.isCustom);\n  const userCategories = categories.filter(c => !c.isDefault);\n\n  const handleClassClick = (classId) => {\n    navigate(`/datasets?class=${classId}`);\n  };\n\n  const renderClassCard = (cls, showActions = false) => {\n    const color = getMaterialColor(cls.id) || '#8b5cf6';\n    \n    return (\n      <div \n        key={cls.id}\n        className=\"class-card group cursor-pointer hover:shadow-lg transition-all\"\n        style={{ borderLeft: `4px solid ${color}` }}\n        onClick={() => handleClassClick(cls.id)}\n      >\n        <div className=\"class-card-header\">\n          <div className=\"flex items-center gap-2.5\">\n            <div \n              className=\"w-3 h-3 rounded-full\"\n              style={{ background: color }}\n            />\n            <span className=\"class-card-name text-sm\">\n              {cls.name}\n            </span>\n            {cls.isCustom && (\n              <span className=\"badge badge-info text-xs\">Custom</span>\n            )}\n          </div>\n          <div className=\"flex gap-2 items-center\">\n            <span className=\"class-card-count\">{cls.sampleCount} images</span>\n            <ExternalLink size={14} className=\"text-[var(--text-muted)] opacity-0 group-hover:opacity-100 transition-opacity\" />\n            {showActions && (\n              <>\n                <button \n                  className=\"btn btn-outline btn-sm p-1 px-2\" \n                  onClick={(e) => { e.stopPropagation(); openEditModal(cls); }}\n                >\n                  <Edit2 size={12} />\n                </button>\n                <button \n                  className=\"btn btn-danger btn-sm p-1 px-2\" \n                  onClick={(e) => { e.stopPropagation(); deleteClass(cls.id); }}\n                >\n                  <Trash2 size={12} />\n                </button>\n              </>\n            )}\n          </div>\n        </div>\n        \n        {cls.description && (\n          <p className=\"class-card-description text-sm\">\n            {cls.description}\n          </p>\n        )}\n        \n        <div className=\"flex gap-4 mt-3 p-3 bg-[var(--bg-primary)] rounded-lg\">\n          <div className=\"text-center flex-1\">\n            <div className=\"text-xs text-[var(--text-muted)] mb-1\">\n              <Zap size={12} className=\"inline mr-1\" />\n              Energy\n            </div>\n            <div className=\"text-sm text-orange-500 font-semibold\">\n              {cls.embodiedEnergy || 'N/A'} MJ/kg\n            </div>\n          </div>\n          <div className=\"text-center flex-1\">\n            <div className=\"text-xs text-[var(--text-muted)] mb-1\">\n              <Leaf size={12} className=\"inline mr-1\" />\n              Carbon\n            </div>\n            <div className=\"text-sm text-emerald-500 font-semibold\">\n              {cls.embodiedCarbon || 'N/A'} kgCOâ‚‚/kg\n            </div>\n          </div>\n        </div>\n\n        {cls.alternatives?.length > 0 && (\n          <div className=\"mt-3\">\n            <div className=\"text-xs text-[var(--text-muted)] mb-1.5\">\n              Lower carbon alternatives:\n            </div>\n            <div className=\"flex gap-1.5 flex-wrap\">\n              {cls.alternatives.map(alt => (\n                <span key={alt} className=\"badge badge-info text-xs\">\n                  {alt.replace(/_/g, ' ')}\n                </span>\n              ))}\n            </div>\n          </div>\n        )}\n        \n        <div className=\"class-card-preview mt-3\">\n          {classSamples[cls.id]?.length > 0 ? (\n            classSamples[cls.id].map(sample => (\n              <img \n                key={sample.id}\n                src={sample.thumbnailUrl || sample.url}\n                alt={sample.filename}\n                className=\"w-12 h-12 rounded-md object-cover\"\n              />\n            ))\n          ) : (\n            <div className=\"flex items-center gap-2 text-[var(--text-muted)] text-sm py-2\">\n              <Image size={16} />\n              No training images yet\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div>\n      <div className=\"page-header\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h2>Material Classes</h2>\n            <p>Material database classes and custom classes for carbon footprint analysis</p>\n          </div>\n          <div className=\"flex gap-3\">\n            <button className=\"btn btn-outline\" onClick={openAddCategoryModal}>\n              <Layers size={16} />\n              Add Category\n            </button>\n            <button className=\"btn btn-primary\" onClick={openAddModal}>\n              <Plus size={16} />\n              Add Custom Class\n            </button>\n            <button className=\"btn btn-outline\" onClick={fetchClasses}>\n              <RefreshCw size={16} />\n              Refresh\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"card mb-6 bg-gradient-to-br from-slate-800 to-slate-900\">\n        <div className=\"flex items-center gap-4\">\n          <div className=\"w-14 h-14 rounded-xl bg-emerald-500/20 flex items-center justify-center\">\n            <Leaf size={28} className=\"text-emerald-500\" />\n          </div>\n          <div>\n            <h3 className=\"text-[var(--text-primary)] mb-1\">Material Classification System</h3>\n            <p className=\"text-muted\">\n              Manage material classes for accurate embodied carbon calculations.\n              Create custom categories and classes to extend your training dataset.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"card\">\n          <div className=\"empty-state\">\n            <RefreshCw size={48} className=\"spinning\" />\n            <h3>Loading materials...</h3>\n          </div>\n        </div>\n      ) : (\n        <>\n          <h3 className=\"text-[var(--text-primary)] mb-4 flex items-center gap-2\">\n            <Leaf size={18} className=\"text-emerald-500\" />\n            ICE Database Materials ({iceClasses.length})\n          </h3>\n          <div className=\"classes-grid mb-8\">\n            {iceClasses.map(cls => renderClassCard(cls, false))}\n          </div>\n\n          {customClasses.length > 0 && (\n            <>\n              <h3 className=\"text-[var(--text-primary)] mb-4 flex items-center gap-2\">\n                <FolderOpen size={18} className=\"text-blue-500\" />\n                Custom Classes ({customClasses.length})\n              </h3>\n              <div className=\"classes-grid mb-8\">\n                {customClasses.map(cls => renderClassCard(cls, true))}\n              </div>\n            </>\n          )}\n\n          {userCategories.length > 0 && (\n            <>\n              <h3 className=\"text-[var(--text-primary)] mb-4 flex items-center gap-2\">\n                <Settings size={18} className=\"text-purple-500\" />\n                User Categories\n              </h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\">\n                {userCategories.map(cat => (\n                  <div key={cat.id} className=\"card p-4 border-l-4 border-purple-500\">\n                    <div className=\"flex justify-between items-start\">\n                      <div>\n                        <h4 className=\"text-[var(--text-primary)] font-semibold\">{cat.name}</h4>\n                        <p className=\"text-sm text-[var(--text-muted)]\">{cat.description}</p>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <button \n                          className=\"btn btn-outline btn-sm p-1 px-2\"\n                          onClick={() => openEditCategoryModal(cat)}\n                        >\n                          <Edit2 size={12} />\n                        </button>\n                        <button \n                          className=\"btn btn-danger btn-sm p-1 px-2\"\n                          onClick={() => deleteCategory(cat.id)}\n                        >\n                          <Trash2 size={12} />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </>\n          )}\n        </>\n      )}\n\n      {showModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowModal(false)}>\n          <div className=\"modal max-w-lg\" onClick={e => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3 className=\"modal-title\">\n                {editingClass ? 'Edit Class' : 'Add Custom Class'}\n              </h3>\n              <button className=\"modal-close\" onClick={() => setShowModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n            \n            <form onSubmit={handleSubmit}>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Key (unique identifier)</label>\n                <input \n                  className=\"input\"\n                  value={formData.key}\n                  onChange={e => setFormData({ ...formData, key: e.target.value })}\n                  placeholder=\"e.g., recycled_concrete\"\n                  disabled={!!editingClass}\n                  required\n                />\n              </div>\n              \n              <div className=\"form-group\">\n                <label className=\"form-label\">Name</label>\n                <input \n                  className=\"input\"\n                  value={formData.name}\n                  onChange={e => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"e.g., Recycled Concrete\"\n                  required\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label className=\"form-label\">Category</label>\n                <select \n                  className=\"input\"\n                  value={formData.category}\n                  onChange={e => setFormData({ ...formData, category: e.target.value })}\n                >\n                  {categories.filter(c => c.id !== 'ice').map(cat => (\n                    <option key={cat.id} value={cat.id}>{cat.name}</option>\n                  ))}\n                </select>\n              </div>\n              \n              <div className=\"form-group\">\n                <label className=\"form-label\">Description</label>\n                <input \n                  className=\"input\"\n                  value={formData.description}\n                  onChange={e => setFormData({ ...formData, description: e.target.value })}\n                  placeholder=\"Brief description of the material\"\n                />\n              </div>\n              \n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"form-group\">\n                  <label className=\"form-label\">Embodied Energy (MJ/kg)</label>\n                  <input \n                    className=\"input\"\n                    type=\"number\"\n                    step=\"0.01\"\n                    value={formData.embodiedEnergy}\n                    onChange={e => setFormData({ ...formData, embodiedEnergy: e.target.value })}\n                    placeholder=\"0.00\"\n                  />\n                </div>\n                \n                <div className=\"form-group\">\n                  <label className=\"form-label\">Embodied Carbon (kgCOâ‚‚/kg)</label>\n                  <input \n                    className=\"input\"\n                    type=\"number\"\n                    step=\"0.001\"\n                    value={formData.embodiedCarbon}\n                    onChange={e => setFormData({ ...formData, embodiedCarbon: e.target.value })}\n                    placeholder=\"0.000\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"form-group\">\n                <label className=\"form-label\">Density (kg/mÂ³)</label>\n                <input \n                  className=\"input\"\n                  type=\"number\"\n                  value={formData.density}\n                  onChange={e => setFormData({ ...formData, density: e.target.value })}\n                  placeholder=\"0\"\n                />\n              </div>\n              \n              <div className=\"form-group\">\n                <label className=\"form-label\">Alternatives (comma-separated keys)</label>\n                <input \n                  className=\"input\"\n                  value={formData.alternatives}\n                  onChange={e => setFormData({ ...formData, alternatives: e.target.value })}\n                  placeholder=\"e.g., concrete, limestone_block\"\n                />\n              </div>\n              \n              <div className=\"modal-footer\">\n                <button type=\"button\" className=\"btn btn-outline\" onClick={() => setShowModal(false)}>\n                  Cancel\n                </button>\n                <button type=\"submit\" className=\"btn btn-primary\">\n                  <Save size={16} />\n                  {editingClass ? 'Update' : 'Create'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {showCategoryModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowCategoryModal(false)}>\n          <div className=\"modal max-w-md\" onClick={e => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3 className=\"modal-title\">\n                {editingCategory ? 'Edit Category' : 'Add New Category'}\n              </h3>\n              <button className=\"modal-close\" onClick={() => setShowCategoryModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n            \n            <form onSubmit={handleCategorySubmit}>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Category ID</label>\n                <input \n                  className=\"input\"\n                  value={categoryFormData.id}\n                  onChange={e => setCategoryFormData({ ...categoryFormData, id: e.target.value })}\n                  placeholder=\"e.g., recycled_materials\"\n                  disabled={!!editingCategory}\n                  required\n                />\n                <p className=\"text-xs text-[var(--text-muted)] mt-1\">Lowercase, use underscores for spaces</p>\n              </div>\n              \n              <div className=\"form-group\">\n                <label className=\"form-label\">Category Name</label>\n                <input \n                  className=\"input\"\n                  value={categoryFormData.name}\n                  onChange={e => setCategoryFormData({ ...categoryFormData, name: e.target.value })}\n                  placeholder=\"e.g., Recycled Materials\"\n                  required\n                />\n              </div>\n              \n              <div className=\"form-group\">\n                <label className=\"form-label\">Description</label>\n                <input \n                  className=\"input\"\n                  value={categoryFormData.description}\n                  onChange={e => setCategoryFormData({ ...categoryFormData, description: e.target.value })}\n                  placeholder=\"Brief description of this category\"\n                />\n              </div>\n              \n              <div className=\"modal-footer\">\n                <button type=\"button\" className=\"btn btn-outline\" onClick={() => setShowCategoryModal(false)}>\n                  Cancel\n                </button>\n                <button type=\"submit\" className=\"btn btn-primary\">\n                  <Save size={16} />\n                  {editingCategory ? 'Update' : 'Create'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Classes;\n","path":null,"size_bytes":22536,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n","path":null,"size_bytes":584,"size_tokens":null},"client/src/pages/legal/cookies.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout } from \"lucide-react\";\n\nexport default function Cookies() {\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-12 max-w-3xl\">\n        <h1 className=\"text-4xl font-display font-bold mb-8\">Cookie Policy</h1>\n        <div className=\"prose prose-slate dark:prose-invert max-w-none space-y-6 text-muted-foreground\">\n          <p>Last updated: December 03, 2025</p>\n          \n          <h2 className=\"text-2xl font-bold text-foreground\">1. What Are Cookies</h2>\n          <p>As is common practice with almost all professional websites this site uses cookies, which are tiny files that are downloaded to your computer, to improve your experience. This page describes what information they gather, how we use it and why we sometimes need to store these cookies.</p>\n\n          <h2 className=\"text-2xl font-bold text-foreground\">2. How We Use Cookies</h2>\n          <p>We use cookies for a variety of reasons detailed below. Unfortunately in most cases there are no industry standard options for disabling cookies without completely disabling the functionality and features they add to this site.</p>\n          <ul className=\"list-disc pl-6 space-y-2\">\n            <li><strong>Account related cookies:</strong> If you create an account with us then we will use cookies for the management of the signup process and general administration.</li>\n            <li><strong>Login related cookies:</strong> We use cookies when you are logged in so that we can remember this fact. This prevents you from having to log in every single time you visit a new page.</li>\n            <li><strong>Site preferences cookies:</strong> In order to provide you with a great experience on this site we provide the functionality to set your preferences for how this site runs when you use it.</li>\n          </ul>\n\n          <h2 className=\"text-2xl font-bold text-foreground\">3. Disabling Cookies</h2>\n          <p>You can prevent the setting of cookies by adjusting the settings on your browser (see your browser Help for how to do this). Be aware that disabling cookies will affect the functionality of this and many other websites that you visit.</p>\n        </div>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":3193,"size_tokens":null},"MLStudio-main/client/src/pages/Testing.jsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { \n  TestTube, \n  Upload, \n  Image,\n  Target,\n  TrendingUp,\n  Leaf,\n  Zap,\n  RefreshCw,\n  CheckCircle,\n  AlertCircle,\n  BarChart3\n} from 'lucide-react';\n\nfunction Testing() {\n  const [models, setModels] = useState([]);\n  const [selectedModel, setSelectedModel] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [predicting, setPredicting] = useState(false);\n  const [imagePreview, setImagePreview] = useState(null);\n  const [imageFile, setImageFile] = useState(null);\n  const [prediction, setPrediction] = useState(null);\n  const [error, setError] = useState(null);\n  const fileInputRef = useRef(null);\n\n  useEffect(() => {\n    fetchModels();\n  }, []);\n\n  const fetchModels = async () => {\n    try {\n      const response = await fetch('/api/models');\n      const data = await response.json();\n      const completedModels = data.filter(m => m.status === 'completed');\n      setModels(completedModels);\n      \n      const active = completedModels.find(m => m.isActive);\n      if (active) {\n        setSelectedModel(active);\n      } else if (completedModels.length > 0) {\n        setSelectedModel(completedModels[0]);\n      }\n    } catch (error) {\n      console.error('Error fetching models:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFileSelect = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      setImageFile(file);\n      setImagePreview(URL.createObjectURL(file));\n      setPrediction(null);\n      setError(null);\n    }\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    const file = e.dataTransfer.files[0];\n    if (file && file.type.startsWith('image/')) {\n      setImageFile(file);\n      setImagePreview(URL.createObjectURL(file));\n      setPrediction(null);\n      setError(null);\n    }\n  };\n\n  const runPrediction = async () => {\n    if (!imageFile || !selectedModel) return;\n\n    setPredicting(true);\n    setError(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('image', imageFile);\n      formData.append('modelId', selectedModel.id);\n\n      const response = await fetch('/api/predict', {\n        method: 'POST',\n        body: formData\n      });\n\n      if (!response.ok) {\n        const err = await response.json();\n        throw new Error(err.error || 'Prediction failed');\n      }\n\n      const result = await response.json();\n      setPrediction(result);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setPredicting(false);\n    }\n  };\n\n  const clearTest = () => {\n    setImageFile(null);\n    setImagePreview(null);\n    setPrediction(null);\n    setError(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"card\">\n        <div className=\"empty-state\">\n          <RefreshCw size={48} className=\"spinning\" />\n          <h3>Loading models...</h3>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"page-header\">\n        <h2>Model Testing</h2>\n        <p>Test your trained models by uploading images and analyzing predictions</p>\n      </div>\n\n      {models.length === 0 ? (\n        <div className=\"card\">\n          <div className=\"empty-state\">\n            <TestTube size={64} />\n            <h3>No trained models available</h3>\n            <p>Train a model first to test predictions</p>\n            <a href=\"/training\" className=\"btn btn-primary mt-4\">Go to Training</a>\n          </div>\n        </div>\n      ) : (\n        <>\n          <div className=\"card\">\n            <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>Select Model to Test</h3>\n            <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>\n              {models.map(model => (\n                <button\n                  key={model.id}\n                  className={`btn ${selectedModel?.id === model.id ? 'btn-primary' : 'btn-outline'}`}\n                  onClick={() => setSelectedModel(model)}\n                >\n                  {model.isActive && <CheckCircle size={14} />}\n                  {model.name}\n                  <span style={{ opacity: 0.7, marginLeft: '8px' }}>\n                    ({(model.metrics?.valAccuracy * 100).toFixed(1)}%)\n                  </span>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>\n            <div className=\"card\">\n              <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>Upload Test Image</h3>\n              \n              <div\n                className={`upload-zone ${imagePreview ? 'has-image' : ''}`}\n                onDrop={handleDrop}\n                onDragOver={(e) => e.preventDefault()}\n                onClick={() => fileInputRef.current?.click()}\n                style={{ \n                  minHeight: '300px',\n                  display: 'flex',\n                  flexDirection: 'column',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n              >\n                {imagePreview ? (\n                  <img \n                    src={imagePreview} \n                    alt=\"Test\" \n                    style={{ \n                      maxWidth: '100%', \n                      maxHeight: '280px', \n                      borderRadius: '8px',\n                      objectFit: 'contain'\n                    }} \n                  />\n                ) : (\n                  <>\n                    <Image size={48} className=\"upload-zone-icon\" />\n                    <p className=\"upload-zone-text\">\n                      <strong>Click to upload</strong> or drag and drop\n                    </p>\n                    <p className=\"upload-zone-text\">\n                      JPEG, PNG or WebP images\n                    </p>\n                  </>\n                )}\n              </div>\n              \n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/jpeg,image/png,image/webp\"\n                style={{ display: 'none' }}\n                onChange={handleFileSelect}\n              />\n\n              <div style={{ display: 'flex', gap: '12px', marginTop: '16px' }}>\n                <button \n                  className=\"btn btn-primary\"\n                  onClick={runPrediction}\n                  disabled={!imageFile || predicting}\n                  style={{ flex: 1 }}\n                >\n                  {predicting ? (\n                    <>\n                      <RefreshCw size={16} className=\"spinning\" />\n                      Analyzing...\n                    </>\n                  ) : (\n                    <>\n                      <Target size={16} />\n                      Run Prediction\n                    </>\n                  )}\n                </button>\n                {imagePreview && (\n                  <button className=\"btn btn-outline\" onClick={clearTest}>\n                    Clear\n                  </button>\n                )}\n              </div>\n            </div>\n\n            <div className=\"card\">\n              <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>\n                <BarChart3 size={20} style={{ display: 'inline', marginRight: '8px' }} />\n                Prediction Results\n              </h3>\n\n              {error && (\n                <div style={{ \n                  padding: '16px', \n                  background: 'rgba(239, 68, 68, 0.1)', \n                  borderRadius: '8px',\n                  color: '#ef4444',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '12px'\n                }}>\n                  <AlertCircle size={20} />\n                  {error}\n                </div>\n              )}\n\n              {!prediction && !error && (\n                <div className=\"empty-state\" style={{ padding: '40px' }}>\n                  <Target size={48} />\n                  <h3>No prediction yet</h3>\n                  <p>Upload an image and click \"Run Prediction\"</p>\n                </div>\n              )}\n\n              {prediction && (\n                <div>\n                  <div style={{ \n                    padding: '20px', \n                    background: 'rgba(16, 185, 129, 0.1)', \n                    borderRadius: '12px',\n                    marginBottom: '20px'\n                  }}>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>\n                      <CheckCircle size={24} color=\"#10b981\" />\n                      <div>\n                        <div style={{ color: '#f8fafc', fontWeight: '600', fontSize: '18px' }}>\n                          {prediction.prediction.className.replace(/_/g, ' ')}\n                        </div>\n                        <div className=\"text-muted text-sm\">Top Prediction</div>\n                      </div>\n                    </div>\n                    \n                    <div style={{ \n                      background: 'var(--bg-primary)', \n                      borderRadius: '8px', \n                      height: '12px', \n                      overflow: 'hidden',\n                      marginBottom: '8px'\n                    }}>\n                      <div style={{ \n                        width: `${prediction.prediction.confidence * 100}%`,\n                        height: '100%',\n                        background: 'linear-gradient(90deg, #10b981, #34d399)',\n                        borderRadius: '8px',\n                        transition: 'width 0.5s'\n                      }} />\n                    </div>\n                    <div style={{ fontSize: '24px', fontWeight: '700', color: '#10b981' }}>\n                      {(prediction.prediction.confidence * 100).toFixed(1)}% confidence\n                    </div>\n                  </div>\n\n                  {prediction.material && (\n                    <div style={{ \n                      display: 'grid', \n                      gridTemplateColumns: 'repeat(2, 1fr)', \n                      gap: '12px',\n                      marginBottom: '20px'\n                    }}>\n                      <div className=\"metric-box\">\n                        <div style={{ color: '#f97316', fontSize: '18px', fontWeight: '600' }}>\n                          <Zap size={16} style={{ display: 'inline', marginRight: '6px' }} />\n                          {prediction.material.embodiedEnergy} MJ/kg\n                        </div>\n                        <div className=\"metric-label\">Embodied Energy</div>\n                      </div>\n                      <div className=\"metric-box\">\n                        <div style={{ color: '#10b981', fontSize: '18px', fontWeight: '600' }}>\n                          <Leaf size={16} style={{ display: 'inline', marginRight: '6px' }} />\n                          {prediction.material.embodiedCarbon} kgCOâ‚‚/kg\n                        </div>\n                        <div className=\"metric-label\">Embodied Carbon</div>\n                      </div>\n                    </div>\n                  )}\n\n                  <h4 style={{ color: '#f8fafc', marginBottom: '12px' }}>All Predictions</h4>\n                  <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                    {prediction.allPredictions.map((p, idx) => (\n                      <div \n                        key={p.class}\n                        style={{ \n                          display: 'flex', \n                          alignItems: 'center', \n                          gap: '12px',\n                          padding: '12px',\n                          background: idx === 0 ? 'rgba(16, 185, 129, 0.1)' : 'var(--bg-primary)',\n                          borderRadius: '8px'\n                        }}\n                      >\n                        <div style={{ \n                          width: '24px', \n                          height: '24px', \n                          borderRadius: '50%', \n                          background: idx === 0 ? '#10b981' : '#475569',\n                          display: 'flex',\n                          alignItems: 'center',\n                          justifyContent: 'center',\n                          fontSize: '12px',\n                          fontWeight: '600',\n                          color: 'white'\n                        }}>\n                          {idx + 1}\n                        </div>\n                        <div style={{ flex: 1 }}>\n                          <div style={{ color: '#f8fafc', fontWeight: '500' }}>\n                            {p.className.replace(/_/g, ' ')}\n                          </div>\n                          <div style={{ \n                            height: '4px', \n                            background: '#334155', \n                            borderRadius: '2px', \n                            marginTop: '6px',\n                            overflow: 'hidden'\n                          }}>\n                            <div style={{ \n                              width: `${p.confidence * 100}%`,\n                              height: '100%',\n                              background: idx === 0 ? '#10b981' : '#3b82f6',\n                              borderRadius: '2px'\n                            }} />\n                          </div>\n                        </div>\n                        <div style={{ \n                          color: idx === 0 ? '#10b981' : '#94a3b8',\n                          fontWeight: '600',\n                          minWidth: '60px',\n                          textAlign: 'right'\n                        }}>\n                          {(p.confidence * 100).toFixed(1)}%\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n\n                  <div style={{ \n                    marginTop: '20px', \n                    padding: '16px', \n                    background: 'var(--bg-primary)', \n                    borderRadius: '8px' \n                  }}>\n                    <h4 style={{ color: '#f8fafc', marginBottom: '8px', fontSize: '14px' }}>\n                      <TrendingUp size={16} style={{ display: 'inline', marginRight: '6px' }} />\n                      Model Info\n                    </h4>\n                    <div className=\"text-muted text-sm\">\n                      <div>Model: {prediction.modelName}</div>\n                      <div>Model Accuracy: {(prediction.analysis.modelAccuracy * 100).toFixed(1)}%</div>\n                      <div>Image Size: {prediction.analysis.imageSize.width}x{prediction.analysis.imageSize.height}</div>\n                    </div>\n                  </div>\n\n                  {prediction.material?.alternatives?.length > 0 && (\n                    <div style={{ \n                      marginTop: '16px', \n                      padding: '16px', \n                      background: 'rgba(139, 92, 246, 0.1)', \n                      borderRadius: '8px' \n                    }}>\n                      <h4 style={{ color: '#8b5cf6', marginBottom: '8px', fontSize: '14px' }}>\n                        Lower Carbon Alternatives\n                      </h4>\n                      <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>\n                        {prediction.material.alternatives.map(alt => (\n                          <span key={alt} className=\"badge badge-info\">\n                            {alt.replace(/_/g, ' ')}\n                          </span>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default Testing;\n","path":null,"size_bytes":15735,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { connectDB } from \"./db/mongoose\";\nimport apiRoutes from \"./routes/index\";\nimport express from \"express\";\nimport path from \"path\";\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  await connectDB();\n  \n  app.use('/uploads', express.static(path.join(process.cwd(), 'uploads')));\n  \n  app.use('/api', apiRoutes);\n\n  return httpServer;\n}\n","path":null,"size_bytes":483,"size_tokens":null},"MLStudio-main/client/postcss.config.js":{"content":"export default {\n  plugins: {\n    '@tailwindcss/postcss': {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":91,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"client/src/components/alternatives.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle, CardFooter } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { ArrowRight, Star, Leaf, ChevronLeft, ChevronRight } from \"lucide-react\";\nimport hempTexture from '@assets/generated_images/hempcrete_texture.png';\nimport steelTexture from '@assets/generated_images/recycled_steel_texture.png';\nimport { useState } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Link } from \"wouter\";\n\nconst alternatives = [\n  {\n    id: 1,\n    name: \"Hempcrete Block\",\n    category: \"Bio-Composite\",\n    impact: \"Very Low\",\n    impactColor: \"bg-green-100 text-green-700 hover:bg-green-100\",\n    description: \"Carbon-negative material made from hemp hurds and lime. Excellent insulation properties.\",\n    image: hempTexture,\n    savings: \"92%\"\n  },\n  {\n    id: 2,\n    name: \"Recycled Steel\",\n    category: \"Metal\",\n    impact: \"Medium\",\n    impactColor: \"bg-yellow-100 text-yellow-700 hover:bg-yellow-100\",\n    description: \"Reclaimed structural steel with significantly lower embodied energy than virgin steel.\",\n    image: steelTexture,\n    savings: \"45%\"\n  },\n  {\n    id: 3,\n    name: \"Mycelium Insulation\",\n    category: \"Bio-Material\",\n    impact: \"Very Low\",\n    impactColor: \"bg-green-100 text-green-700 hover:bg-green-100\",\n    description: \"Root structure of mushrooms grown into molds. Fully biodegradable and fire resistant.\",\n    image: \"https://images.unsplash.com/photo-1611420379240-592943150407?auto=format&fit=crop&q=80&w=800\",\n    savings: \"98%\"\n  },\n  {\n    id: 4,\n    name: \"Bamboo Flooring\",\n    category: \"Wood\",\n    impact: \"Low\",\n    impactColor: \"bg-green-100 text-green-700 hover:bg-green-100\",\n    description: \"Rapidly renewable resource with tensile strength comparable to steel.\",\n    image: \"https://images.unsplash.com/photo-1610504463627-7937732c9452?auto=format&fit=crop&q=80&w=800\",\n    savings: \"35%\"\n  },\n  {\n    id: 5,\n    name: \"Rammed Earth\",\n    category: \"Earth\",\n    impact: \"Very Low\",\n    impactColor: \"bg-green-100 text-green-700 hover:bg-green-100\",\n    description: \"Sustainable building technique using compacted natural raw materials.\",\n    image: \"https://images.unsplash.com/photo-1591955506264-3f5a6834570a?auto=format&fit=crop&q=80&w=800\",\n    savings: \"85%\"\n  }\n];\n\nexport function AlternativesGrid() {\n  const [startIndex, setStartIndex] = useState(0);\n  const itemsPerPage = 3; // Show 3 items at a time in the carousel view\n\n  const nextSlide = () => {\n    setStartIndex((prev) => (prev + 1) % (alternatives.length - itemsPerPage + 1));\n  };\n\n  const prevSlide = () => {\n    setStartIndex((prev) => Math.max(0, prev - 1));\n  };\n\n  const visibleAlternatives = alternatives.slice(startIndex, startIndex + itemsPerPage);\n  const canScrollRight = startIndex < alternatives.length - itemsPerPage;\n  const canScrollLeft = startIndex > 0;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-2xl font-display font-bold\">Recommended Alternatives</h2>\n        <div className=\"flex gap-2\">\n           <Button \n            variant=\"outline\" \n            size=\"icon\" \n            onClick={prevSlide} \n            disabled={!canScrollLeft}\n            className=\"rounded-full hover:bg-primary/10 hover:text-primary transition-colors\"\n          >\n            <ChevronLeft className=\"w-4 h-4\" />\n          </Button>\n          <Button \n            variant=\"outline\" \n            size=\"icon\" \n            onClick={nextSlide} \n            disabled={!canScrollRight}\n            className=\"rounded-full hover:bg-primary/10 hover:text-primary transition-colors\"\n          >\n            <ChevronRight className=\"w-4 h-4\" />\n          </Button>\n          <Link href=\"/materials\">\n             <Button variant=\"ghost\" className=\"text-primary ml-2\">View All <ArrowRight className=\"ml-2 w-4 h-4\" /></Button>\n          </Link>\n        </div>\n      </div>\n      \n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <AnimatePresence mode=\"popLayout\">\n          {visibleAlternatives.map((alt) => (\n            <motion.div\n              key={alt.id}\n              layout\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n              transition={{ duration: 0.3 }}\n            >\n              <Card className=\"h-full group overflow-hidden border-none shadow-md hover:shadow-xl transition-all duration-300 bg-white hover:-translate-y-1 flex flex-col\">\n                <div className=\"relative h-48 overflow-hidden shrink-0\">\n                  <img \n                    src={alt.image} \n                    alt={alt.name} \n                    className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\"\n                  />\n                  <div className=\"absolute top-4 right-4 z-10\">\n                    <Badge className={`${alt.impactColor} border-none shadow-sm backdrop-blur-sm bg-opacity-90`}>\n                      <Leaf className=\"w-3 h-3 mr-1\" /> {alt.impact}\n                    </Badge>\n                  </div>\n                  <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-4\">\n                    <span className=\"text-white text-xs font-bold tracking-wider uppercase opacity-90 drop-shadow-md\">{alt.category}</span>\n                  </div>\n                </div>\n                \n                <CardHeader className=\"pb-2\">\n                  <div className=\"flex flex-col gap-2\">\n                    <CardTitle className=\"text-xl group-hover:text-primary transition-colors line-clamp-1\" title={alt.name}>{alt.name}</CardTitle>\n                    <Badge variant=\"outline\" className=\"w-fit border-primary text-primary font-bold bg-primary/5\">\n                      -{alt.savings} CO2 Reduction\n                    </Badge>\n                  </div>\n                </CardHeader>\n                \n                <CardContent className=\"flex-grow\">\n                  <p className=\"text-sm text-muted-foreground leading-relaxed line-clamp-3\">\n                    {alt.description}\n                  </p>\n                </CardContent>\n                \n                <CardFooter className=\"mt-auto pt-4 border-t border-border/50 bg-secondary/10\">\n                  <Link href={`/materials/${alt.id}`} className=\"w-full\">\n                    <Button className=\"w-full group-hover:bg-primary group-hover:text-white transition-colors shadow-sm\">\n                      View Specs\n                    </Button>\n                  </Link>\n                </CardFooter>\n              </Card>\n            </motion.div>\n          ))}\n        </AnimatePresence>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":6836,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"client/src/pages/contact.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout, Mail, MapPin, Phone } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\nexport default function Contact() {\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-12\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12 items-start max-w-5xl mx-auto\">\n            <div className=\"space-y-8\">\n                <div>\n                    <h1 className=\"text-4xl font-display font-bold mb-4\">Get in touch</h1>\n                    <p className=\"text-lg text-muted-foreground\">\n                        Have questions about our enterprise solutions or need technical support? We're here to help.\n                    </p>\n                </div>\n\n                <div className=\"space-y-6\">\n                    <Card className=\"border-none shadow-md bg-secondary/10\">\n                        <CardContent className=\"p-6 flex items-start gap-4\">\n                            <div className=\"bg-primary/10 p-3 rounded-lg text-primary\">\n                                <Mail className=\"w-6 h-6\" />\n                            </div>\n                            <div>\n                                <h3 className=\"font-bold mb-1\">Email Us</h3>\n                                <p className=\"text-sm text-muted-foreground mb-1\">Our friendly team is here to help.</p>\n                                <a href=\"mailto:hello@ecobuild.ai\" className=\"text-primary hover:underline font-medium\">hello@ecobuild.ai</a>\n                            </div>\n                        </CardContent>\n                    </Card>\n\n                    <Card className=\"border-none shadow-md bg-secondary/10\">\n                        <CardContent className=\"p-6 flex items-start gap-4\">\n                            <div className=\"bg-primary/10 p-3 rounded-lg text-primary\">\n                                <MapPin className=\"w-6 h-6\" />\n                            </div>\n                            <div>\n                                <h3 className=\"font-bold mb-1\">Visit Us</h3>\n                                <p className=\"text-sm text-muted-foreground mb-1\">Come say hello at our office.</p>\n                                <p className=\"text-foreground font-medium\">100 Sustainable Way, Green City, 12345</p>\n                            </div>\n                        </CardContent>\n                    </Card>\n\n                    <Card className=\"border-none shadow-md bg-secondary/10\">\n                        <CardContent className=\"p-6 flex items-start gap-4\">\n                            <div className=\"bg-primary/10 p-3 rounded-lg text-primary\">\n                                <Phone className=\"w-6 h-6\" />\n                            </div>\n                            <div>\n                                <h3 className=\"font-bold mb-1\">Call Us</h3>\n                                <p className=\"text-sm text-muted-foreground mb-1\">Mon-Fri from 8am to 5pm.</p>\n                                <p className=\"text-foreground font-medium\">+1 (555) 000-0000</p>\n                            </div>\n                        </CardContent>\n                    </Card>\n                </div>\n            </div>\n\n            <div className=\"bg-card border border-border rounded-xl p-8 shadow-lg\">\n                <form className=\"space-y-6\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"space-y-2\">\n                            <Label htmlFor=\"first-name\">First name</Label>\n                            <Input id=\"first-name\" placeholder=\"Jane\" />\n                        </div>\n                        <div className=\"space-y-2\">\n                            <Label htmlFor=\"last-name\">Last name</Label>\n                            <Input id=\"last-name\" placeholder=\"Doe\" />\n                        </div>\n                    </div>\n                    <div className=\"space-y-2\">\n                        <Label htmlFor=\"email\">Email</Label>\n                        <Input id=\"email\" type=\"email\" placeholder=\"jane@company.com\" />\n                    </div>\n                    <div className=\"space-y-2\">\n                        <Label htmlFor=\"message\">Message</Label>\n                        <textarea \n                            className=\"flex min-h-[150px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 resize-none\"\n                            placeholder=\"How can we help you?\"\n                        />\n                    </div>\n                    <Button type=\"submit\" className=\"w-full\" size=\"lg\">Send Message</Button>\n                </form>\n            </div>\n        </div>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":5935,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { AuthProvider, useAuth } from \"./lib/auth-context\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/landing\";\nimport Home from \"@/pages/home\";\nimport MaterialsLibrary from \"@/pages/materials-library\";\nimport MaterialDetail from \"@/pages/material-detail\";\nimport Projects from \"@/pages/projects\";\nimport ProjectDetail from \"@/pages/project-detail\";\nimport Reports from \"@/pages/reports\";\nimport AuthPage from \"@/pages/auth\";\nimport Profile from \"@/pages/profile\";\nimport Subscription from \"@/pages/subscription\";\nimport Settings from \"@/pages/settings\";\nimport About from \"@/pages/about\";\nimport Privacy from \"@/pages/legal/privacy\";\nimport Terms from \"@/pages/legal/terms\";\nimport Cookies from \"@/pages/legal/cookies\";\nimport Contact from \"@/pages/contact\";\nimport CaseStudies from \"@/pages/case-studies\";\nimport ApiDocs from \"@/pages/api-docs\";\nimport Pricing from \"@/pages/pricing\";\nimport Features from \"@/pages/features\";\nimport ScanHistory from \"@/pages/scan-history\";\n\nfunction ProtectedRoute({ component: Component }: { component: React.ComponentType }) {\n  const { isAuthenticated, loading } = useAuth();\n  \n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n      </div>\n    );\n  }\n  \n  if (!isAuthenticated) {\n    return <Redirect to=\"/auth\" />;\n  }\n  \n  return <Component />;\n}\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Landing} />\n      <Route path=\"/dashboard\">\n        <ProtectedRoute component={Home} />\n      </Route>\n      <Route path=\"/auth\" component={AuthPage} />\n      <Route path=\"/materials\" component={MaterialsLibrary} />\n      <Route path=\"/materials/:id\" component={MaterialDetail} />\n      <Route path=\"/projects\">\n        <ProtectedRoute component={Projects} />\n      </Route>\n      <Route path=\"/projects/:id\">\n        <ProtectedRoute component={ProjectDetail} />\n      </Route>\n      <Route path=\"/reports\">\n        <ProtectedRoute component={Reports} />\n      </Route>\n      <Route path=\"/profile\">\n        <ProtectedRoute component={Profile} />\n      </Route>\n      <Route path=\"/subscription\">\n        <ProtectedRoute component={Subscription} />\n      </Route>\n      <Route path=\"/settings\">\n        <ProtectedRoute component={Settings} />\n      </Route>\n      <Route path=\"/history\">\n        <ProtectedRoute component={ScanHistory} />\n      </Route>\n      <Route path=\"/about\" component={About} />\n      <Route path=\"/privacy\" component={Privacy} />\n      <Route path=\"/terms\" component={Terms} />\n      <Route path=\"/cookies\" component={Cookies} />\n      <Route path=\"/contact\" component={Contact} />\n      <Route path=\"/case-studies\" component={CaseStudies} />\n      <Route path=\"/api\" component={ApiDocs} />\n      <Route path=\"/pricing\" component={Pricing} />\n      <Route path=\"/features\" component={Features} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </AuthProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":3558,"size_tokens":null},"client/src/pages/features.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout, Scan, BarChart3, Leaf, Smartphone, Cloud, Lock, Zap } from \"lucide-react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\nexport default function Features() {\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main>\n        {/* Hero */}\n        <section className=\"py-20 bg-secondary/10\">\n            <div className=\"container mx-auto px-4 text-center max-w-3xl\">\n                <h1 className=\"text-4xl md:text-5xl font-display font-bold mb-6\">Powerful Tools for Sustainable Design</h1>\n                <p className=\"text-xl text-muted-foreground mb-8\">\n                    Everything you need to measure, analyze, and reduce the carbon footprint of your construction projects.\n                </p>\n                <Link href=\"/auth\">\n                    <Button size=\"lg\" className=\"px-8\">Try for Free</Button>\n                </Link>\n            </div>\n        </section>\n\n        {/* Feature Grid */}\n        <section className=\"py-20\">\n            <div className=\"container mx-auto px-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-12\">\n                    <div className=\"space-y-4\">\n                        <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary\">\n                            <Scan className=\"w-6 h-6\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold\">Visual Material Recognition</h3>\n                        <p className=\"text-muted-foreground\">\n                            Upload photos from site visits and let our AI identify materials instantly. Works on raw materials, surfaces, and construction elements.\n                        </p>\n                    </div>\n                    <div className=\"space-y-4\">\n                        <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary\">\n                            <BarChart3 className=\"w-6 h-6\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold\">Lifecycle Assessment (LCA)</h3>\n                        <p className=\"text-muted-foreground\">\n                            Get instant calculations for Global Warming Potential (GWP), embodied energy, and acidification potential based on volume.\n                        </p>\n                    </div>\n                    <div className=\"space-y-4\">\n                        <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary\">\n                            <Leaf className=\"w-6 h-6\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold\">Alternative Recommendations</h3>\n                        <p className=\"text-muted-foreground\">\n                            Don't just identify the problem, solve it. Our engine suggests structurally viable, low-carbon alternatives for every material scanned.\n                        </p>\n                    </div>\n                    <div className=\"space-y-4\">\n                        <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary\">\n                            <Smartphone className=\"w-6 h-6\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold\">Mobile Optimized</h3>\n                        <p className=\"text-muted-foreground\">\n                            Designed for the job site. Use EcoBuild.AI on your tablet or phone to scan materials right where they are installed.\n                        </p>\n                    </div>\n                    <div className=\"space-y-4\">\n                        <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary\">\n                            <Cloud className=\"w-6 h-6\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold\">Cloud Sync</h3>\n                        <p className=\"text-muted-foreground\">\n                            All your projects, scans, and reports are synced across devices in real-time. Collaborate with your team from anywhere.\n                        </p>\n                    </div>\n                    <div className=\"space-y-4\">\n                        <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary\">\n                            <Lock className=\"w-6 h-6\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold\">Enterprise Security</h3>\n                        <p className=\"text-muted-foreground\">\n                            Bank-grade encryption and SOC2 compliant infrastructure ensure your proprietary project data stays safe.\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </section>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":5843,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"client/src/pages/about.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout, Users, Globe, ShieldCheck } from \"lucide-react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport heroImage from \"@assets/generated_images/hero_image_for_sustainable_construction_app.png\";\n\nexport default function About() {\n  return (\n    <div className=\"min-h-screen bg-background font-sans\">\n       {/* Navigation */}\n       <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg group-hover:scale-110 transition-transform\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main>\n        {/* Hero */}\n        <section className=\"relative py-20 overflow-hidden\">\n             <div className=\"absolute inset-0 z-0 opacity-10\">\n              <img src={heroImage} alt=\"Construction Site\" className=\"w-full h-full object-cover\" />\n            </div>\n            <div className=\"container mx-auto px-4 relative z-10 text-center max-w-3xl\">\n                <h1 className=\"text-4xl md:text-6xl font-display font-bold mb-6\">Our Mission is to <span className=\"text-primary\">Decarbonize Construction</span></h1>\n                <p className=\"text-xl text-muted-foreground leading-relaxed\">\n                    We believe that every building starts with a choice. By empowering architects and engineers with intelligent data, we can reduce the built environment's carbon footprint, one material at a time.\n                </p>\n            </div>\n        </section>\n\n        {/* Stats */}\n        <section className=\"py-12 bg-secondary/20\">\n            <div className=\"container mx-auto px-4\">\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 text-center\">\n                    <div>\n                        <h3 className=\"text-4xl font-bold text-primary mb-2\">2.4M+</h3>\n                        <p className=\"text-sm text-muted-foreground\">Materials Analyzed</p>\n                    </div>\n                    <div>\n                        <h3 className=\"text-4xl font-bold text-primary mb-2\">450k</h3>\n                        <p className=\"text-sm text-muted-foreground\">Tons CO2 Offset</p>\n                    </div>\n                    <div>\n                        <h3 className=\"text-4xl font-bold text-primary mb-2\">12k+</h3>\n                        <p className=\"text-sm text-muted-foreground\">Active Architects</p>\n                    </div>\n                    <div>\n                        <h3 className=\"text-4xl font-bold text-primary mb-2\">98%</h3>\n                        <p className=\"text-sm text-muted-foreground\">Accuracy Rate</p>\n                    </div>\n                </div>\n            </div>\n        </section>\n\n        {/* Story */}\n        <section className=\"py-20\">\n            <div className=\"container mx-auto px-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-12 items-center\">\n                    <div>\n                        <img \n                            src=\"https://images.unsplash.com/photo-1531482615713-2afd69097998?auto=format&fit=crop&q=80&w=1200\" \n                            alt=\"Team working\" \n                            className=\"rounded-2xl shadow-2xl\"\n                        />\n                    </div>\n                    <div className=\"space-y-6\">\n                        <h2 className=\"text-3xl font-display font-bold\">Built by Architects, for Architects</h2>\n                        <p className=\"text-muted-foreground leading-relaxed\">\n                            EcoBuild.AI was founded in 2024 by a team of structural engineers and data scientists who were frustrated by the lack of transparent environmental data in the construction industry.\n                        </p>\n                        <p className=\"text-muted-foreground leading-relaxed\">\n                            We realized that while sustainable alternatives existed, they were often hard to find or difficult to compare against standard materials. We set out to change that by building the world's most comprehensive material intelligence platform.\n                        </p>\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4\">\n                            <div className=\"flex items-start gap-3\">\n                                <Globe className=\"w-6 h-6 text-primary shrink-0\" />\n                                <div>\n                                    <h4 className=\"font-bold text-sm\">Global Database</h4>\n                                    <p className=\"text-xs text-muted-foreground\">Sourced from certified EPDs worldwide.</p>\n                                </div>\n                            </div>\n                            <div className=\"flex items-start gap-3\">\n                                <ShieldCheck className=\"w-6 h-6 text-primary shrink-0\" />\n                                <div>\n                                    <h4 className=\"font-bold text-sm\">Verified Data</h4>\n                                    <p className=\"text-xs text-muted-foreground\">ISO 14040 compliant lifecycle assessments.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </section>\n        \n        <section className=\"py-20 bg-slate-900 text-white text-center\">\n            <div className=\"container mx-auto px-4 max-w-2xl\">\n                <h2 className=\"text-3xl font-display font-bold mb-6\">Ready to build the future?</h2>\n                <p className=\"text-slate-300 mb-8 text-lg\">Join the community of forward-thinking professionals using EcoBuild.AI today.</p>\n                <Link href=\"/auth\">\n                    <Button size=\"lg\" className=\"px-8\">Get Started for Free</Button>\n                </Link>\n            </div>\n        </section>\n\n      </main>\n      \n       {/* Footer (Consistent with Landing) */}\n       <footer className=\"bg-slate-950 text-white py-12 border-t border-white/10\">\n        <div className=\"container mx-auto px-4 text-center text-slate-500 text-sm\">\n            &copy; 2025 EcoBuild AI Inc. All rights reserved.\n        </div>\n      </footer>\n    </div>\n  );\n}","path":null,"size_bytes":6897,"size_tokens":null},"MLStudio-main/client/src/main.jsx":{"content":"import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport { BrowserRouter } from 'react-router-dom'\nimport App from './App'\nimport './index.css'\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>,\n)\n","path":null,"size_bytes":323,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"MLStudio-main/server/models/CustomMaterial.js":{"content":"import mongoose from 'mongoose';\n\nconst customMaterialSchema = new mongoose.Schema({\n  key: { type: String, required: true, unique: true },\n  name: { type: String, required: true },\n  description: { type: String, default: '' },\n  embodiedEnergy_MJ_kg: { type: Number, default: 0 },\n  embodiedCarbon_kgCO2_kg: { type: Number, default: 0 },\n  density_kg_m3: { type: Number, default: 0 },\n  alternatives: [{ type: String }],\n  isCustom: { type: Boolean, default: true },\n  createdAt: { type: Date, default: Date.now }\n});\n\nexport default mongoose.model('CustomMaterial', customMaterialSchema);\n","path":null,"size_bytes":591,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"client/src/pages/reports.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Link } from \"wouter\";\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area } from 'recharts';\nimport { Download, FileText, Share2, ArrowLeft, Eye, Plus, Trash2, Loader2, BarChart3, Leaf } from \"lucide-react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogDescription } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport api from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Report {\n  id: string;\n  title: string;\n  type: string;\n  status: string;\n  projectName?: string;\n  data: {\n    totalCarbonFootprint: number;\n    totalEmbodiedEnergy: number;\n    carbonReduction: number;\n    materialsAnalyzed: number;\n    sustainabilityScore: number;\n    recommendations: string[];\n  };\n  generatedAt: string;\n}\n\ninterface Project {\n  id: string;\n  name: string;\n}\n\nexport default function Reports() {\n  const [reports, setReports] = useState<Report[]>([]);\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [generating, setGenerating] = useState(false);\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const { toast } = useToast();\n\n  const [newReport, setNewReport] = useState({\n    title: \"\",\n    type: \"sustainability\",\n    projectId: \"\"\n  });\n\n  const monthlyData = [\n    { name: 'Jan', carbon: 4000, saved: 2400 },\n    { name: 'Feb', carbon: 3000, saved: 1398 },\n    { name: 'Mar', carbon: 2000, saved: 9800 },\n    { name: 'Apr', carbon: 2780, saved: 3908 },\n    { name: 'May', carbon: 1890, saved: 4800 },\n    { name: 'Jun', carbon: 2390, saved: 3800 },\n  ];\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const [reportsData, projectsData] = await Promise.all([\n        api.getReports(),\n        api.getProjects()\n      ]);\n      setReports(reportsData);\n      setProjects(projectsData);\n    } catch (error) {\n      console.error(\"Failed to load data\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleGenerateReport = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setGenerating(true);\n    try {\n      await api.generateReport(newReport);\n      toast({ title: \"Success\", description: \"Report generated successfully\" });\n      setDialogOpen(false);\n      setNewReport({ title: \"\", type: \"sustainability\", projectId: \"\" });\n      loadData();\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleDeleteReport = async (id: string) => {\n    if (!confirm(\"Are you sure you want to delete this report?\")) return;\n    try {\n      await api.deleteReport(id);\n      toast({ title: \"Deleted\", description: \"Report deleted successfully\" });\n      loadData();\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const handleShare = () => {\n    toast({\n      title: \"Report Shared\",\n      description: \"A secure link has been copied to your clipboard.\",\n    });\n  };\n\n  const handleExport = () => {\n    toast({\n      title: \"Exporting PDF\",\n      description: \"Your report is being generated and will download shortly.\",\n    });\n  };\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case \"project\": return \"bg-blue-100 text-blue-700\";\n      case \"sustainability\": return \"bg-green-100 text-green-700\";\n      case \"material\": return \"bg-purple-100 text-purple-700\";\n      case \"comparison\": return \"bg-orange-100 text-orange-700\";\n      default: return \"bg-gray-100 text-gray-700\";\n    }\n  };\n\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleDateString(\"en-US\", {\n      month: \"short\",\n      day: \"numeric\",\n      year: \"numeric\"\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <div className=\"container mx-auto px-4 pt-8\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <Link href=\"/dashboard\">\n              <Button variant=\"ghost\" className=\"mb-2 pl-0 hover:pl-2 transition-all text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Dashboard\n              </Button>\n            </Link>\n            <h1 className=\"text-3xl font-display font-bold\">Sustainability Reports</h1>\n            <p className=\"text-muted-foreground\">Analysis of carbon footprint reduction and material efficiency.</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n              <DialogTrigger asChild>\n                <Button className=\"gap-2\">\n                  <Plus className=\"w-4 h-4\" /> Generate Report\n                </Button>\n              </DialogTrigger>\n              <DialogContent>\n                <DialogHeader>\n                  <DialogTitle>Generate New Report</DialogTitle>\n                </DialogHeader>\n                <form onSubmit={handleGenerateReport} className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"title\">Report Title</Label>\n                    <Input\n                      id=\"title\"\n                      placeholder=\"Enter report title\"\n                      value={newReport.title}\n                      onChange={(e) => setNewReport({ ...newReport, title: e.target.value })}\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"type\">Report Type</Label>\n                    <Select\n                      value={newReport.type}\n                      onValueChange={(value) => setNewReport({ ...newReport, type: value })}\n                    >\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Select type\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"sustainability\">Sustainability Overview</SelectItem>\n                        <SelectItem value=\"project\">Project Analysis</SelectItem>\n                        <SelectItem value=\"material\">Material Breakdown</SelectItem>\n                        <SelectItem value=\"comparison\">Comparison Report</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {projects.length > 0 && (\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"project\">Project (Optional)</Label>\n                      <Select\n                        value={newReport.projectId}\n                        onValueChange={(value) => setNewReport({ ...newReport, projectId: value })}\n                      >\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select project\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"\">All Projects</SelectItem>\n                          {projects.map((p) => (\n                            <SelectItem key={p.id} value={p.id}>{p.name}</SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n                  <Button type=\"submit\" className=\"w-full\" disabled={generating}>\n                    {generating ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : \"Generate Report\"}\n                  </Button>\n                </form>\n              </DialogContent>\n            </Dialog>\n            <Button variant=\"outline\" onClick={handleShare}>\n              <Share2 className=\"w-4 h-4 mr-2\" /> Share\n            </Button>\n            <Button variant=\"outline\" onClick={handleExport}>\n              <Download className=\"w-4 h-4 mr-2\" /> Export\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8\">\n          <Card className=\"border-none shadow-md\">\n            <CardHeader>\n              <CardTitle>Carbon Reduction Overview</CardTitle>\n              <CardDescription>Monthly CO2e savings vs emissions (kg)</CardDescription>\n            </CardHeader>\n            <CardContent className=\"h-[300px]\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <AreaChart data={monthlyData}>\n                  <defs>\n                    <linearGradient id=\"colorSaved\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\" stopColor=\"#16a34a\" stopOpacity={0.8}/>\n                      <stop offset=\"95%\" stopColor=\"#16a34a\" stopOpacity={0}/>\n                    </linearGradient>\n                    <linearGradient id=\"colorCarbon\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\" stopColor=\"#ef4444\" stopOpacity={0.8}/>\n                      <stop offset=\"95%\" stopColor=\"#ef4444\" stopOpacity={0}/>\n                    </linearGradient>\n                  </defs>\n                  <XAxis dataKey=\"name\" />\n                  <YAxis />\n                  <CartesianGrid strokeDasharray=\"3 3\" vertical={false} />\n                  <Tooltip />\n                  <Area type=\"monotone\" dataKey=\"saved\" stroke=\"#16a34a\" fillOpacity={1} fill=\"url(#colorSaved)\" name=\"Carbon Saved\" />\n                  <Area type=\"monotone\" dataKey=\"carbon\" stroke=\"#ef4444\" fillOpacity={1} fill=\"url(#colorCarbon)\" name=\"Emissions\" />\n                </AreaChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-none shadow-md\">\n            <CardHeader>\n              <CardTitle>Material Efficiency</CardTitle>\n              <CardDescription>Waste reduction metrics per quarter</CardDescription>\n            </CardHeader>\n            <CardContent className=\"h-[300px]\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <BarChart data={monthlyData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" vertical={false} />\n                  <XAxis dataKey=\"name\" />\n                  <YAxis />\n                  <Tooltip />\n                  <Bar dataKey=\"saved\" fill=\"#eab308\" radius={[4, 4, 0, 0]} name=\"Waste Diverted (kg)\" />\n                </BarChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n\n        <h2 className=\"text-xl font-display font-bold mb-4\">Generated Reports</h2>\n        \n        {reports.length === 0 ? (\n          <Card className=\"p-12 text-center\">\n            <div className=\"w-16 h-16 bg-secondary/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <FileText className=\"w-8 h-8 text-muted-foreground\" />\n            </div>\n            <h3 className=\"text-xl font-bold mb-2\">No Reports Yet</h3>\n            <p className=\"text-muted-foreground mb-4\">Generate your first sustainability report</p>\n            <Button onClick={() => setDialogOpen(true)}>\n              <Plus className=\"w-4 h-4 mr-2\" /> Generate Report\n            </Button>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {reports.map((report) => (\n              <Card key={report.id} className=\"hover:shadow-lg transition-all\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-start justify-between mb-4\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"p-3 bg-primary/10 rounded-lg text-primary\">\n                        <FileText className=\"w-6 h-6\" />\n                      </div>\n                      <div>\n                        <Badge className={`${getTypeColor(report.type)} mb-1`}>\n                          {report.type.charAt(0).toUpperCase() + report.type.slice(1)}\n                        </Badge>\n                        <h3 className=\"font-bold\">{report.title}</h3>\n                        <p className=\"text-sm text-muted-foreground\">{formatDate(report.generatedAt)}</p>\n                      </div>\n                    </div>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"text-destructive hover:text-destructive\"\n                      onClick={() => handleDeleteReport(report.id)}\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-2 mb-4\">\n                    <div className=\"text-center p-2 bg-secondary/50 rounded\">\n                      <p className=\"text-xs text-muted-foreground\">Carbon</p>\n                      <p className=\"font-bold\">{report.data.totalCarbonFootprint.toFixed(1)}kg</p>\n                    </div>\n                    <div className=\"text-center p-2 bg-secondary/50 rounded\">\n                      <p className=\"text-xs text-muted-foreground\">Score</p>\n                      <p className=\"font-bold\">{report.data.sustainabilityScore}/100</p>\n                    </div>\n                  </div>\n                  <Button variant=\"outline\" className=\"w-full\" onClick={handleExport}>\n                    <Download className=\"w-4 h-4 mr-2\" /> Download\n                  </Button>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":14085,"size_tokens":null},"client/src/pages/auth.tsx":{"content":"import { useState } from \"react\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useLocation } from \"wouter\";\nimport { Sprout, ArrowRight, Loader2, Mail, Lock, User } from \"lucide-react\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function AuthPage() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [_, setLocation] = useLocation();\n  const { login, register, googleLogin, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n\n  const [loginData, setLoginData] = useState({ email: \"\", password: \"\" });\n  const [registerData, setRegisterData] = useState({\n    email: \"\",\n    password: \"\",\n    firstName: \"\",\n    lastName: \"\",\n  });\n\n  if (isAuthenticated) {\n    setLocation(\"/dashboard\");\n    return null;\n  }\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    try {\n      await login(loginData.email, loginData.password);\n      toast({ title: \"Welcome back!\", description: \"You've successfully logged in.\" });\n      setLocation(\"/dashboard\");\n    } catch (error: any) {\n      toast({ \n        title: \"Login failed\", \n        description: error.message || \"Please check your credentials.\",\n        variant: \"destructive\" \n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleRegister = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    try {\n      await register(registerData);\n      toast({ title: \"Account created!\", description: \"Welcome to EcoBuild.AI\" });\n      setLocation(\"/dashboard\");\n    } catch (error: any) {\n      toast({ \n        title: \"Registration failed\", \n        description: error.message || \"Please try again.\",\n        variant: \"destructive\" \n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleGoogleLogin = async () => {\n    setIsLoading(true);\n    try {\n      await googleLogin({\n        googleId: `google-${Date.now()}`,\n        email: `user${Date.now()}@gmail.com`,\n        firstName: \"Google\",\n        lastName: \"User\",\n        avatar: \"https://lh3.googleusercontent.com/a/default-user\"\n      });\n      toast({ title: \"Welcome!\", description: \"Signed in with Google\" });\n      setLocation(\"/dashboard\");\n    } catch (error: any) {\n      toast({ \n        title: \"Google login failed\", \n        description: error.message,\n        variant: \"destructive\" \n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col md:flex-row\">\n      <div className=\"hidden md:flex w-1/2 bg-slate-900 relative overflow-hidden items-center justify-center p-12\">\n        <div className=\"absolute inset-0 z-0\">\n          <img \n            src=\"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&q=80&w=2000\" \n            alt=\"Architecture Background\" \n            className=\"w-full h-full object-cover opacity-40\"\n          />\n          <div className=\"absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent\" />\n        </div>\n        \n        <div className=\"relative z-10 max-w-md text-white space-y-6\">\n          <div className=\"bg-primary/20 w-16 h-16 rounded-2xl flex items-center justify-center backdrop-blur-sm border border-primary/30\">\n            <Sprout className=\"w-8 h-8 text-primary\" />\n          </div>\n          <h1 className=\"text-5xl font-display font-bold leading-tight\">\n            Building the <br />\n            <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-primary to-emerald-400\">Future Green.</span>\n          </h1>\n          <p className=\"text-lg text-slate-300 leading-relaxed\">\n            Join thousands of architects and engineers using AI to design sustainable, carbon-negative structures.\n          </p>\n          \n          <div className=\"grid grid-cols-2 gap-4 pt-8\">\n            <div className=\"bg-white/5 backdrop-blur p-4 rounded-lg border border-white/10\">\n              <h3 className=\"font-bold text-2xl\">2.4M+</h3>\n              <p className=\"text-sm text-white/60\">Materials Analyzed</p>\n            </div>\n            <div className=\"bg-white/5 backdrop-blur p-4 rounded-lg border border-white/10\">\n              <h3 className=\"font-bold text-2xl text-green-400\">-45%</h3>\n              <p className=\"text-sm text-white/60\">Avg Carbon Reduction</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"w-full md:w-1/2 flex items-center justify-center p-6 md:p-12\">\n        <div className=\"w-full max-w-md space-y-8\">\n          <div className=\"text-center md:text-left\">\n            <div className=\"inline-flex md:hidden items-center gap-2 mb-6\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-5 h-5\" />\n              </div>\n              <span className=\"font-display font-bold text-lg\">EcoBuild.AI</span>\n            </div>\n            <h2 className=\"text-3xl font-bold font-display\">Welcome Back</h2>\n            <p className=\"text-muted-foreground mt-2\">Enter your credentials to access your workspace.</p>\n          </div>\n\n          <Tabs defaultValue=\"login\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2 mb-8\">\n              <TabsTrigger value=\"login\">Login</TabsTrigger>\n              <TabsTrigger value=\"register\">Register</TabsTrigger>\n            </TabsList>\n            \n            <TabsContent value=\"login\">\n              <form onSubmit={handleLogin} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\">Email</Label>\n                  <div className=\"relative\">\n                    <Mail className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input \n                      id=\"email\" \n                      placeholder=\"name@company.com\" \n                      className=\"pl-10\" \n                      type=\"email\" \n                      required\n                      value={loginData.email}\n                      onChange={(e) => setLoginData({ ...loginData, email: e.target.value })}\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"password\">Password</Label>\n                  <div className=\"relative\">\n                    <Lock className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input \n                      id=\"password\" \n                      placeholder=\"Enter your password\" \n                      className=\"pl-10\" \n                      type=\"password\" \n                      required\n                      value={loginData.password}\n                      onChange={(e) => setLoginData({ ...loginData, password: e.target.value })}\n                    />\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center justify-end\">\n                  <a href=\"#\" className=\"text-sm text-primary hover:underline\">Forgot password?</a>\n                </div>\n\n                <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n                  {isLoading ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : \"Sign In\"}\n                </Button>\n              </form>\n            </TabsContent>\n            \n            <TabsContent value=\"register\">\n              <form onSubmit={handleRegister} className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"first-name\">First name</Label>\n                    <div className=\"relative\">\n                      <User className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                      <Input \n                        id=\"first-name\" \n                        placeholder=\"John\" \n                        className=\"pl-10\"\n                        required\n                        value={registerData.firstName}\n                        onChange={(e) => setRegisterData({ ...registerData, firstName: e.target.value })}\n                      />\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"last-name\">Last name</Label>\n                    <Input \n                      id=\"last-name\" \n                      placeholder=\"Doe\" \n                      required\n                      value={registerData.lastName}\n                      onChange={(e) => setRegisterData({ ...registerData, lastName: e.target.value })}\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"reg-email\">Email</Label>\n                  <div className=\"relative\">\n                    <Mail className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input \n                      id=\"reg-email\" \n                      placeholder=\"name@company.com\" \n                      className=\"pl-10\"\n                      type=\"email\" \n                      required\n                      value={registerData.email}\n                      onChange={(e) => setRegisterData({ ...registerData, email: e.target.value })}\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"reg-password\">Password</Label>\n                  <div className=\"relative\">\n                    <Lock className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input \n                      id=\"reg-password\" \n                      placeholder=\"Create a password\" \n                      className=\"pl-10\"\n                      type=\"password\" \n                      required\n                      value={registerData.password}\n                      onChange={(e) => setRegisterData({ ...registerData, password: e.target.value })}\n                    />\n                  </div>\n                </div>\n                \n                <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n                  {isLoading ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <>Create Account <ArrowRight className=\"w-4 h-4 ml-2\" /></>}\n                </Button>\n              </form>\n            </TabsContent>\n          </Tabs>\n\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <span className=\"w-full border-t\" />\n            </div>\n            <div className=\"relative flex justify-center text-xs uppercase\">\n              <span className=\"bg-background px-2 text-muted-foreground\">\n                Or continue with\n              </span>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <Button variant=\"outline\" onClick={handleGoogleLogin} disabled={isLoading}>\n              <svg className=\"w-4 h-4 mr-2\" viewBox=\"0 0 24 24\">\n                <path fill=\"currentColor\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"/>\n                <path fill=\"currentColor\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"/>\n                <path fill=\"currentColor\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"/>\n                <path fill=\"currentColor\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"/>\n              </svg>\n              Google\n            </Button>\n            <Button variant=\"outline\" disabled={isLoading}>\n              <svg className=\"w-4 h-4 mr-2\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                <path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"/>\n              </svg>\n              GitHub\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":13030,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n  \n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n  \n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n  \n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n  \n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n  \n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n  \n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n  \n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n  \n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n  \n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n  \n  --color-chart-1: hsl(var(--chart-1));\n  --color-chart-2: hsl(var(--chart-2));\n  --color-chart-3: hsl(var(--chart-3));\n  --color-chart-4: hsl(var(--chart-4));\n  --color-chart-5: hsl(var(--chart-5));\n  \n  --font-sans: 'Inter', sans-serif;\n  --font-display: 'Oswald', sans-serif;\n  \n  --radius: 0.25rem;\n}\n\n/* Eco-Industrial Theme */\n:root {\n  /* Base Colors - Clean Concrete & Tech */\n  --background: 210 20% 98%; /* Light gray concrete */\n  --foreground: 222 47% 11%; /* Dark industrial blue-black */\n\n  /* Card - White with subtle depth */\n  --card: 0 0% 100%;\n  --card-foreground: 222 47% 11%;\n\n  /* Popover */\n  --popover: 0 0% 100%;\n  --popover-foreground: 222 47% 11%;\n\n  /* Primary - Sustainable Green */\n  --primary: 142 76% 36%; /* Deep vibrant green */\n  --primary-foreground: 0 0% 100%;\n\n  /* Secondary - Construction Grey */\n  --secondary: 210 20% 90%;\n  --secondary-foreground: 222 47% 11%;\n\n  /* Muted - Technical Text */\n  --muted: 210 20% 90%;\n  --muted-foreground: 215 16% 47%;\n\n  /* Accent - Alert Orange/Warning */\n  --accent: 24 95% 53%;\n  --accent-foreground: 0 0% 100%;\n\n  /* Destructive */\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 0 0% 100%;\n\n  /* Borders & Inputs */\n  --border: 214 32% 91%;\n  --input: 214 32% 91%;\n  --ring: 142 76% 36%;\n\n  /* Charts for Dashboard */\n  --chart-1: 142 76% 36%; /* Green */\n  --chart-2: 24 95% 53%; /* Orange */\n  --chart-3: 215 16% 47%; /* Grey */\n  --chart-4: 43 96% 64%; /* Yellow */\n  --chart-5: 0 84% 60%; /* Red */\n\n  --radius: 0.5rem;\n}\n\n.dark {\n  --background: 222 47% 11%;\n  --foreground: 210 40% 98%;\n\n  --card: 222 47% 10%;\n  --card-foreground: 210 40% 98%;\n\n  --popover: 222 47% 10%;\n  --popover-foreground: 210 40% 98%;\n\n  --primary: 142 70% 45%;\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 217 19% 27%;\n  --secondary-foreground: 210 40% 98%;\n\n  --muted: 217 19% 27%;\n  --muted-foreground: 215 20% 65%;\n\n  --accent: 24 90% 55%;\n  --accent-foreground: 0 0% 100%;\n\n  --destructive: 0 62% 30%;\n  --destructive-foreground: 210 40% 98%;\n\n  --border: 217 19% 27%;\n  --input: 217 19% 27%;\n  --ring: 142 70% 45%;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-display tracking-wide uppercase;\n  }\n}\n\n/* Custom Utilities */\n@layer utilities {\n  .glass-panel {\n    @apply bg-white/80 backdrop-blur-md border border-white/20 shadow-xl;\n  }\n  \n  .industrial-grid {\n    background-image: linear-gradient(to right, var(--color-border) 1px, transparent 1px),\n                      linear-gradient(to bottom, var(--color-border) 1px, transparent 1px);\n    background-size: 24px 24px;\n    mask-image: linear-gradient(to bottom, black 40%, transparent 100%);\n  }\n}\n","path":null,"size_bytes":3970,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2537,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2356,"size_tokens":null},"client/src/pages/home.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Sprout, Building2, BarChart3, Menu, Scan, Leaf, LogOut, Settings, User, CreditCard, LayoutDashboard, FolderOpen, FileText, Search, Box, Layers, Cuboid, Upload, Loader2, AlertTriangle, Clock, Cpu, Info } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Link, useLocation } from \"wouter\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Sheet,\n  SheetContent,\n  SheetTrigger,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport api from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface ScanResult {\n  prediction: { class: string; className: string; confidence: number };\n  material: {\n    name: string;\n    embodiedEnergy: number;\n    embodiedCarbon: number;\n    density: number;\n    alternatives: { key: string; name: string; embodiedCarbon: number }[];\n  };\n  allPredictions: { class: string; className: string; confidence: number }[];\n}\n\nexport default function Home() {\n  const [scanResult, setScanResult] = useState<ScanResult | null>(null);\n  const [scanning, setScanning] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [stats, setStats] = useState({ totalScans: 0, carbonSaved: 0, activeProjects: 0 });\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n  const [modelStatus, setModelStatus] = useState<{ available: boolean; message?: string } | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const { user, logout } = useAuth();\n  const [_, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  useEffect(() => {\n    loadStats();\n    checkModelStatus();\n  }, []);\n\n  const checkModelStatus = async () => {\n    try {\n      const status = await api.getModelStatus();\n      setModelStatus(status);\n    } catch (error) {\n      setModelStatus({ available: false, message: 'Unable to connect to ML service' });\n    }\n  };\n\n  const loadStats = async () => {\n    try {\n      const data = await api.getDashboardStats();\n      setStats({\n        totalScans: data.totalScans || 0,\n        carbonSaved: user?.carbonSaved || 0,\n        activeProjects: data.totalProjects || 0\n      });\n    } catch (error) {\n      console.error(\"Failed to load stats:\", error);\n    }\n  };\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    \n    setPreviewUrl(URL.createObjectURL(file));\n    await performScan(file);\n  };\n\n  const handleDrop = async (e: React.DragEvent) => {\n    e.preventDefault();\n    const file = e.dataTransfer.files[0];\n    if (file && file.type.startsWith('image/')) {\n      setPreviewUrl(URL.createObjectURL(file));\n      await performScan(file);\n    }\n  };\n\n  const performScan = async (file: File) => {\n    setScanning(true);\n    setProgress(0);\n    setScanResult(null);\n\n    const progressInterval = setInterval(() => {\n      setProgress(p => Math.min(p + 10, 90));\n    }, 200);\n\n    try {\n      const formData = new FormData();\n      formData.append('image', file);\n      \n      const result = await api.scanMaterial(formData);\n      setProgress(100);\n      setScanResult(result);\n      await loadStats();\n      toast({ title: \"Scan Complete\", description: `Detected: ${result.prediction.className}` });\n    } catch (error: any) {\n      toast({ title: \"Scan Failed\", description: error.message, variant: \"destructive\" });\n    } finally {\n      clearInterval(progressInterval);\n      setScanning(false);\n    }\n  };\n\n  const handleLogout = () => {\n    logout();\n    setLocation(\"/auth\");\n  };\n\n  const dashboardStats = [\n    { label: \"Total Scans\", value: stats.totalScans.toString(), icon: Scan, color: \"text-blue-500\", bg: \"bg-blue-500/10\" },\n    { label: \"Carbon Saved\", value: `${stats.carbonSaved.toFixed(1)}kg`, icon: Leaf, color: \"text-green-500\", bg: \"bg-green-500/10\" },\n    { label: \"Active Projects\", value: stats.activeProjects.toString(), icon: Building2, color: \"text-purple-500\", bg: \"bg-purple-500/10\" },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground font-sans\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg group-hover:scale-110 transition-transform\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          \n          <div className=\"hidden md:flex items-center gap-8 text-sm font-medium text-muted-foreground\">\n            <Link href=\"/dashboard\" className=\"text-foreground font-semibold hover:text-primary transition-colors flex items-center gap-2\">\n              <LayoutDashboard className=\"w-4 h-4\" /> Dashboard\n            </Link>\n            <Link href=\"/materials\" className=\"hover:text-primary transition-colors flex items-center gap-2\">\n              <Search className=\"w-4 h-4\" /> Materials Library\n            </Link>\n            <Link href=\"/projects\" className=\"hover:text-primary transition-colors flex items-center gap-2\">\n              <FolderOpen className=\"w-4 h-4\" /> Projects\n            </Link>\n            <Link href=\"/reports\" className=\"hover:text-primary transition-colors flex items-center gap-2\">\n              <FileText className=\"w-4 h-4\" /> Reports\n            </Link>\n            <Link href=\"/history\" className=\"hover:text-primary transition-colors flex items-center gap-2\">\n              <Clock className=\"w-4 h-4\" /> History\n            </Link>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Avatar className=\"h-9 w-9 border border-primary/20 cursor-pointer hover:ring-2 hover:ring-primary/50 transition-all\">\n                  <AvatarImage src={user?.avatar} alt={user?.firstName} />\n                  <AvatarFallback>{user?.firstName?.charAt(0)}{user?.lastName?.charAt(0)}</AvatarFallback>\n                </Avatar>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"w-56\">\n                <DropdownMenuLabel>\n                  <div className=\"flex flex-col space-y-1\">\n                    <p className=\"text-sm font-medium leading-none\">{user?.firstName} {user?.lastName}</p>\n                    <p className=\"text-xs leading-none text-muted-foreground\">{user?.email}</p>\n                  </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem className=\"cursor-pointer\" onClick={() => setLocation(\"/profile\")}>\n                  <User className=\"mr-2 h-4 w-4\" /> Profile\n                </DropdownMenuItem>\n                <DropdownMenuItem className=\"cursor-pointer\" onClick={() => setLocation(\"/settings\")}>\n                  <Settings className=\"mr-2 h-4 w-4\" /> Settings\n                </DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem className=\"cursor-pointer text-red-500 focus:text-red-500\" onClick={handleLogout}>\n                  <LogOut className=\"mr-2 h-4 w-4\" /> Log out\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n\n            <Sheet>\n              <SheetTrigger asChild>\n                <Button size=\"icon\" variant=\"ghost\" className=\"md:hidden\">\n                  <Menu className=\"w-5 h-5\" />\n                </Button>\n              </SheetTrigger>\n              <SheetContent side=\"right\" className=\"w-[300px] sm:w-[400px]\">\n                <SheetHeader>\n                  <SheetTitle className=\"flex items-center gap-2\">\n                    <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                      <Sprout className=\"w-5 h-5\" />\n                    </div>\n                    <span className=\"font-display font-bold text-xl\">EcoBuild.AI</span>\n                  </SheetTitle>\n                </SheetHeader>\n                <div className=\"flex flex-col gap-4 mt-8\">\n                  <Link href=\"/dashboard\"><Button variant=\"ghost\" className=\"w-full justify-start text-lg font-medium\"><LayoutDashboard className=\"mr-3 w-5 h-5\" /> Dashboard</Button></Link>\n                  <Link href=\"/materials\"><Button variant=\"ghost\" className=\"w-full justify-start text-lg font-medium\"><Search className=\"mr-3 w-5 h-5\" /> Materials Library</Button></Link>\n                  <Link href=\"/projects\"><Button variant=\"ghost\" className=\"w-full justify-start text-lg font-medium\"><FolderOpen className=\"mr-3 w-5 h-5\" /> Projects</Button></Link>\n                  <Link href=\"/reports\"><Button variant=\"ghost\" className=\"w-full justify-start text-lg font-medium\"><FileText className=\"mr-3 w-5 h-5\" /> Reports</Button></Link>\n                  <Link href=\"/history\"><Button variant=\"ghost\" className=\"w-full justify-start text-lg font-medium\"><Clock className=\"mr-3 w-5 h-5\" /> Scan History</Button></Link>\n                  <div className=\"border-t pt-4 mt-4\">\n                    <Button variant=\"ghost\" className=\"w-full justify-start text-lg font-medium text-destructive hover:text-destructive\" onClick={handleLogout}>\n                      <LogOut className=\"mr-3 w-5 h-5\" /> Log out\n                    </Button>\n                  </div>\n                </div>\n              </SheetContent>\n            </Sheet>\n          </div>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-8 pb-20\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-display font-bold mb-2\">Dashboard</h1>\n          <p className=\"text-muted-foreground\">Welcome back, {user?.firstName}. Here's your sustainability overview.</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          {dashboardStats.map((stat, i) => (\n            <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: i * 0.1 }}>\n              <Card className=\"border-none shadow-sm hover:shadow-md transition-shadow\">\n                <CardContent className=\"p-6 flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm font-medium text-muted-foreground mb-1\">{stat.label}</p>\n                    <h3 className=\"text-3xl font-bold\">{stat.value}</h3>\n                  </div>\n                  <div className={`p-3 rounded-xl ${stat.bg} ${stat.color}`}>\n                    <stat.icon className=\"w-6 h-6\" />\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8\">\n          <div className=\"lg:col-span-4 space-y-6\">\n            <Card className=\"border-2 border-dashed border-muted-foreground/20 bg-secondary/30\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"flex items-center justify-between gap-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Scan className=\"w-5 h-5 text-primary\" />\n                    Material Scanner\n                  </div>\n                  {modelStatus && !modelStatus.available && (\n                    <Badge variant=\"secondary\" className=\"text-xs gap-1 font-normal\">\n                      <Info className=\"w-3 h-3\" /> Simulation Mode\n                    </Badge>\n                  )}\n                </CardTitle>\n                {modelStatus && !modelStatus.available && (\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {modelStatus.message || 'AI model is being trained. Results are simulated.'}\n                  </p>\n                )}\n              </CardHeader>\n              <CardContent>\n                <div\n                  className=\"min-h-[300px] flex flex-col items-center justify-center p-8 rounded-lg border-2 border-dashed border-muted-foreground/20 hover:border-primary/50 transition-colors cursor-pointer\"\n                  onDragOver={(e) => e.preventDefault()}\n                  onDrop={handleDrop}\n                  onClick={() => fileInputRef.current?.click()}\n                >\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {scanning ? (\n                    <div className=\"text-center space-y-4\">\n                      <Loader2 className=\"w-12 h-12 animate-spin text-primary mx-auto\" />\n                      <p className=\"text-muted-foreground\">Analyzing material...</p>\n                      <Progress value={progress} className=\"w-48\" />\n                    </div>\n                  ) : previewUrl ? (\n                    <div className=\"text-center space-y-4\">\n                      <img src={previewUrl} alt=\"Preview\" className=\"max-h-48 rounded-lg mx-auto\" />\n                      <p className=\"text-sm text-muted-foreground\">Click to scan another</p>\n                    </div>\n                  ) : (\n                    <div className=\"text-center space-y-4\">\n                      <div className=\"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto shadow-lg\">\n                        <Upload className=\"w-8 h-8 text-primary\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium\">Drop image here</p>\n                        <p className=\"text-sm text-muted-foreground\">or click to browse</p>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {scanResult && (\n              <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}>\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Detected Material</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-2xl font-bold\">{scanResult.material.name}</span>\n                      <Badge variant=\"secondary\">{Math.round(scanResult.prediction.confidence * 100)}% confidence</Badge>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div className=\"p-3 bg-secondary/50 rounded-lg\">\n                        <p className=\"text-muted-foreground\">Embodied Carbon</p>\n                        <p className=\"font-bold text-lg\">{scanResult.material.embodiedCarbon} kgCO2/kg</p>\n                      </div>\n                      <div className=\"p-3 bg-secondary/50 rounded-lg\">\n                        <p className=\"text-muted-foreground\">Embodied Energy</p>\n                        <p className=\"font-bold text-lg\">{scanResult.material.embodiedEnergy} MJ/kg</p>\n                      </div>\n                      <div className=\"p-3 bg-secondary/50 rounded-lg\">\n                        <p className=\"text-muted-foreground\">Density</p>\n                        <p className=\"font-bold text-lg\">{scanResult.material.density} kg/mÂ³</p>\n                      </div>\n                      <div className=\"p-3 bg-secondary/50 rounded-lg\">\n                        <p className=\"text-muted-foreground\">Impact Level</p>\n                        <p className=\"font-bold text-lg flex items-center gap-1\">\n                          {scanResult.material.embodiedCarbon > 1 ? (\n                            <><AlertTriangle className=\"w-4 h-4 text-red-500\" /> High</>\n                          ) : scanResult.material.embodiedCarbon > 0.3 ? (\n                            <><AlertTriangle className=\"w-4 h-4 text-yellow-500\" /> Medium</>\n                          ) : (\n                            <><Leaf className=\"w-4 h-4 text-green-500\" /> Low</>\n                          )}\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            )}\n          </div>\n\n          <div className=\"lg:col-span-8\">\n            {scanResult ? (\n              <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"space-y-8\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <BarChart3 className=\"w-5 h-5 text-primary\" />\n                      Prediction Confidence\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    {scanResult.allPredictions.slice(0, 5).map((pred, i) => (\n                      <div key={i} className=\"space-y-1\">\n                        <div className=\"flex justify-between text-sm\">\n                          <span>{pred.className}</span>\n                          <span className=\"font-mono\">{Math.round(pred.confidence * 100)}%</span>\n                        </div>\n                        <Progress value={pred.confidence * 100} className=\"h-2\" />\n                      </div>\n                    ))}\n                  </CardContent>\n                </Card>\n\n                {scanResult.material.alternatives.length > 0 && (\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <Leaf className=\"w-5 h-5 text-green-500\" />\n                        Sustainable Alternatives\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {scanResult.material.alternatives.map((alt, i) => (\n                          <div key={i} className=\"p-4 border rounded-lg hover:border-primary transition-colors\">\n                            <h4 className=\"font-bold\">{alt.name}</h4>\n                            <p className=\"text-sm text-muted-foreground\">\n                              Carbon: {alt.embodiedCarbon} kgCO2/kg\n                            </p>\n                            {alt.embodiedCarbon < scanResult.material.embodiedCarbon && (\n                              <Badge className=\"mt-2 bg-green-100 text-green-700\">\n                                {Math.round((1 - alt.embodiedCarbon / scanResult.material.embodiedCarbon) * 100)}% less carbon\n                              </Badge>\n                            )}\n                          </div>\n                        ))}\n                      </div>\n                    </CardContent>\n                  </Card>\n                )}\n              </motion.div>\n            ) : (\n              <div className=\"bg-secondary/5 rounded-xl border-2 border-dashed border-border h-full min-h-[400px] flex flex-col items-center justify-center text-center p-8\">\n                <div className=\"w-20 h-20 bg-secondary/20 rounded-full flex items-center justify-center mb-6\">\n                  <Scan className=\"w-10 h-10 text-muted-foreground\" />\n                </div>\n                <h3 className=\"text-xl font-bold text-muted-foreground mb-2\">Ready to Analyze</h3>\n                <p className=\"text-muted-foreground max-w-md\">\n                  Use the scanner on the left to identify materials and generate real-time sustainability reports.\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":20513,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/pages/case-studies.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout, ArrowRight } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\n\nexport default function CaseStudies() {\n  const studies = [\n    {\n        title: \"The Nordic Green Center\",\n        location: \"Oslo, Norway\",\n        description: \"How EcoBuild.AI helped reduce embodied carbon by 40% using hempcrete alternatives for non-load bearing walls.\",\n        metric: \"-40% Carbon\",\n        image: \"https://images.unsplash.com/photo-1464938050520-ef2270bb8ce8?auto=format&fit=crop&q=80&w=800\",\n        tags: [\"Commercial\", \"Insulation\", \"Retrofit\"]\n    },\n    {\n        title: \"Bamboo Pavilion Project\",\n        location: \"Bali, Indonesia\",\n        description: \"Structural analysis ensuring safety while using locally sourced engineered bamboo for a 5000 sq ft community center.\",\n        metric: \"Carbon Negative\",\n        image: \"https://images.unsplash.com/photo-1610504463627-7937732c9452?auto=format&fit=crop&q=80&w=800\",\n        tags: [\"Public\", \"Structural\", \"New Build\"]\n    },\n    {\n        title: \"Seattle Skyline Retrofit\",\n        location: \"Seattle, USA\",\n        description: \"Identifying recyclable steel components in a demolition project to save 200 tons of material from landfill.\",\n        metric: \"200t Saved\",\n        image: \"https://images.unsplash.com/photo-1545558014-8692077e9b5c?auto=format&fit=crop&q=80&w=800\",\n        tags: [\"High-rise\", \"Circular Economy\", \"Steel\"]\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-12\">\n        <div className=\"text-center max-w-3xl mx-auto mb-16\">\n            <h1 className=\"text-4xl font-display font-bold mb-4\">Case Studies</h1>\n            <p className=\"text-lg text-muted-foreground\">\n                See how leading architects are using EcoBuild.AI to design the next generation of sustainable buildings.\n            </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n            {studies.map((study, i) => (\n                <Card key={i} className=\"overflow-hidden border-none shadow-lg hover:shadow-xl transition-all group cursor-pointer\">\n                    <div className=\"relative h-56 overflow-hidden\">\n                        <img \n                            src={study.image} \n                            alt={study.title} \n                            className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\"\n                        />\n                        <div className=\"absolute top-4 right-4\">\n                            <Badge className=\"bg-white/90 text-black backdrop-blur font-bold\">\n                                {study.metric}\n                            </Badge>\n                        </div>\n                    </div>\n                    <CardHeader>\n                        <div className=\"flex flex-wrap gap-2 mb-2\">\n                            {study.tags.map(tag => (\n                                <Badge key={tag} variant=\"secondary\" className=\"text-xs\">{tag}</Badge>\n                            ))}\n                        </div>\n                        <CardTitle className=\"text-xl group-hover:text-primary transition-colors\">{study.title}</CardTitle>\n                        <p className=\"text-sm text-muted-foreground flex items-center\">\n                            {study.location}\n                        </p>\n                    </CardHeader>\n                    <CardContent>\n                        <p className=\"text-muted-foreground mb-4\">\n                            {study.description}\n                        </p>\n                        <Button variant=\"link\" className=\"p-0 h-auto text-primary font-bold group-hover:underline\">\n                            Read Full Story <ArrowRight className=\"ml-2 w-4 h-4\" />\n                        </Button>\n                    </CardContent>\n                </Card>\n            ))}\n        </div>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":4989,"size_tokens":null},"client/src/pages/material-detail.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Link, useRoute } from \"wouter\";\nimport { ArrowLeft, Leaf, BarChart3, Share2, Download, Info, AlertTriangle, Loader2 } from \"lucide-react\";\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport api from \"@/lib/api\";\n\ninterface Material {\n  id: string;\n  key: string;\n  name: string;\n  description: string;\n  category: string;\n  embodiedEnergy: number;\n  embodiedCarbon: number;\n  density: number;\n  impactLevel: string;\n  alternatives: { id: string; key: string; name: string; embodiedCarbon: number; impactLevel: string }[];\n}\n\nexport default function MaterialDetail() {\n  const [match, params] = useRoute(\"/materials/:id\");\n  const [material, setMaterial] = useState<Material | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (params?.id) {\n      loadMaterial(params.id);\n    }\n  }, [params?.id]);\n\n  const loadMaterial = async (id: string) => {\n    try {\n      const data = await api.getMaterial(id);\n      setMaterial(data);\n    } catch (error) {\n      console.error(\"Failed to load material:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getImpactColor = (level: string) => {\n    switch (level) {\n      case 'Very Low':\n      case 'Low': return 'bg-green-500 text-white';\n      case 'Medium': return 'bg-yellow-500 text-white';\n      case 'High':\n      case 'Very High': return 'bg-red-500 text-white';\n      default: return 'bg-gray-500 text-white';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!material) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold mb-2\">Material Not Found</h2>\n          <Link href=\"/materials\">\n            <Button>Back to Library</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  const carbonChartData = [\n    { name: 'Embodied Carbon', value: material.embodiedCarbon },\n    { name: 'Embodied Energy', value: material.embodiedEnergy / 10 },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <div className=\"container mx-auto px-4 pt-8\">\n        <Link href=\"/materials\">\n          <Button variant=\"ghost\" className=\"mb-6 pl-0 hover:pl-2 transition-all\">\n            <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Library\n          </Button>\n        </Link>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"space-y-6\">\n            <Card className=\"overflow-hidden border-none shadow-lg\">\n              <div className=\"aspect-square relative bg-gradient-to-br from-slate-800 to-slate-900 flex items-center justify-center\">\n                <div className=\"text-9xl font-bold text-white/10\">{material.name.charAt(0)}</div>\n                <div className=\"absolute top-4 left-4\">\n                  <Badge className={`${getImpactColor(material.impactLevel)} border-none text-lg px-3 py-1`}>\n                    {material.impactLevel === 'Very Low' || material.impactLevel === 'Low' ? (\n                      <Leaf className=\"w-4 h-4 mr-1\" />\n                    ) : (\n                      <AlertTriangle className=\"w-4 h-4 mr-1\" />\n                    )}\n                    {material.impactLevel}\n                  </Badge>\n                </div>\n              </div>\n              <CardContent className=\"pt-6\">\n                <h1 className=\"text-3xl font-display font-bold mb-2\">{material.name}</h1>\n                <p className=\"text-sm text-muted-foreground uppercase tracking-wider font-bold mb-4\">{material.category}</p>\n                \n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center p-3 bg-secondary/20 rounded-lg\">\n                    <span className=\"text-sm font-medium\">Embodied Carbon</span>\n                    <span className=\"font-bold text-lg\">{material.embodiedCarbon} kgCO2/kg</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-secondary/20 rounded-lg\">\n                    <span className=\"text-sm font-medium\">Embodied Energy</span>\n                    <span className=\"font-bold text-lg\">{material.embodiedEnergy} MJ/kg</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-secondary/20 rounded-lg\">\n                    <span className=\"text-sm font-medium\">Density</span>\n                    <span className=\"font-bold\">{material.density} kg/mÂ³</span>\n                  </div>\n                </div>\n              </CardContent>\n              <CardFooter className=\"flex gap-2\">\n                <Button className=\"flex-1\">\n                  <Download className=\"w-4 h-4 mr-2\" /> Spec Sheet\n                </Button>\n                <Button variant=\"outline\" size=\"icon\">\n                  <Share2 className=\"w-4 h-4\" />\n                </Button>\n              </CardFooter>\n            </Card>\n          </div>\n\n          <div className=\"lg:col-span-2 space-y-6\">\n            <Tabs defaultValue=\"overview\" className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-3 mb-6\">\n                <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n                <TabsTrigger value=\"environmental\">Environmental</TabsTrigger>\n                <TabsTrigger value=\"alternatives\">Alternatives</TabsTrigger>\n              </TabsList>\n              \n              <TabsContent value=\"overview\" className=\"space-y-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Material Description</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <p className=\"text-muted-foreground leading-relaxed\">\n                      {material.description}\n                    </p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Technical Properties</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div className=\"flex justify-between p-3 border rounded-lg\">\n                        <span className=\"text-muted-foreground\">Embodied Carbon</span>\n                        <span className=\"font-medium\">{material.embodiedCarbon} kgCO2/kg</span>\n                      </div>\n                      <div className=\"flex justify-between p-3 border rounded-lg\">\n                        <span className=\"text-muted-foreground\">Embodied Energy</span>\n                        <span className=\"font-medium\">{material.embodiedEnergy} MJ/kg</span>\n                      </div>\n                      <div className=\"flex justify-between p-3 border rounded-lg\">\n                        <span className=\"text-muted-foreground\">Density</span>\n                        <span className=\"font-medium\">{material.density} kg/mÂ³</span>\n                      </div>\n                      <div className=\"flex justify-between p-3 border rounded-lg\">\n                        <span className=\"text-muted-foreground\">Impact Level</span>\n                        <span className=\"font-medium\">{material.impactLevel}</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"environmental\" className=\"space-y-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Environmental Impact</CardTitle>\n                    <CardDescription>Carbon and energy metrics</CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"h-[300px]\">\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                      <BarChart data={carbonChartData} layout=\"vertical\">\n                        <CartesianGrid strokeDasharray=\"3 3\" horizontal={false} />\n                        <XAxis type=\"number\" />\n                        <YAxis dataKey=\"name\" type=\"category\" width={120} />\n                        <Tooltip />\n                        <Bar dataKey=\"value\" fill=\"#16a34a\" radius={[0, 4, 4, 0]} />\n                      </BarChart>\n                    </ResponsiveContainer>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"alternatives\">\n                {material.alternatives && material.alternatives.length > 0 ? (\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    {material.alternatives.map((alt, i) => (\n                      <Link key={i} href={`/materials/${alt.key}`}>\n                        <Card className=\"hover:shadow-lg transition-all cursor-pointer h-full\">\n                          <CardContent className=\"p-6\">\n                            <h3 className=\"font-bold text-lg mb-2\">{alt.name}</h3>\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm text-muted-foreground\">Embodied Carbon:</span>\n                              <span className=\"font-mono\">{alt.embodiedCarbon} kgCO2/kg</span>\n                            </div>\n                            {alt.embodiedCarbon < material.embodiedCarbon && (\n                              <Badge className=\"mt-3 bg-green-100 text-green-700\">\n                                {Math.round((1 - alt.embodiedCarbon / material.embodiedCarbon) * 100)}% less carbon\n                              </Badge>\n                            )}\n                          </CardContent>\n                        </Card>\n                      </Link>\n                    ))}\n                  </div>\n                ) : (\n                  <Card className=\"bg-secondary/10 border-dashed\">\n                    <CardContent className=\"pt-6 text-center py-12\">\n                      <Info className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                      <h3 className=\"text-lg font-medium mb-2\">No Alternatives Available</h3>\n                      <p className=\"text-muted-foreground max-w-md mx-auto\">\n                        This material doesn't have documented alternatives in the ICE database.\n                      </p>\n                    </CardContent>\n                  </Card>\n                )}\n              </TabsContent>\n            </Tabs>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11014,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/pages/materials-library.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardFooter } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Search, Filter, Leaf, AlertTriangle, ArrowLeft, Loader2 } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport api from \"@/lib/api\";\n\ninterface Material {\n  id: string;\n  key: string;\n  name: string;\n  description: string;\n  category: string;\n  embodiedEnergy: number;\n  embodiedCarbon: number;\n  density: number;\n  impactLevel: string;\n  impactColor: { bg: string; text: string };\n}\n\nexport default function MaterialsLibrary() {\n  const [materials, setMaterials] = useState<Material[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\n  const [categories, setCategories] = useState<string[]>([]);\n\n  useEffect(() => {\n    loadMaterials();\n    loadCategories();\n  }, []);\n\n  const loadMaterials = async () => {\n    try {\n      const data = await api.getMaterials();\n      setMaterials(data);\n    } catch (error) {\n      console.error(\"Failed to load materials:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadCategories = async () => {\n    try {\n      const data = await api.getMaterialCategories();\n      setCategories(data);\n    } catch (error) {\n      console.error(\"Failed to load categories:\", error);\n    }\n  };\n\n  const filteredMaterials = materials.filter(m => {\n    const matchesSearch = m.name.toLowerCase().includes(searchTerm.toLowerCase()) || \n                          m.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                          m.category.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesCategory = !selectedCategory || m.category === selectedCategory;\n    return matchesSearch && matchesCategory;\n  });\n\n  const getImpactIcon = (level: string) => {\n    return level === 'High' || level === 'Very High' ? AlertTriangle : Leaf;\n  };\n\n  const getImpactColorClass = (level: string) => {\n    switch (level) {\n      case 'Very Low':\n      case 'Low':\n        return 'bg-green-100 text-green-700';\n      case 'Medium':\n        return 'bg-yellow-100 text-yellow-700';\n      case 'High':\n        return 'bg-red-100 text-red-700';\n      case 'Very High':\n        return 'bg-red-200 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-700';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <div className=\"container mx-auto px-4 pt-8\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <Link href=\"/dashboard\">\n              <Button variant=\"ghost\" className=\"mb-2 pl-0 hover:pl-2 transition-all text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Dashboard\n              </Button>\n            </Link>\n            <h1 className=\"text-3xl font-display font-bold\">Materials Library</h1>\n            <p className=\"text-muted-foreground\">ICE Database - {materials.length} construction materials with environmental impact data.</p>\n          </div>\n        </div>\n\n        <div className=\"flex flex-col md:flex-row gap-4 mb-8\">\n          <div className=\"relative flex-1 max-w-md\">\n            <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n            <Input \n              placeholder=\"Search materials...\" \n              className=\"pl-9\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n          </div>\n          <div className=\"flex gap-2 flex-wrap\">\n            <Button \n              variant={selectedCategory === \"\" ? \"default\" : \"outline\"} \n              size=\"sm\"\n              onClick={() => setSelectedCategory(\"\")}\n            >\n              All\n            </Button>\n            {categories.map((cat) => (\n              <Button\n                key={cat}\n                variant={selectedCategory === cat ? \"default\" : \"outline\"}\n                size=\"sm\"\n                onClick={() => setSelectedCategory(cat)}\n              >\n                {cat}\n              </Button>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {filteredMaterials.map((material) => {\n            const ImpactIcon = getImpactIcon(material.impactLevel);\n            return (\n              <Link key={material.id} href={`/materials/${material.id}`}>\n                <Card className=\"overflow-hidden hover:shadow-lg transition-all duration-300 border-none shadow-md cursor-pointer group hover:-translate-y-1 h-full\">\n                  <div className=\"h-32 bg-gradient-to-br from-slate-800 to-slate-900 relative overflow-hidden flex items-center justify-center\">\n                    <div className=\"text-6xl font-bold text-white/10\">{material.name.charAt(0)}</div>\n                    <div className=\"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent\" />\n                    <div className=\"absolute top-3 right-3\">\n                      <Badge className={`${getImpactColorClass(material.impactLevel)} border-none`}>\n                        <ImpactIcon className=\"w-3 h-3 mr-1\" />\n                        {material.impactLevel} Impact\n                      </Badge>\n                    </div>\n                    <div className=\"absolute bottom-3 left-3\">\n                      <Badge variant=\"secondary\" className=\"bg-white/20 text-white border-none backdrop-blur-sm\">\n                        {material.category}\n                      </Badge>\n                    </div>\n                  </div>\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-xl group-hover:text-primary transition-colors\">{material.name}</CardTitle>\n                    <p className=\"text-sm text-muted-foreground line-clamp-2\">{material.description}</p>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <span className=\"text-muted-foreground block\">Embodied Carbon</span>\n                        <span className=\"font-mono font-medium\">{material.embodiedCarbon} kgCO2/kg</span>\n                      </div>\n                      <div>\n                        <span className=\"text-muted-foreground block\">Embodied Energy</span>\n                        <span className=\"font-mono font-medium\">{material.embodiedEnergy} MJ/kg</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                  <CardFooter className=\"bg-secondary/20 pt-4 group-hover:bg-secondary/40 transition-colors\">\n                    <Button variant=\"ghost\" className=\"w-full text-primary hover:text-primary/80\">View Details</Button>\n                  </CardFooter>\n                </Card>\n              </Link>\n            );\n          })}\n        </div>\n\n        {filteredMaterials.length === 0 && (\n          <div className=\"text-center py-12\">\n            <p className=\"text-muted-foreground\">No materials found matching your search.</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7576,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"client/src/pages/settings.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Bell, Lock, Eye, Globe, Shield, Smartphone, Mail, Loader2, Key } from \"lucide-react\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { motion } from \"framer-motion\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\n\nexport default function Settings() {\n  const { user, updatePreferences, updateAppearance, updatePrivacy, updatePassword } = useAuth();\n  const { toast } = useToast();\n  const [savingField, setSavingField] = useState<string | null>(null);\n  const [showPasswordDialog, setShowPasswordDialog] = useState(false);\n  const [passwordData, setPasswordData] = useState({ current: '', new: '', confirm: '' });\n  const [changingPassword, setChangingPassword] = useState(false);\n\n  const handlePreferenceToggle = async (field: keyof typeof user.preferences, value: boolean) => {\n    if (!user) return;\n    setSavingField(field);\n    try {\n      await updatePreferences({ [field]: value });\n      toast({\n        description: `${formatFieldName(field)} updated.`,\n        duration: 1500,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Update Failed\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setSavingField(null);\n    }\n  };\n\n  const handleAppearanceToggle = async (field: keyof typeof user.appearance, value: boolean) => {\n    if (!user) return;\n    setSavingField(field);\n    try {\n      await updateAppearance({ [field]: value });\n      toast({\n        description: `${formatFieldName(field)} updated.`,\n        duration: 1500,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Update Failed\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setSavingField(null);\n    }\n  };\n\n  const handlePrivacyToggle = async (field: keyof typeof user.privacy, value: boolean) => {\n    if (!user) return;\n    setSavingField(field);\n    try {\n      await updatePrivacy({ [field]: value });\n      toast({\n        description: `${formatFieldName(field)} updated.`,\n        duration: 1500,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Update Failed\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setSavingField(null);\n    }\n  };\n\n  const handleMeasurementChange = async (system: 'metric' | 'imperial') => {\n    if (!user) return;\n    setSavingField('measurementSystem');\n    try {\n      await updatePreferences({ measurementSystem: system });\n      toast({\n        description: `Measurement system changed to ${system}.`,\n        duration: 1500,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Update Failed\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setSavingField(null);\n    }\n  };\n\n  const handleCurrencyChange = async (currency: 'USD' | 'EUR' | 'GBP') => {\n    if (!user) return;\n    setSavingField('currency');\n    try {\n      await updatePreferences({ currency });\n      toast({\n        description: `Currency changed to ${currency}.`,\n        duration: 1500,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Update Failed\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setSavingField(null);\n    }\n  };\n\n  const handlePasswordChange = async () => {\n    if (passwordData.new !== passwordData.confirm) {\n      toast({\n        title: \"Passwords Don't Match\",\n        description: \"New password and confirmation must match.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    if (passwordData.new.length < 8) {\n      toast({\n        title: \"Password Too Short\",\n        description: \"Password must be at least 8 characters.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setChangingPassword(true);\n    try {\n      await updatePassword(passwordData.current, passwordData.new);\n      toast({\n        title: \"Password Changed\",\n        description: \"Your password has been updated successfully.\",\n      });\n      setShowPasswordDialog(false);\n      setPasswordData({ current: '', new: '', confirm: '' });\n    } catch (error: any) {\n      toast({\n        title: \"Password Change Failed\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setChangingPassword(false);\n    }\n  };\n\n  const formatFieldName = (field: string) => {\n    return field\n      .replace(/([A-Z])/g, ' $1')\n      .replace(/^./, str => str.toUpperCase())\n      .trim();\n  };\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <motion.div \n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"container mx-auto px-4 pt-8\"\n      >\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <Link href=\"/profile\">\n              <Button variant=\"ghost\" className=\"mb-2 pl-0 hover:pl-2 transition-all text-muted-foreground\" data-testid=\"button-back-profile\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Profile\n              </Button>\n            </Link>\n            <h1 className=\"text-3xl font-display font-bold\">App Settings</h1>\n            <p className=\"text-muted-foreground\">Customize your application preferences.</p>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto\">\n          \n          <motion.div initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 }}>\n            <Card className=\"border-none shadow-md h-full\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-xl\"><Bell className=\"w-5 h-5 text-primary\" /> Notifications</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex gap-3 items-start\">\n                    <Mail className=\"w-5 h-5 text-muted-foreground mt-0.5\" />\n                    <div className=\"space-y-0.5\">\n                      <Label className=\"text-base\">Email Alerts</Label>\n                      <p className=\"text-sm text-muted-foreground\">Updates about your projects.</p>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={user.preferences?.emailAlerts ?? true}\n                    onCheckedChange={(checked) => handlePreferenceToggle('emailAlerts', checked)}\n                    disabled={savingField === 'emailAlerts'}\n                    data-testid=\"switch-email-alerts\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex gap-3 items-start\">\n                    <Globe className=\"w-5 h-5 text-muted-foreground mt-0.5\" />\n                    <div className=\"space-y-0.5\">\n                      <Label className=\"text-base\">Marketing Emails</Label>\n                      <p className=\"text-sm text-muted-foreground\">News about new features.</p>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={user.preferences?.marketingEmails ?? false}\n                    onCheckedChange={(checked) => handlePreferenceToggle('marketingEmails', checked)}\n                    disabled={savingField === 'marketingEmails'}\n                    data-testid=\"switch-marketing-emails\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex gap-3 items-start\">\n                    <Smartphone className=\"w-5 h-5 text-muted-foreground mt-0.5\" />\n                    <div className=\"space-y-0.5\">\n                      <Label className=\"text-base\">Push Notifications</Label>\n                      <p className=\"text-sm text-muted-foreground\">Alerts on your device.</p>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={user.preferences?.pushNotifications ?? true}\n                    onCheckedChange={(checked) => handlePreferenceToggle('pushNotifications', checked)}\n                    disabled={savingField === 'pushNotifications'}\n                    data-testid=\"switch-push-notifications\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}>\n            <Card className=\"border-none shadow-md h-full\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-xl\"><Eye className=\"w-5 h-5 text-primary\" /> Appearance</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"space-y-0.5\">\n                    <Label className=\"text-base\">Dark Mode</Label>\n                    <p className=\"text-sm text-muted-foreground\">Toggle dark theme.</p>\n                  </div>\n                  <Switch \n                    checked={user.appearance?.darkMode ?? false}\n                    onCheckedChange={(checked) => handleAppearanceToggle('darkMode', checked)}\n                    disabled={savingField === 'darkMode'}\n                    data-testid=\"switch-dark-mode\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"space-y-0.5\">\n                    <Label className=\"text-base\">Compact View</Label>\n                    <p className=\"text-sm text-muted-foreground\">Denser interface layout.</p>\n                  </div>\n                  <Switch \n                    checked={user.appearance?.compactView ?? false}\n                    onCheckedChange={(checked) => handleAppearanceToggle('compactView', checked)}\n                    disabled={savingField === 'compactView'}\n                    data-testid=\"switch-compact-view\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                   <div className=\"space-y-0.5\">\n                    <Label className=\"text-base\">Reduce Motion</Label>\n                    <p className=\"text-sm text-muted-foreground\">Minimize animations.</p>\n                  </div>\n                  <Switch \n                    checked={user.appearance?.reduceMotion ?? false}\n                    onCheckedChange={(checked) => handleAppearanceToggle('reduceMotion', checked)}\n                    disabled={savingField === 'reduceMotion'}\n                    data-testid=\"switch-reduce-motion\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }}>\n            <Card className=\"border-none shadow-md h-full\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-xl\"><Lock className=\"w-5 h-5 text-primary\" /> Privacy & Security</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex gap-3 items-start\">\n                    <Globe className=\"w-5 h-5 text-muted-foreground mt-0.5\" />\n                    <div className=\"space-y-0.5\">\n                      <Label className=\"text-base\">Public Profile</Label>\n                      <p className=\"text-sm text-muted-foreground\">Allow others to see your profile.</p>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={user.privacy?.publicProfile ?? true}\n                    onCheckedChange={(checked) => handlePrivacyToggle('publicProfile', checked)}\n                    disabled={savingField === 'publicProfile'}\n                    data-testid=\"switch-public-profile\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex gap-3 items-start\">\n                    <Eye className=\"w-5 h-5 text-muted-foreground mt-0.5\" />\n                    <div className=\"space-y-0.5\">\n                      <Label className=\"text-base\">Show Activity</Label>\n                      <p className=\"text-sm text-muted-foreground\">Display your scan activity.</p>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={user.privacy?.showActivity ?? true}\n                    onCheckedChange={(checked) => handlePrivacyToggle('showActivity', checked)}\n                    disabled={savingField === 'showActivity'}\n                    data-testid=\"switch-show-activity\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex gap-3 items-start\">\n                    <Key className=\"w-5 h-5 text-muted-foreground mt-0.5\" />\n                    <div className=\"space-y-0.5\">\n                      <Label className=\"text-base\">Change Password</Label>\n                      <p className=\"text-sm text-muted-foreground\">Update your password.</p>\n                    </div>\n                  </div>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    onClick={() => setShowPasswordDialog(true)}\n                    data-testid=\"button-change-password\"\n                  >\n                    Change\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 }}>\n            <Card className=\"border-none shadow-md h-full\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-xl\"><Globe className=\"w-5 h-5 text-primary\" /> Regional</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"space-y-0.5\">\n                    <Label className=\"text-base\">Measurement System</Label>\n                    <p className=\"text-sm text-muted-foreground\">Metric vs Imperial.</p>\n                  </div>\n                  <div className=\"flex items-center gap-1 border rounded-md p-1\">\n                    <Button \n                      variant={user.preferences?.measurementSystem === 'metric' ? 'secondary' : 'ghost'} \n                      size=\"sm\" \n                      className=\"h-7 px-3\"\n                      onClick={() => handleMeasurementChange('metric')}\n                      disabled={savingField === 'measurementSystem'}\n                      data-testid=\"button-metric\"\n                    >\n                      Metric\n                    </Button>\n                    <Button \n                      variant={user.preferences?.measurementSystem === 'imperial' ? 'secondary' : 'ghost'} \n                      size=\"sm\" \n                      className=\"h-7 px-3\"\n                      onClick={() => handleMeasurementChange('imperial')}\n                      disabled={savingField === 'measurementSystem'}\n                      data-testid=\"button-imperial\"\n                    >\n                      Imperial\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"space-y-0.5\">\n                    <Label className=\"text-base\">Currency</Label>\n                    <p className=\"text-sm text-muted-foreground\">Billing currency.</p>\n                  </div>\n                  <div className=\"flex items-center gap-1 border rounded-md p-1\">\n                    <Button \n                      variant={user.preferences?.currency === 'USD' ? 'secondary' : 'ghost'} \n                      size=\"sm\" \n                      className=\"h-7 px-3\"\n                      onClick={() => handleCurrencyChange('USD')}\n                      disabled={savingField === 'currency'}\n                      data-testid=\"button-usd\"\n                    >\n                      USD\n                    </Button>\n                    <Button \n                      variant={user.preferences?.currency === 'EUR' ? 'secondary' : 'ghost'} \n                      size=\"sm\" \n                      className=\"h-7 px-3\"\n                      onClick={() => handleCurrencyChange('EUR')}\n                      disabled={savingField === 'currency'}\n                      data-testid=\"button-eur\"\n                    >\n                      EUR\n                    </Button>\n                    <Button \n                      variant={user.preferences?.currency === 'GBP' ? 'secondary' : 'ghost'} \n                      size=\"sm\" \n                      className=\"h-7 px-3\"\n                      onClick={() => handleCurrencyChange('GBP')}\n                      disabled={savingField === 'currency'}\n                      data-testid=\"button-gbp\"\n                    >\n                      GBP\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n        </div>\n      </motion.div>\n\n      <Dialog open={showPasswordDialog} onOpenChange={setShowPasswordDialog}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Change Password</DialogTitle>\n            <DialogDescription>\n              Enter your current password and choose a new one.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"current-password\">Current Password</Label>\n              <Input\n                id=\"current-password\"\n                type=\"password\"\n                value={passwordData.current}\n                onChange={(e) => setPasswordData(prev => ({ ...prev, current: e.target.value }))}\n                data-testid=\"input-current-password\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"new-password\">New Password</Label>\n              <Input\n                id=\"new-password\"\n                type=\"password\"\n                value={passwordData.new}\n                onChange={(e) => setPasswordData(prev => ({ ...prev, new: e.target.value }))}\n                data-testid=\"input-new-password\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"confirm-password\">Confirm New Password</Label>\n              <Input\n                id=\"confirm-password\"\n                type=\"password\"\n                value={passwordData.confirm}\n                onChange={(e) => setPasswordData(prev => ({ ...prev, confirm: e.target.value }))}\n                data-testid=\"input-confirm-password\"\n              />\n            </div>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button variant=\"outline\" onClick={() => setShowPasswordDialog(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handlePasswordChange} disabled={changingPassword} data-testid=\"button-confirm-password-change\">\n              {changingPassword ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : null}\n              {changingPassword ? \"Changing...\" : \"Change Password\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":20530,"size_tokens":null},"server/storage.ts":{"content":"import { type User, type InsertUser } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\n// modify the interface with any CRUD methods\n// you might need\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n\n  constructor() {\n    this.users = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n}\n\nexport const storage = new MemStorage();\n","path":null,"size_bytes":993,"size_tokens":null},"client/src/pages/subscription.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardFooter } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Check, Zap, Crown } from \"lucide-react\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { motion } from \"framer-motion\";\n\nexport default function Subscription() {\n  const [isAnnual, setIsAnnual] = useState(false);\n\n  const plans = [\n    {\n      name: \"Starter\",\n      price: 0,\n      description: \"For individuals exploring sustainable materials.\",\n      features: [\"3 Material Scans / Month\", \"Basic Carbon Stats\", \"Community Support\"],\n      current: true,\n    },\n    {\n      name: \"Professional\",\n      price: isAnnual ? 24 : 29,\n      description: \"For architects needing advanced analysis.\",\n      features: [\"Unlimited Material Scans\", \"Advanced Lifecycle Analysis\", \"Export PDF Reports\", \"Project Management Dashboard\", \"Priority Support\"],\n      popular: true,\n      icon: Zap,\n    },\n    {\n      name: \"Enterprise\",\n      price: isAnnual ? 89 : 99,\n      description: \"For large firms and organizations.\",\n      features: [\"Everything in Pro\", \"API Access\", \"Custom Integrations\", \"Dedicated Success Manager\", \"Team Collaboration (10+ Users)\"],\n      icon: Crown,\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <motion.div \n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"container mx-auto px-4 pt-8\"\n      >\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <Link href=\"/profile\">\n              <Button variant=\"ghost\" className=\"mb-2 pl-0 hover:pl-2 transition-all text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Profile\n              </Button>\n            </Link>\n            <h1 className=\"text-3xl font-display font-bold\">Subscription Plans</h1>\n            <p className=\"text-muted-foreground\">Choose the plan that fits your sustainable design needs.</p>\n          </div>\n        </div>\n\n        <div className=\"flex justify-center items-center gap-4 mb-12\">\n          <Label htmlFor=\"billing-mode\" className={`text-sm font-medium ${!isAnnual ? 'text-foreground' : 'text-muted-foreground'}`}>Monthly Billing</Label>\n          <Switch id=\"billing-mode\" checked={isAnnual} onCheckedChange={setIsAnnual} />\n          <Label htmlFor=\"billing-mode\" className={`text-sm font-medium ${isAnnual ? 'text-foreground' : 'text-muted-foreground'}`}>\n            Annual Billing <span className=\"text-green-500 text-xs ml-1 font-bold\">(Save 20%)</span>\n          </Label>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto\">\n          {plans.map((plan, index) => (\n            <motion.div\n              key={plan.name}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: index * 0.1 }}\n            >\n              <Card className={`h-full flex flex-col relative overflow-hidden transition-all duration-300 ${plan.popular ? 'border-2 border-primary shadow-xl scale-105 z-10' : 'border-none shadow-md hover:shadow-xl hover:-translate-y-1'}`}>\n                {plan.popular && (\n                  <div className=\"absolute top-0 left-0 w-full bg-primary py-1 text-center text-xs font-bold text-white uppercase tracking-wider\">\n                    Most Popular\n                  </div>\n                )}\n                <CardHeader className={`text-center pb-2 ${plan.popular ? 'pt-8' : ''}`}>\n                  {plan.icon && <div className={`mx-auto w-12 h-12 rounded-full flex items-center justify-center mb-4 ${plan.popular ? 'bg-primary/10 text-primary' : 'bg-secondary/50 text-foreground'}`}><plan.icon className=\"w-6 h-6\" /></div>}\n                  <h3 className={`font-display font-bold text-xl ${plan.popular ? 'text-primary' : ''}`}>{plan.name}</h3>\n                  <p className=\"text-xs text-muted-foreground h-8 px-4\">{plan.description}</p>\n                  <div className=\"flex items-baseline justify-center mt-4\">\n                    <span className=\"text-4xl font-bold\">${plan.price}</span>\n                    <span className=\"text-muted-foreground ml-1\">/mo</span>\n                  </div>\n                  {isAnnual && plan.price > 0 && (\n                    <p className=\"text-xs text-green-600 font-medium mt-1\">Billed ${plan.price * 12} yearly</p>\n                  )}\n                </CardHeader>\n                <CardContent className=\"space-y-4 pt-4 flex-grow\">\n                  <ul className=\"space-y-3 text-sm\">\n                    {plan.features.map((feature, i) => (\n                      <li key={i} className=\"flex items-start\">\n                        <Check className={`w-4 h-4 mr-2 shrink-0 mt-0.5 ${plan.popular ? 'text-primary' : 'text-green-600'}`} />\n                        <span className=\"text-muted-foreground\">{feature}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </CardContent>\n                <CardFooter>\n                  <Button \n                    variant={plan.current ? \"outline\" : plan.popular ? \"default\" : \"outline\"} \n                    className={`w-full ${plan.popular ? 'font-bold shadow-lg shadow-primary/20' : ''}`}\n                    disabled={plan.current}\n                  >\n                    {plan.current ? \"Current Plan\" : \"Upgrade Now\"}\n                  </Button>\n                </CardFooter>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ delay: 0.4 }}\n          className=\"mt-12 max-w-3xl mx-auto bg-secondary/20 rounded-xl p-6 flex flex-col sm:flex-row items-center gap-6 text-center sm:text-left\"\n        >\n          <div className=\"bg-primary/10 p-4 rounded-full text-primary shrink-0\">\n            <Crown className=\"w-8 h-8\" />\n          </div>\n          <div>\n            <h4 className=\"font-bold text-lg\">Enterprise Custom Solutions</h4>\n            <p className=\"text-sm text-muted-foreground mt-1\">Need a custom solution for your large organization? We offer tailored plans with specific compliance requirements, SSO, and dedicated support.</p>\n          </div>\n          <Button variant=\"secondary\" className=\"sm:ml-auto whitespace-nowrap\">Contact Sales</Button>\n        </motion.div>\n      </motion.div>\n    </div>\n  );\n}","path":null,"size_bytes":6570,"size_tokens":null},"MLStudio-main/replit.md":{"content":"# AI Material Management Studio\n\n## Overview\nA comprehensive ML training studio for construction material detection, designed to help identify ICE (Inventory of Carbon and Energy) construction materials from images for carbon footprint analysis.\n\n## Project Structure\n```\n/\nâ”œâ”€â”€ server/           # Express.js backend with MongoDB\nâ”‚   â”œâ”€â”€ server.js     # Main API server (port 3001)\nâ”‚   â”œâ”€â”€ models/       # Mongoose schemas\nâ”‚   â”‚   â”œâ”€â”€ MaterialImage.js\nâ”‚   â”‚   â”œâ”€â”€ TrainedModel.js\nâ”‚   â”‚   â””â”€â”€ CustomMaterial.js\nâ”‚   â””â”€â”€ config/\nâ”‚       â””â”€â”€ materials.js  # ICE database materials\nâ”œâ”€â”€ client/           # React frontend with Vite\nâ”‚   â”œâ”€â”€ src/\nâ”‚   â”‚   â”œâ”€â”€ App.jsx   # Main app with routing and theme\nâ”‚   â”‚   â”œâ”€â”€ pages/    # Dashboard, Classes, Training, Models, Testing\nâ”‚   â”‚   â””â”€â”€ index.css # Theme-aware styling\nâ”‚   â””â”€â”€ index.html\nâ”œâ”€â”€ worker/           # Python ML training worker\nâ”‚   â”œâ”€â”€ train.py      # MobileNetV2 transfer learning\nâ”‚   â””â”€â”€ requirements.txt\nâ”œâ”€â”€ data/             # Generated data storage\nâ”‚   â”œâ”€â”€ models/       # Trained model files\nâ”‚   â”œâ”€â”€ uploads/      # Uploaded images\nâ”‚   â””â”€â”€ temp/         # Temporary files\nâ””â”€â”€ package.json      # Root scripts\n```\n\n## Key Features\n\n### Material Classes\n- **ICE Database Materials**: 15 pre-defined construction materials with embodied energy/carbon data\n- **Custom Classes**: User-defined material classes with editable properties\n- **Material Alternatives**: Lower carbon alternative suggestions\n\n### Model Training\n- Transfer learning using MobileNetV2\n- Real-time training progress via WebSocket\n- Configurable epochs, batch size, learning rate\n- Validation split and accuracy metrics\n\n### Model Management\n- View all trained models\n- Activate/deactivate models\n- Delete any model (including active ones with auto-fallback)\n- Compare model performance\n\n### Model Testing\n- Upload test images for prediction\n- View confidence scores per class\n- Material property display (energy, carbon, density)\n- Alternative material suggestions\n\n### UI Features\n- Light/Dark theme toggle with localStorage persistence\n- Real-time WebSocket updates\n- Responsive design\n\n## Configuration\n\n### MongoDB Connection\nThe server uses environment variable with fallback:\n```javascript\nconst MONGO_URI = process.env.MONGO_URI || \"mongodb+srv://...fallback...\";\n```\n\n**Security Note**: For production deployment, always set `MONGO_URI` in environment secrets. The hardcoded fallback is for development convenience only.\n\n### Running the Application\n```bash\nnpm run dev  # Starts both server (port 3001) and client (port 5000)\n```\n\n## API Endpoints\n\n### Classes\n- `GET /api/classes` - Get all material classes (ICE + custom)\n- `POST /api/classes` - Create custom class\n- `PUT /api/classes/:id` - Update custom class\n- `DELETE /api/classes/:id` - Delete custom class\n\n### Models\n- `GET /api/models` - List all models\n- `GET /api/models/active` - Get active model\n- `POST /api/models/:id/activate` - Activate model\n- `DELETE /api/models/:id` - Delete model\n\n### Training\n- `POST /api/training/start` - Start training\n- `POST /api/training/stop` - Stop training\n- `GET /api/training/status` - Training status\n\n### Prediction\n- `POST /api/predict` - Run prediction on image\n\n## Recent Changes\n- December 2024: Reorganized folder structure (server/, client/, worker/, data/)\n- December 2024: Added MongoDB URI fallback support\n- December 2024: Extended ICE materials from 8 to 15 classes\n- December 2024: Added custom material class management\n- December 2024: Added model testing page with predictions\n- December 2024: Improved model deletion (can delete active models)\n- December 2024: Added light/dark theme toggle\n","path":null,"size_bytes":3823,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"client/src/components/material-scanner.tsx":{"content":"import { useState, useRef, useCallback } from 'react';\nimport { Upload, Scan, CheckCircle2, AlertCircle, X, Camera, Image as ImageIcon, Box, Layers, Eye, RotateCcw, Info } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useToast } from '@/hooks/use-toast';\nimport { useAuth } from '@/lib/auth-context';\nimport api, { ScanResult } from '@/lib/api';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Tooltip, TooltipContent, TooltipTrigger } from '@/components/ui/tooltip';\nimport { Link } from 'wouter';\n\ninterface MaterialScannerProps {\n  onScanComplete?: (result: ScanResult) => void;\n  showGuestPrompt?: boolean;\n}\n\nexport function MaterialScanner({ onScanComplete, showGuestPrompt = true }: MaterialScannerProps) {\n  const { user, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  const [isDragging, setIsDragging] = useState(false);\n  const [scanState, setScanState] = useState<'idle' | 'uploading' | 'scanning' | 'complete' | 'error'>('idle');\n  const [progress, setProgress] = useState(0);\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n  const [scanResult, setScanResult] = useState<ScanResult | null>(null);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [guestScansRemaining, setGuestScansRemaining] = useState<number | null>(null);\n  const [activeView, setActiveView] = useState<'preview' | 'wireframe' | '3d'>('preview');\n  const [modelStatus, setModelStatus] = useState<{ available: boolean; message?: string } | null>(null);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(true);\n  }, []);\n\n  const handleDragLeave = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(false);\n    const file = e.dataTransfer.files[0];\n    if (file && file.type.startsWith('image/')) {\n      handleFileSelect(file);\n    }\n  }, []);\n\n  const handleFileSelect = (file: File) => {\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: 'Invalid File Type',\n        description: 'Please select an image file (JPG, PNG, WebP)',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    setSelectedFile(file);\n    setPreviewUrl(URL.createObjectURL(file));\n    setScanState('idle');\n    setErrorMessage(null);\n  };\n\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n  };\n\n  const checkModelStatus = async () => {\n    try {\n      const status = await api.getModelStatus();\n      setModelStatus(status);\n      return status;\n    } catch (error) {\n      return { available: false, message: 'Unable to check model status' };\n    }\n  };\n\n  const startScan = async () => {\n    if (!selectedFile) {\n      toast({\n        title: 'No Image Selected',\n        description: 'Please select or drop an image to scan.',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    setScanState('uploading');\n    setProgress(0);\n    setErrorMessage(null);\n\n    const status = await checkModelStatus();\n    \n    const progressInterval = setInterval(() => {\n      setProgress(prev => {\n        if (prev >= 90) {\n          clearInterval(progressInterval);\n          return 90;\n        }\n        return prev + Math.random() * 15;\n      });\n    }, 200);\n\n    try {\n      setScanState('scanning');\n      \n      const formData = new FormData();\n      formData.append('image', selectedFile);\n\n      const result = await api.scanMaterial(formData);\n      \n      clearInterval(progressInterval);\n      setProgress(100);\n      \n      setScanResult(result);\n      setScanState('complete');\n      \n      if (result.isGuest && result.scansRemaining !== null) {\n        setGuestScansRemaining(result.scansRemaining);\n      }\n\n      onScanComplete?.(result);\n      \n      toast({\n        title: 'Scan Complete',\n        description: `Detected: ${result.material.name}`,\n      });\n    } catch (error: any) {\n      clearInterval(progressInterval);\n      setProgress(0);\n      setScanState('error');\n      setErrorMessage(error.message || 'Scan failed. Please try again.');\n      \n      toast({\n        title: 'Scan Failed',\n        description: error.message || 'Unable to analyze the material. Please try again.',\n        variant: 'destructive'\n      });\n    }\n  };\n\n  const resetScanner = () => {\n    setScanState('idle');\n    setProgress(0);\n    setSelectedFile(null);\n    setPreviewUrl(null);\n    setScanResult(null);\n    setErrorMessage(null);\n    setActiveView('preview');\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const renderMaterialWireframe = () => {\n    if (!scanResult) return null;\n\n    return (\n      <div className=\"relative aspect-video bg-secondary/50 rounded-lg overflow-hidden\">\n        <svg viewBox=\"0 0 400 300\" className=\"w-full h-full\">\n          <defs>\n            <pattern id=\"grid\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n              <path d=\"M 20 0 L 0 0 0 20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"0.5\" className=\"text-primary/20\" />\n            </pattern>\n          </defs>\n          <rect width=\"400\" height=\"300\" fill=\"url(#grid)\" />\n          \n          <g className=\"animate-pulse\">\n            <rect x=\"100\" y=\"80\" width=\"200\" height=\"140\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n            <line x1=\"100\" y1=\"80\" x2=\"150\" y2=\"50\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n            <line x1=\"300\" y1=\"80\" x2=\"350\" y2=\"50\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n            <line x1=\"150\" y1=\"50\" x2=\"350\" y2=\"50\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n            <line x1=\"350\" y1=\"50\" x2=\"350\" y2=\"190\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n            <line x1=\"300\" y1=\"220\" x2=\"350\" y2=\"190\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n            \n            <circle cx=\"200\" cy=\"150\" r=\"40\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeDasharray=\"4 2\" className=\"text-green-500\" />\n            <text x=\"200\" y=\"155\" textAnchor=\"middle\" className=\"fill-green-500 text-xs font-mono\">\n              {scanResult.material.name}\n            </text>\n          </g>\n          \n          <g className=\"text-xs font-mono\">\n            <text x=\"10\" y=\"290\" className=\"fill-muted-foreground\">\n              Density: {scanResult.material.density} kg/m3\n            </text>\n            <text x=\"220\" y=\"290\" className=\"fill-muted-foreground\">\n              Confidence: {(scanResult.prediction.confidence * 100).toFixed(1)}%\n            </text>\n          </g>\n        </svg>\n        \n        {scanResult.analysis.isSimulation && (\n          <div className=\"absolute top-2 right-2\">\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  <Info className=\"w-3 h-3\" /> Simulation Mode\n                </Badge>\n              </TooltipTrigger>\n              <TooltipContent>\n                <p className=\"max-w-xs\">Using simulated analysis. AI model is being trained for more accurate results.</p>\n              </TooltipContent>\n            </Tooltip>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const render3DView = () => {\n    if (!scanResult) return null;\n\n    return (\n      <div className=\"relative aspect-video bg-secondary/50 rounded-lg overflow-hidden flex items-center justify-center\">\n        <div className=\"text-center space-y-4 p-8\">\n          <motion.div \n            className=\"w-32 h-32 mx-auto perspective-[500px]\"\n            animate={{ rotateY: 360 }}\n            transition={{ duration: 8, repeat: Infinity, ease: \"linear\" }}\n          >\n            <div className=\"w-full h-full bg-primary/20 border-2 border-primary rounded-lg transform-style-preserve-3d flex items-center justify-center\">\n              <Box className=\"w-12 h-12 text-primary\" />\n            </div>\n          </motion.div>\n          <div className=\"space-y-1\">\n            <p className=\"font-semibold\">{scanResult.material.name}</p>\n            <p className=\"text-sm text-muted-foreground\">3D Volumetric View</p>\n          </div>\n          <div className=\"flex gap-2 justify-center text-xs text-muted-foreground\">\n            <span>Density: {scanResult.material.density} kg/m3</span>\n            <span>|</span>\n            <span>Carbon: {scanResult.material.embodiedCarbon} kgCO2e/kg</span>\n          </div>\n        </div>\n        \n        <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2\">\n          <Button size=\"sm\" variant=\"outline\" className=\"text-xs\">\n            <RotateCcw className=\"w-3 h-3 mr-1\" /> Reset View\n          </Button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <Card className=\"relative overflow-hidden border-2 border-dashed border-muted-foreground/20 bg-secondary/30 backdrop-blur-sm min-h-[400px] flex flex-col\">\n      <AnimatePresence mode=\"wait\">\n        {(scanState === 'idle' || scanState === 'error') && !selectedFile && (\n          <motion.div \n            key=\"upload\"\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            exit={{ opacity: 0, scale: 0.95 }}\n            className={`flex-1 flex flex-col items-center justify-center p-8 transition-colors ${isDragging ? 'bg-primary/5' : ''}`}\n            onDragOver={handleDragOver}\n            onDragLeave={handleDragLeave}\n            onDrop={handleDrop}\n          >\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleFileInputChange}\n              className=\"hidden\"\n              data-testid=\"input-scan-file\"\n            />\n            \n            <div className={`w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 transition-all duration-300 ${isDragging ? 'bg-primary scale-110' : 'bg-white shadow-xl'}`}>\n              <Upload className={`w-10 h-10 ${isDragging ? 'text-white' : 'text-primary'}`} />\n            </div>\n            \n            <div className=\"text-center space-y-2 mb-6\">\n              <h3 className=\"text-2xl font-display font-bold\">Scan Construction Material</h3>\n              <p className=\"text-muted-foreground max-w-md\">\n                Upload an image of any building material to analyze its environmental impact and discover sustainable alternatives.\n              </p>\n            </div>\n\n            {!isAuthenticated && showGuestPrompt && (\n              <div className=\"bg-secondary/50 rounded-lg p-4 mb-6 text-center max-w-md\">\n                <p className=\"text-sm text-muted-foreground\">\n                  <span className=\"font-medium text-foreground\">Try it free!</span> Guest users get 3 free scans. \n                  <Link href=\"/auth\" className=\"text-primary ml-1 underline\">Sign up</Link> to unlock unlimited scanning.\n                </p>\n              </div>\n            )}\n\n            <div className=\"flex gap-3 justify-center flex-wrap\">\n              <Button size=\"lg\" onClick={() => fileInputRef.current?.click()} className=\"shadow-lg\" data-testid=\"button-upload-image\">\n                <ImageIcon className=\"mr-2 w-4 h-4\" /> Upload Image\n              </Button>\n              <Button size=\"lg\" variant=\"outline\" onClick={() => fileInputRef.current?.click()} data-testid=\"button-open-camera\">\n                <Camera className=\"mr-2 w-4 h-4\" /> Use Camera\n              </Button>\n            </div>\n\n            {scanState === 'error' && errorMessage && (\n              <motion.div \n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"mt-6 p-4 bg-destructive/10 rounded-lg flex items-center gap-3 max-w-md\"\n              >\n                <AlertCircle className=\"w-5 h-5 text-destructive\" />\n                <p className=\"text-sm text-destructive\">{errorMessage}</p>\n              </motion.div>\n            )}\n          </motion.div>\n        )}\n\n        {(scanState === 'idle' || scanState === 'error') && selectedFile && previewUrl && (\n          <motion.div \n            key=\"preview-ready\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"flex-1 flex flex-col p-6\"\n          >\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"font-display font-bold text-lg\">Image Selected</h3>\n              <Button size=\"icon\" variant=\"ghost\" onClick={resetScanner} data-testid=\"button-clear-image\">\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n            \n            <div className=\"relative aspect-video bg-secondary rounded-lg overflow-hidden mb-6\">\n              <img src={previewUrl} alt=\"Material preview\" className=\"w-full h-full object-cover\" />\n            </div>\n            \n            <div className=\"flex gap-3 justify-center\">\n              <Button size=\"lg\" onClick={startScan} className=\"shadow-lg\" data-testid=\"button-start-scan\">\n                <Scan className=\"mr-2 w-4 h-4\" /> Analyze Material\n              </Button>\n              <Button size=\"lg\" variant=\"outline\" onClick={() => fileInputRef.current?.click()} data-testid=\"button-change-image\">\n                <ImageIcon className=\"mr-2 w-4 h-4\" /> Change Image\n              </Button>\n            </div>\n\n            {scanState === 'error' && errorMessage && (\n              <motion.div \n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"mt-6 p-4 bg-destructive/10 rounded-lg flex items-center gap-3\"\n              >\n                <AlertCircle className=\"w-5 h-5 text-destructive\" />\n                <p className=\"text-sm text-destructive\">{errorMessage}</p>\n              </motion.div>\n            )}\n          </motion.div>\n        )}\n\n        {(scanState === 'uploading' || scanState === 'scanning') && (\n          <motion.div \n            key=\"scanning\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"flex-1 flex flex-col items-center justify-center p-8\"\n          >\n            <div className=\"relative w-32 h-32 mb-8\">\n              <motion.div \n                className=\"absolute inset-0 border-4 border-primary/30 rounded-full\"\n                animate={{ rotate: 360 }}\n                transition={{ duration: 3, repeat: Infinity, ease: \"linear\" }}\n              />\n              <motion.div \n                className=\"absolute inset-2 border-4 border-primary border-t-transparent rounded-full\"\n                animate={{ rotate: -360 }}\n                transition={{ duration: 2, repeat: Infinity, ease: \"linear\" }}\n              />\n              <div className=\"absolute inset-0 flex items-center justify-center\">\n                <Scan className=\"w-10 h-10 text-primary animate-pulse\" />\n              </div>\n            </div>\n            \n            <div className=\"text-center space-y-2 mb-8\">\n              <h3 className=\"text-xl font-bold font-display animate-pulse\">\n                {scanState === 'uploading' ? 'Uploading Image...' : 'Analyzing Material Structure...'}\n              </h3>\n              <p className=\"text-sm text-muted-foreground font-mono\">\n                {scanState === 'uploading' ? 'Preparing for analysis' : 'Identifying composition and properties'}\n              </p>\n            </div>\n\n            <div className=\"w-full max-w-md space-y-2\">\n              <Progress value={progress} className=\"h-2\" />\n              <div className=\"flex justify-between text-xs font-mono text-muted-foreground\">\n                <span>{scanState === 'uploading' ? 'UPLOADING' : 'ANALYZING'}</span>\n                <span>{Math.round(progress)}%</span>\n              </div>\n            </div>\n          </motion.div>\n        )}\n\n        {scanState === 'complete' && scanResult && (\n          <motion.div \n            key=\"complete\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"flex-1 flex flex-col p-6\"\n          >\n            <div className=\"flex items-center justify-between mb-4 gap-4 flex-wrap\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 bg-green-500/10 rounded-full flex items-center justify-center\">\n                  <CheckCircle2 className=\"w-5 h-5 text-green-500\" />\n                </div>\n                <div>\n                  <h3 className=\"font-display font-bold text-lg\" data-testid=\"text-scan-result-title\">{scanResult.material.name}</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Confidence: {(scanResult.prediction.confidence * 100).toFixed(1)}%\n                  </p>\n                </div>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" onClick={resetScanner} data-testid=\"button-new-scan\">\n                <Scan className=\"w-4 h-4 mr-2\" /> New Scan\n              </Button>\n            </div>\n\n            <Tabs value={activeView} onValueChange={(v) => setActiveView(v as any)} className=\"flex-1 flex flex-col\">\n              <TabsList className=\"grid grid-cols-3 w-full max-w-sm mx-auto mb-4\">\n                <TabsTrigger value=\"preview\" className=\"gap-2\" data-testid=\"tab-preview\">\n                  <Eye className=\"w-4 h-4\" /> Preview\n                </TabsTrigger>\n                <TabsTrigger value=\"wireframe\" className=\"gap-2\" data-testid=\"tab-wireframe\">\n                  <Layers className=\"w-4 h-4\" /> Wireframe\n                </TabsTrigger>\n                <TabsTrigger value=\"3d\" className=\"gap-2\" data-testid=\"tab-3d\">\n                  <Box className=\"w-4 h-4\" /> 3D View\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"preview\" className=\"flex-1\">\n                <div className=\"aspect-video bg-secondary rounded-lg overflow-hidden mb-4\">\n                  {previewUrl && <img src={previewUrl} alt=\"Scanned material\" className=\"w-full h-full object-cover\" />}\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"wireframe\" className=\"flex-1\">\n                {renderMaterialWireframe()}\n              </TabsContent>\n\n              <TabsContent value=\"3d\" className=\"flex-1\">\n                {render3DView()}\n              </TabsContent>\n            </Tabs>\n\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4\">\n              <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                <p className=\"text-lg font-bold text-orange-500\" data-testid=\"text-embodied-carbon\">\n                  {scanResult.material.embodiedCarbon}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">kgCO2e/kg</p>\n              </div>\n              <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                <p className=\"text-lg font-bold text-blue-500\" data-testid=\"text-embodied-energy\">\n                  {scanResult.material.embodiedEnergy}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">MJ/kg</p>\n              </div>\n              <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                <p className=\"text-lg font-bold\" data-testid=\"text-density\">\n                  {scanResult.material.density}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">kg/m3</p>\n              </div>\n              <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                <Badge variant=\"outline\" className=\"font-medium\" data-testid=\"text-recyclability\">\n                  {scanResult.material.recyclability || 'Recyclable'}\n                </Badge>\n                <p className=\"text-xs text-muted-foreground mt-1\">Recyclability</p>\n              </div>\n            </div>\n\n            {scanResult.material.alternatives && scanResult.material.alternatives.length > 0 && (\n              <div className=\"mt-4 p-4 bg-green-500/10 rounded-lg\">\n                <h4 className=\"font-semibold text-green-700 dark:text-green-400 mb-2\">Sustainable Alternatives</h4>\n                <div className=\"flex gap-2 flex-wrap\">\n                  {scanResult.material.alternatives.slice(0, 3).map((alt, idx) => (\n                    <Badge key={idx} variant=\"secondary\" className=\"gap-1\" data-testid={`badge-alternative-${idx}`}>\n                      {alt.name} ({alt.embodiedCarbon} kgCO2e)\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {!isAuthenticated && guestScansRemaining !== null && guestScansRemaining <= 0 && (\n              <motion.div \n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"mt-4 p-4 bg-primary/10 rounded-lg text-center\"\n              >\n                <p className=\"font-semibold mb-2\">You've used all your free scans!</p>\n                <p className=\"text-sm text-muted-foreground mb-4\">\n                  Create an account to continue scanning materials and access your scan history.\n                </p>\n                <Link href=\"/auth\">\n                  <Button data-testid=\"button-signup-prompt\">Sign Up for Free</Button>\n                </Link>\n              </motion.div>\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      <div className=\"absolute inset-0 pointer-events-none opacity-[0.03] industrial-grid\" />\n    </Card>\n  );\n}\n","path":null,"size_bytes":22146,"size_tokens":null},"client/src/pages/projects.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Link } from \"wouter\";\nimport { MapPin, Calendar, TrendingUp, ArrowLeft, Plus, Loader2 } from \"lucide-react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport api from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Project {\n  id: string;\n  name: string;\n  location: string;\n  status: string;\n  progress: number;\n  sustainabilityScore: number;\n  image?: string;\n  targetCompletionDate?: string;\n  createdAt: string;\n}\n\nexport default function Projects() {\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [creating, setCreating] = useState(false);\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const { toast } = useToast();\n  \n  const [newProject, setNewProject] = useState({\n    name: \"\",\n    location: \"\",\n    status: \"Planning\",\n    targetCompletionDate: \"\"\n  });\n\n  useEffect(() => {\n    loadProjects();\n  }, []);\n\n  const loadProjects = async () => {\n    try {\n      const data = await api.getProjects();\n      setProjects(data);\n    } catch (error) {\n      toast({ title: \"Error\", description: \"Failed to load projects\", variant: \"destructive\" });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateProject = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setCreating(true);\n    try {\n      await api.createProject(newProject);\n      toast({ title: \"Success\", description: \"Project created successfully\" });\n      setDialogOpen(false);\n      setNewProject({ name: \"\", location: \"\", status: \"Planning\", targetCompletionDate: \"\" });\n      loadProjects();\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"Completed\": return \"bg-green-100 text-green-700\";\n      case \"In Progress\": return \"bg-blue-100 text-blue-700\";\n      case \"Planning\": return \"bg-yellow-100 text-yellow-700\";\n      case \"On Hold\": return \"bg-gray-100 text-gray-700\";\n      default: return \"bg-gray-100 text-gray-700\";\n    }\n  };\n\n  const formatDate = (dateStr: string) => {\n    if (!dateStr) return \"TBD\";\n    return new Date(dateStr).toLocaleDateString(\"en-US\", { month: \"short\", year: \"numeric\" });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <div className=\"container mx-auto px-4 pt-8\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <Link href=\"/dashboard\">\n              <Button variant=\"ghost\" className=\"mb-2 pl-0 hover:pl-2 transition-all text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Dashboard\n              </Button>\n            </Link>\n            <h1 className=\"text-3xl font-display font-bold\">Active Projects</h1>\n            <p className=\"text-muted-foreground\">Track sustainability goals across your portfolio.</p>\n          </div>\n          \n          <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\">\n                <Plus className=\"w-4 h-4\" /> New Project\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Create New Project</DialogTitle>\n              </DialogHeader>\n              <form onSubmit={handleCreateProject} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"name\">Project Name</Label>\n                  <Input\n                    id=\"name\"\n                    placeholder=\"Enter project name\"\n                    value={newProject.name}\n                    onChange={(e) => setNewProject({ ...newProject, name: e.target.value })}\n                    required\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"location\">Location</Label>\n                  <Input\n                    id=\"location\"\n                    placeholder=\"City, Country\"\n                    value={newProject.location}\n                    onChange={(e) => setNewProject({ ...newProject, location: e.target.value })}\n                    required\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"status\">Status</Label>\n                  <Select \n                    value={newProject.status} \n                    onValueChange={(value) => setNewProject({ ...newProject, status: value })}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select status\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"Planning\">Planning</SelectItem>\n                      <SelectItem value=\"In Progress\">In Progress</SelectItem>\n                      <SelectItem value=\"On Hold\">On Hold</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"date\">Target Completion</Label>\n                  <Input\n                    id=\"date\"\n                    type=\"date\"\n                    value={newProject.targetCompletionDate}\n                    onChange={(e) => setNewProject({ ...newProject, targetCompletionDate: e.target.value })}\n                  />\n                </div>\n                <Button type=\"submit\" className=\"w-full\" disabled={creating}>\n                  {creating ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : \"Create Project\"}\n                </Button>\n              </form>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        {projects.length === 0 ? (\n          <Card className=\"p-12 text-center\">\n            <div className=\"w-16 h-16 bg-secondary/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <Plus className=\"w-8 h-8 text-muted-foreground\" />\n            </div>\n            <h3 className=\"text-xl font-bold mb-2\">No Projects Yet</h3>\n            <p className=\"text-muted-foreground mb-4\">Create your first sustainable construction project</p>\n            <Button onClick={() => setDialogOpen(true)}>\n              <Plus className=\"w-4 h-4 mr-2\" /> Create Project\n            </Button>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 gap-6\">\n            {projects.map((project) => (\n              <Link key={project.id} href={`/projects/${project.id}`}>\n                <Card className=\"overflow-hidden flex flex-col md:flex-row border-none shadow-md hover:shadow-lg transition-all cursor-pointer group active:scale-[0.99]\">\n                  <div className=\"w-full md:w-64 h-48 md:h-auto relative overflow-hidden bg-gradient-to-br from-primary/20 to-primary/5\">\n                    {project.image ? (\n                      <img src={project.image} alt={project.name} className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\" />\n                    ) : (\n                      <div className=\"w-full h-full flex items-center justify-center\">\n                        <div className=\"text-6xl font-bold text-primary/20\">{project.name.charAt(0)}</div>\n                      </div>\n                    )}\n                    <div className=\"absolute top-3 left-3\">\n                      <Badge className={`${getStatusColor(project.status)} border-none`}>\n                        {project.status}\n                      </Badge>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex-1 p-6 flex flex-col justify-between\">\n                    <div>\n                      <div className=\"flex justify-between items-start mb-2\">\n                        <div>\n                          <h3 className=\"text-2xl font-bold font-display group-hover:text-primary transition-colors\">{project.name}</h3>\n                          <div className=\"flex items-center text-muted-foreground text-sm mt-1\">\n                            <MapPin className=\"w-4 h-4 mr-1\" /> {project.location}\n                            <span className=\"mx-2\">.</span>\n                            <Calendar className=\"w-4 h-4 mr-1\" /> {formatDate(project.targetCompletionDate || project.createdAt)}\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-sm text-muted-foreground\">Eco-Score</div>\n                          <div className=\"text-2xl font-bold text-primary\">{project.sustainabilityScore}/100</div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"mt-6 space-y-2\">\n                        <div className=\"flex justify-between text-sm font-medium\">\n                          <span>Completion Progress</span>\n                          <span>{project.progress}%</span>\n                        </div>\n                        <Progress value={project.progress} className=\"h-2\" />\n                      </div>\n                    </div>\n\n                    <div className=\"mt-6 flex gap-3\">\n                      <Button className=\"flex-1 md:flex-none group-hover:bg-primary group-hover:text-white transition-colors\">View Details</Button>\n                      <Button variant=\"outline\" className=\"flex-1 md:flex-none\">\n                        <TrendingUp className=\"w-4 h-4 mr-2\" /> Analytics\n                      </Button>\n                    </div>\n                  </div>\n                </Card>\n              </Link>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":10525,"size_tokens":null},"MLStudio-main/vite.config.js":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\n\nexport default defineConfig({\n  plugins: [react(), tailwindcss()],\n  root: \"client\",\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    port: 5000,\n    proxy: {\n      \"/api\": {\n        target: \"http://localhost:3001\",\n        changeOrigin: true,\n      },\n      \"/ws\": {\n        target: \"ws://localhost:3001\",\n        ws: true,\n      },\n      \"/uploads\": {\n        target: \"http://localhost:3001\",\n        changeOrigin: true,\n      },\n    },\n  },\n});\n","path":null,"size_bytes":585,"size_tokens":null},"client/src/pages/legal/terms.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout } from \"lucide-react\";\n\nexport default function Terms() {\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-12 max-w-3xl\">\n        <h1 className=\"text-4xl font-display font-bold mb-8\">Terms of Service</h1>\n        <div className=\"prose prose-slate dark:prose-invert max-w-none space-y-6 text-muted-foreground\">\n          <p>Last updated: December 03, 2025</p>\n          \n          <h2 className=\"text-2xl font-bold text-foreground\">1. Agreement to Terms</h2>\n          <p>By accessing our website, you agree to be bound by these Terms of Service and to comply with all applicable laws and regulations. If you do not agree with these terms, you are prohibited from using or accessing this site or using any other services provided by EcoBuild.AI.</p>\n\n          <h2 className=\"text-2xl font-bold text-foreground\">2. Use License</h2>\n          <p>Permission is granted to temporarily download one copy of the materials (information or software) on EcoBuild.AI's website for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:</p>\n          <ul className=\"list-disc pl-6 space-y-2\">\n            <li>modify or copy the materials;</li>\n            <li>use the materials for any commercial purpose, or for any public display (commercial or non-commercial);</li>\n            <li>attempt to decompile or reverse engineer any software contained on EcoBuild.AI's website;</li>\n            <li>remove any copyright or other proprietary notations from the materials; or</li>\n            <li>transfer the materials to another person or \"mirror\" the materials on any other server.</li>\n          </ul>\n\n          <h2 className=\"text-2xl font-bold text-foreground\">3. AI Analysis Disclaimer</h2>\n          <p>The material analysis provided by EcoBuild.AI is based on artificial intelligence and computer vision algorithms. While we strive for high accuracy, the results are estimates and should not be the sole basis for structural engineering decisions without professional verification. EcoBuild.AI is not responsible for any construction errors resulting from reliance on our data.</p>\n        </div>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":3236,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"MLStudio-main/client/src/pages/Datasets.jsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { \n  Upload, \n  Trash2, \n  Image,\n  CheckSquare,\n  Square,\n  FolderOpen,\n  AlertCircle,\n  RefreshCw,\n  Loader\n} from 'lucide-react';\n\nfunction Datasets() {\n  const [searchParams] = useSearchParams();\n  const [classes, setClasses] = useState([]);\n  const [selectedClass, setSelectedClass] = useState(null);\n  const [samples, setSamples] = useState([]);\n  const [selectedSamples, setSelectedSamples] = useState(new Set());\n  const [loading, setLoading] = useState(true);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [dragging, setDragging] = useState(false);\n  const fileInputRef = useRef(null);\n  const classFromUrl = searchParams.get('class');\n\n  useEffect(() => {\n    fetchClasses();\n  }, []);\n\n  useEffect(() => {\n    if (selectedClass) {\n      fetchSamples(selectedClass.id);\n    }\n  }, [selectedClass]);\n\n  useEffect(() => {\n    if (classes.length > 0 && classFromUrl) {\n      const targetClass = classes.find(c => c.id === classFromUrl);\n      if (targetClass) {\n        setSelectedClass(targetClass);\n      }\n    }\n  }, [classes, classFromUrl]);\n\n  const fetchClasses = async () => {\n    try {\n      const response = await fetch('/api/classes');\n      const data = await response.json();\n      setClasses(data);\n      if (data.length > 0 && !selectedClass && !classFromUrl) {\n        setSelectedClass(data[0]);\n      }\n    } catch (error) {\n      console.error('Error fetching classes:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchSamples = async (classId) => {\n    try {\n      const response = await fetch(`/api/classes/${classId}/samples`);\n      const data = await response.json();\n      setSamples(data);\n      setSelectedSamples(new Set());\n    } catch (error) {\n      console.error('Error fetching samples:', error);\n    }\n  };\n\n  const handleFileUpload = async (files) => {\n    if (!selectedClass || files.length === 0) return;\n\n    setUploading(true);\n    setUploadProgress(0);\n    \n    const formData = new FormData();\n    Array.from(files).forEach(file => {\n      formData.append('images', file);\n    });\n\n    try {\n      const response = await fetch(`/api/classes/${selectedClass.id}/upload`, {\n        method: 'POST',\n        body: formData\n      });\n\n      if (response.ok) {\n        const newFiles = await response.json();\n        setSamples(prev => [...newFiles, ...prev]);\n        fetchClasses();\n        setUploadProgress(100);\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Upload failed');\n      }\n    } catch (error) {\n      console.error('Error uploading files:', error);\n      alert('Upload failed. Please try again.');\n    } finally {\n      setUploading(false);\n      setTimeout(() => setUploadProgress(0), 1000);\n    }\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    setDragging(false);\n    const files = e.dataTransfer.files;\n    handleFileUpload(files);\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    setDragging(true);\n  };\n\n  const handleDragLeave = () => {\n    setDragging(false);\n  };\n\n  const toggleSampleSelection = (sampleId) => {\n    const newSelection = new Set(selectedSamples);\n    if (newSelection.has(sampleId)) {\n      newSelection.delete(sampleId);\n    } else {\n      newSelection.add(sampleId);\n    }\n    setSelectedSamples(newSelection);\n  };\n\n  const selectAllSamples = () => {\n    if (selectedSamples.size === samples.length) {\n      setSelectedSamples(new Set());\n    } else {\n      setSelectedSamples(new Set(samples.map(s => s.id)));\n    }\n  };\n\n  const deleteSelectedSamples = async () => {\n    if (selectedSamples.size === 0 || !selectedClass) return;\n    \n    if (!confirm(`Delete ${selectedSamples.size} selected image(s)? This action cannot be undone.`)) return;\n\n    try {\n      const response = await fetch(`/api/classes/${selectedClass.id}/samples`, {\n        method: 'DELETE',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ sampleIds: Array.from(selectedSamples) })\n      });\n\n      if (response.ok) {\n        setSamples(samples.filter(s => !selectedSamples.has(s.id)));\n        setSelectedSamples(new Set());\n        fetchClasses();\n      }\n    } catch (error) {\n      console.error('Error deleting samples:', error);\n    }\n  };\n\n  const deleteSample = async (sampleId) => {\n    if (!selectedClass) return;\n    \n    try {\n      const response = await fetch(`/api/classes/${selectedClass.id}/samples/${sampleId}`, {\n        method: 'DELETE'\n      });\n\n      if (response.ok) {\n        setSamples(samples.filter(s => s.id !== sampleId));\n        selectedSamples.delete(sampleId);\n        setSelectedSamples(new Set(selectedSamples));\n        fetchClasses();\n      }\n    } catch (error) {\n      console.error('Error deleting sample:', error);\n    }\n  };\n\n  if (classes.length === 0 && !loading) {\n    return (\n      <div>\n        <div className=\"page-header\">\n          <h2>Dataset Manager</h2>\n          <p>Upload and manage training images for each ICE material class</p>\n        </div>\n        \n        <div className=\"card\">\n          <div className=\"empty-state\">\n            <AlertCircle size={64} />\n            <h3>No material classes available</h3>\n            <p>Material classes are loaded from the ICE database. Check your connection.</p>\n            <button className=\"btn btn-primary mt-4\" onClick={fetchClasses}>\n              <RefreshCw size={16} />\n              Retry\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"page-header\">\n        <h2>Dataset Manager</h2>\n        <p>Upload training images for each ICE material class. Images are preprocessed (224x224) and stored in MongoDB.</p>\n      </div>\n\n      <div style={{ display: 'grid', gridTemplateColumns: '300px 1fr', gap: '24px' }}>\n        <div className=\"card\" style={{ height: 'fit-content' }}>\n          <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>Material Classes</h3>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n            {classes.map(cls => (\n              <button\n                key={cls.id}\n                className={`class-card ${selectedClass?.id === cls.id ? 'selected' : ''}`}\n                style={{ \n                  padding: '14px', \n                  textAlign: 'left',\n                  cursor: 'pointer'\n                }}\n                onClick={() => setSelectedClass(cls)}\n              >\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                  <span style={{ \n                    fontWeight: 500, \n                    color: 'var(--text-primary)',\n                    fontSize: '13px',\n                    lineHeight: '1.3'\n                  }}>\n                    {cls.name.length > 30 ? cls.id.replace(/_/g, ' ').toUpperCase() : cls.name}\n                  </span>\n                  <span className={`badge ${cls.sampleCount > 0 ? 'badge-success' : 'badge-info'}`}>\n                    {cls.sampleCount}\n                  </span>\n                </div>\n              </button>\n            ))}\n          </div>\n          \n          <div style={{ marginTop: '16px', padding: '12px', background: 'var(--bg-primary)', borderRadius: '8px' }}>\n            <div style={{ fontSize: '12px', color: 'var(--text-muted)', marginBottom: '8px' }}>Dataset Summary</div>\n            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n              <span style={{ fontSize: '14px', color: 'var(--text-secondary)' }}>Total Images:</span>\n              <span style={{ fontSize: '14px', color: '#10b981', fontWeight: '600' }}>\n                {classes.reduce((sum, c) => sum + c.sampleCount, 0)}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <div>\n          {selectedClass && (\n            <>\n              <div className=\"card\">\n                <div className=\"card-header\">\n                  <h3 className=\"card-title\">\n                    Upload Images for \"{selectedClass.id.replace(/_/g, ' ')}\"\n                  </h3>\n                </div>\n                \n                <div\n                  className={`upload-zone ${dragging ? 'dragging' : ''}`}\n                  onDrop={handleDrop}\n                  onDragOver={handleDragOver}\n                  onDragLeave={handleDragLeave}\n                  onClick={() => fileInputRef.current?.click()}\n                >\n                  {uploading ? (\n                    <>\n                      <Loader size={48} className=\"upload-zone-icon spinning\" />\n                      <p className=\"upload-zone-text\">\n                        <strong>Uploading and preprocessing...</strong>\n                      </p>\n                      <div style={{ \n                        width: '200px', \n                        height: '8px', \n                        background: '#334155', \n                        borderRadius: '4px',\n                        marginTop: '12px',\n                        overflow: 'hidden'\n                      }}>\n                        <div style={{ \n                          width: `${uploadProgress}%`, \n                          height: '100%', \n                          background: '#3b82f6',\n                          transition: 'width 0.3s'\n                        }} />\n                      </div>\n                    </>\n                  ) : (\n                    <>\n                      <Upload size={48} className=\"upload-zone-icon\" />\n                      <p className=\"upload-zone-text\">\n                        <strong>Click to upload</strong> or drag and drop\n                      </p>\n                      <p className=\"upload-zone-text\">\n                        JPEG, PNG or WebP images (max 100 at a time)\n                      </p>\n                      <p style={{ color: '#64748b', fontSize: '12px', marginTop: '8px' }}>\n                        Images will be resized to 224x224 and stored in MongoDB\n                      </p>\n                    </>\n                  )}\n                </div>\n                \n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  multiple\n                  accept=\"image/jpeg,image/png,image/webp\"\n                  style={{ display: 'none' }}\n                  onChange={(e) => handleFileUpload(e.target.files)}\n                />\n              </div>\n\n              <div className=\"card\">\n                <div className=\"card-header\">\n                  <h3 className=\"card-title\">\n                    Training Samples ({samples.length})\n                  </h3>\n                  <div style={{ display: 'flex', gap: '8px' }}>\n                    <button \n                      className=\"btn btn-outline btn-sm\"\n                      onClick={() => fetchSamples(selectedClass.id)}\n                    >\n                      <RefreshCw size={14} />\n                      Refresh\n                    </button>\n                    <button \n                      className=\"btn btn-outline btn-sm\"\n                      onClick={selectAllSamples}\n                    >\n                      {selectedSamples.size === samples.length ? (\n                        <><CheckSquare size={14} /> Deselect All</>\n                      ) : (\n                        <><Square size={14} /> Select All</>\n                      )}\n                    </button>\n                    {selectedSamples.size > 0 && (\n                      <button \n                        className=\"btn btn-danger btn-sm\"\n                        onClick={deleteSelectedSamples}\n                      >\n                        <Trash2 size={14} />\n                        Delete ({selectedSamples.size})\n                      </button>\n                    )}\n                  </div>\n                </div>\n\n                {samples.length === 0 ? (\n                  <div className=\"empty-state\">\n                    <Image size={48} />\n                    <h3>No training images yet</h3>\n                    <p>Upload images to start building this class dataset</p>\n                  </div>\n                ) : (\n                  <div className=\"samples-grid\">\n                    {samples.map(sample => (\n                      <div\n                        key={sample.id}\n                        className={`sample-card ${selectedSamples.has(sample.id) ? 'selected' : ''}`}\n                        onClick={() => toggleSampleSelection(sample.id)}\n                      >\n                        <img \n                          src={sample.thumbnailUrl || sample.url} \n                          alt={sample.filename}\n                          loading=\"lazy\"\n                        />\n                        <div className=\"sample-card-overlay\">\n                          {selectedSamples.has(sample.id) ? (\n                            <CheckSquare size={24} color=\"white\" />\n                          ) : (\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                deleteSample(sample.id);\n                              }}\n                              style={{ \n                                background: 'rgba(239, 68, 68, 0.8)',\n                                border: 'none',\n                                borderRadius: '6px',\n                                padding: '6px',\n                                cursor: 'pointer'\n                              }}\n                            >\n                              <Trash2 size={16} color=\"white\" />\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Datasets;\n","path":null,"size_bytes":14083,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"MLStudio-main/worker/train.py":{"content":"#!/usr/bin/env python3\nimport os\nimport sys\nimport json\nimport argparse\nimport numpy as np\nfrom pathlib import Path\nimport tempfile\nimport io\nimport random\n\nos.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'\n\n\ndef log_event(event_type, **kwargs):\n    event = {\"type\": event_type, **kwargs}\n    print(json.dumps(event), flush=True)\n\n\ndef log_message(message, level='info'):\n    log_event(\"log\", message=message, level=level)\n\n\nTF_AVAILABLE = False\ntry:\n    import tensorflow as tf\n    from tensorflow import keras\n    from tensorflow.keras import layers, models, optimizers, callbacks, regularizers\n    from tensorflow.keras.applications import EfficientNetB0, MobileNetV2\n    from tensorflow.keras.applications.efficientnet import preprocess_input as efficientnet_preprocess\n    from tensorflow.keras.applications.mobilenet_v2 import preprocess_input as mobilenet_preprocess\n    from tensorflow.keras.preprocessing.image import ImageDataGenerator\n    from sklearn.preprocessing import LabelEncoder\n    from sklearn.utils import class_weight\n    from sklearn.model_selection import train_test_split\n    from PIL import Image, ImageEnhance, ImageFilter\n    from pymongo import MongoClient\n    TF_AVAILABLE = True\n    log_message(\"TensorFlow and dependencies loaded successfully\")\nexcept ImportError as e:\n    log_message(f\"TensorFlow/dependencies not available: {str(e)}\",\n                level='error')\n    log_message(\n        \"Install with: pip install tensorflow pymongo scikit-learn pillow\",\n        level='error')\n\n\nclass TrainingCallback(keras.callbacks.Callback):\n\n    def __init__(self, total_epochs):\n        super().__init__()\n        self.total_epochs = total_epochs\n        self.current_phase_epoch = 0\n\n    def on_epoch_begin(self, epoch, logs=None):\n        self.current_phase_epoch = epoch\n        log_message(f\"Starting epoch {epoch + 1}/{self.total_epochs}\")\n\n    def on_epoch_end(self, epoch, logs=None):\n        logs = logs or {}\n        log_event(\"epoch_end\",\n                  epoch=epoch + 1,\n                  total_epochs=self.total_epochs,\n                  loss=float(logs.get('loss', 0)),\n                  accuracy=float(logs.get('accuracy', 0)),\n                  val_loss=float(logs.get('val_loss', 0)),\n                  val_accuracy=float(logs.get('val_accuracy', 0)))\n\n    def on_batch_end(self, batch, logs=None):\n        if batch % 10 == 0:\n            logs = logs or {}\n            log_event(\"batch_end\",\n                      batch=batch,\n                      loss=float(logs.get('loss', 0)),\n                      accuracy=float(logs.get('accuracy', 0)))\n\n\ndef advanced_augment_image(img_array):\n    \"\"\"Apply advanced augmentation to a single image\"\"\"\n    img = Image.fromarray((img_array * 127.5 + 127.5).astype(np.uint8))\n    \n    if random.random() > 0.5:\n        enhancer = ImageEnhance.Brightness(img)\n        img = enhancer.enhance(random.uniform(0.7, 1.3))\n    \n    if random.random() > 0.5:\n        enhancer = ImageEnhance.Contrast(img)\n        img = enhancer.enhance(random.uniform(0.7, 1.3))\n    \n    if random.random() > 0.5:\n        enhancer = ImageEnhance.Color(img)\n        img = enhancer.enhance(random.uniform(0.8, 1.2))\n    \n    if random.random() > 0.7:\n        img = img.filter(ImageFilter.GaussianBlur(radius=random.uniform(0.5, 1.5)))\n    \n    if random.random() > 0.8:\n        enhancer = ImageEnhance.Sharpness(img)\n        img = enhancer.enhance(random.uniform(0.8, 2.0))\n    \n    img_array = np.array(img).astype(np.float32)\n    img_array = (img_array - 127.5) / 127.5\n    \n    return img_array\n\n\ndef create_improved_model(num_classes, input_shape=(224, 224, 3), use_efficientnet=True):\n    \"\"\"Create an improved model with better regularization\"\"\"\n    \n    if use_efficientnet:\n        base_model = EfficientNetB0(\n            input_shape=input_shape,\n            include_top=False,\n            weights='imagenet'\n        )\n        preprocess_fn = efficientnet_preprocess\n    else:\n        base_model = MobileNetV2(\n            input_shape=input_shape,\n            include_top=False,\n            weights='imagenet'\n        )\n        preprocess_fn = mobilenet_preprocess\n    \n    base_model.trainable = False\n    \n    inputs = keras.Input(shape=input_shape)\n    \n    x = base_model(inputs, training=False)\n    \n    x = layers.GlobalAveragePooling2D()(x)\n    \n    x = layers.BatchNormalization()(x)\n    x = layers.Dense(512, kernel_regularizer=regularizers.l2(0.01))(x)\n    x = layers.Activation('relu')(x)\n    x = layers.Dropout(0.5)(x)\n    \n    x = layers.BatchNormalization()(x)\n    x = layers.Dense(256, kernel_regularizer=regularizers.l2(0.01))(x)\n    x = layers.Activation('relu')(x)\n    x = layers.Dropout(0.4)(x)\n    \n    x = layers.BatchNormalization()(x)\n    x = layers.Dense(128, kernel_regularizer=regularizers.l2(0.01))(x)\n    x = layers.Activation('relu')(x)\n    x = layers.Dropout(0.3)(x)\n    \n    outputs = layers.Dense(num_classes, activation='softmax', \n                          kernel_regularizer=regularizers.l2(0.01))(x)\n    \n    model = keras.Model(inputs, outputs)\n    \n    return model, base_model, preprocess_fn\n\n\ndef create_segmentation_model(num_classes, input_shape=(224, 224, 3)):\n    \"\"\"Create segmentation model with improved architecture\"\"\"\n    base_model = MobileNetV2(input_shape=input_shape,\n                             include_top=False,\n                             weights='imagenet')\n    base_model.trainable = False\n\n    x = base_model.output\n    x = layers.Conv2DTranspose(256, (3, 3), strides=(2, 2), padding='same')(x)\n    x = layers.BatchNormalization()(x)\n    x = layers.Activation('relu')(x)\n    x = layers.Dropout(0.3)(x)\n    \n    x = layers.Conv2DTranspose(128, (3, 3), strides=(2, 2), padding='same')(x)\n    x = layers.BatchNormalization()(x)\n    x = layers.Activation('relu')(x)\n    x = layers.Dropout(0.3)(x)\n    \n    x = layers.Conv2DTranspose(64, (3, 3), strides=(2, 2), padding='same')(x)\n    x = layers.BatchNormalization()(x)\n    x = layers.Activation('relu')(x)\n    \n    x = layers.Conv2DTranspose(32, (3, 3), strides=(2, 2), padding='same')(x)\n    x = layers.BatchNormalization()(x)\n    x = layers.Activation('relu')(x)\n    \n    x = layers.Conv2DTranspose(num_classes, (3, 3), strides=(2, 2), \n                               padding='same', activation='softmax')(x)\n\n    model = keras.Model(base_model.input, x)\n    return model, base_model\n\n\ndef load_data_from_mongo(mongo_uri, image_size=(224, 224)):\n    log_message(\"Connecting to MongoDB...\")\n    client = MongoClient(mongo_uri)\n    db = client['Construction_test']\n    collection = db['materialimages']\n\n    docs = list(collection.find({}))\n    log_message(f\"Found {len(docs)} images in database\")\n\n    if len(docs) == 0:\n        log_message(\"No images found in database\", level='error')\n        sys.exit(1)\n\n    X = []\n    y_labels = []\n    filenames = []\n\n    for doc in docs:\n        try:\n            img_data = doc.get('data')\n            if img_data is None:\n                continue\n\n            img = Image.open(io.BytesIO(img_data))\n            img = img.convert('RGB')\n            img = img.resize(image_size, Image.Resampling.LANCZOS)\n            img_array = np.array(img).astype(np.float32)\n            img_array = (img_array - 127.5) / 127.5\n\n            X.append(img_array)\n            label = doc.get('material_key', doc.get('material_official', 'unknown'))\n            y_labels.append(label)\n            filenames.append(doc.get('filename', 'unknown'))\n        except Exception as e:\n            log_message(\n                f\"Error processing image {doc.get('filename', 'unknown')}: {str(e)}\",\n                level='error')\n            continue\n\n    client.close()\n\n    X = np.array(X)\n    y_labels = np.array(y_labels)\n\n    log_message(f\"Loaded {len(X)} images successfully\")\n    \n    unique, counts = np.unique(y_labels, return_counts=True)\n    for label, count in zip(unique, counts):\n        log_message(f\"  Class '{label}': {count} samples\")\n    \n    return X, y_labels, filenames\n\n\ndef augment_dataset(X, y, augmentation_factor=3):\n    \"\"\"Augment the dataset by creating additional samples\"\"\"\n    log_message(f\"Augmenting dataset by factor of {augmentation_factor}...\")\n    \n    X_augmented = [X]\n    y_augmented = [y]\n    \n    datagen = ImageDataGenerator(\n        rotation_range=40,\n        width_shift_range=0.25,\n        height_shift_range=0.25,\n        shear_range=0.2,\n        zoom_range=0.25,\n        horizontal_flip=True,\n        vertical_flip=False,\n        brightness_range=[0.7, 1.3],\n        fill_mode='nearest'\n    )\n    \n    for i in range(augmentation_factor - 1):\n        X_aug = np.zeros_like(X)\n        for j in range(len(X)):\n            img = X[j:j+1]\n            img_normalized = (img + 1) * 127.5\n            augmented = datagen.random_transform(img_normalized[0])\n            X_aug[j] = (augmented - 127.5) / 127.5\n        X_augmented.append(X_aug)\n        y_augmented.append(y)\n    \n    X_final = np.concatenate(X_augmented, axis=0)\n    y_final = np.concatenate(y_augmented, axis=0)\n    \n    indices = np.random.permutation(len(X_final))\n    X_final = X_final[indices]\n    y_final = y_final[indices]\n    \n    log_message(f\"Augmented dataset size: {len(X_final)} samples\")\n    return X_final, y_final\n\n\ndef train_model(args):\n    if not TF_AVAILABLE:\n        log_message(\"TensorFlow not available. Cannot train.\", level='error')\n        sys.exit(1)\n\n    log_message(\"Initializing improved training pipeline...\")\n    log_message(f\"Configuration: epochs={args.epochs}, batch_size={args.batch_size}, lr={args.learning_rate}\")\n\n    X, y_labels, filenames = load_data_from_mongo(args.mongo_uri)\n\n    if len(X) < 10:\n        log_message(\"Not enough samples for training (minimum 10 required)\",\n                    level='error')\n        sys.exit(1)\n\n    unique_classes = np.unique(y_labels)\n    num_classes = len(unique_classes)\n\n    if num_classes < 2:\n        log_message(\"At least 2 classes are required for training\",\n                    level='error')\n        sys.exit(1)\n\n    log_message(f\"Training with {num_classes} classes: {list(unique_classes)}\")\n\n    le = LabelEncoder()\n    y = le.fit_transform(y_labels)\n    \n    labels_map = {i: cls for i, cls in enumerate(le.classes_)}\n    log_message(f\"Label mapping: {labels_map}\")\n\n    X_train, X_val, y_train, y_val = train_test_split(\n        X, y, test_size=args.validation_split, stratify=y, random_state=42\n    )\n    \n    log_message(f\"Train set: {len(X_train)} samples, Validation set: {len(X_val)} samples\")\n\n    augmentation_factor = max(3, 500 // len(X_train))\n    augmentation_factor = min(augmentation_factor, 5)\n    X_train_aug, y_train_aug = augment_dataset(X_train, y_train, augmentation_factor)\n    \n    y_train_cat = tf.keras.utils.to_categorical(y_train_aug, num_classes)\n    y_val_cat = tf.keras.utils.to_categorical(y_val, num_classes)\n\n    cw = class_weight.compute_class_weight(\"balanced\",\n                                           classes=np.unique(y_train_aug),\n                                           y=y_train_aug)\n    class_weights = {i: float(w) for i, w in enumerate(cw)}\n    log_message(f\"Class weights: {class_weights}\")\n\n    enable_seg = args.enable_segmentation.lower() == 'true'\n    log_message(f\"Creating improved model (Segmentation: {enable_seg})...\")\n    \n    if enable_seg:\n        model, base_model = create_segmentation_model(num_classes)\n        preprocess_fn = mobilenet_preprocess\n    else:\n        model, base_model, preprocess_fn = create_improved_model(num_classes, use_efficientnet=True)\n\n    model.compile(\n        optimizer=optimizers.Adam(learning_rate=args.learning_rate),\n        loss='categorical_crossentropy',\n        metrics=['accuracy']\n    )\n\n    log_message(f\"Model compiled with {model.count_params():,} parameters\")\n\n    model_dir = Path(f\"./data/models/{args.model_id}\")\n    model_dir.mkdir(parents=True, exist_ok=True)\n\n    total_epochs = args.epochs + max(10, args.epochs // 2)\n    \n    training_callbacks = [\n        TrainingCallback(total_epochs),\n        callbacks.EarlyStopping(\n            monitor='val_accuracy',\n            patience=8,\n            restore_best_weights=True,\n            verbose=1,\n            min_delta=0.001\n        ),\n        callbacks.ReduceLROnPlateau(\n            monitor='val_loss',\n            factor=0.3,\n            patience=4,\n            min_lr=1e-8,\n            verbose=1\n        ),\n        callbacks.ModelCheckpoint(\n            str(model_dir / 'best_model.keras'),\n            monitor='val_accuracy',\n            save_best_only=True,\n            verbose=1\n        )\n    ]\n\n    log_message(\"=\" * 50)\n    log_message(\"PHASE 1: Training classification head with frozen base\")\n    log_message(\"=\" * 50)\n\n    history1 = model.fit(\n        X_train_aug, y_train_cat,\n        epochs=args.epochs,\n        batch_size=args.batch_size,\n        validation_data=(X_val, y_val_cat),\n        class_weight=class_weights,\n        callbacks=training_callbacks,\n        verbose=1\n    )\n\n    best_val_acc_phase1 = max(history1.history.get('val_accuracy', [0]))\n    log_message(f\"Phase 1 complete. Best val accuracy: {best_val_acc_phase1:.4f}\")\n\n    log_message(\"=\" * 50)\n    log_message(\"PHASE 2: Fine-tuning top layers of base model\")\n    log_message(\"=\" * 50)\n\n    base_model.trainable = True\n    \n    if hasattr(base_model, 'layers'):\n        num_layers = len(base_model.layers)\n        freeze_until = int(num_layers * 0.7)\n        for layer in base_model.layers[:freeze_until]:\n            layer.trainable = False\n        log_message(f\"Unfroze {num_layers - freeze_until} of {num_layers} layers\")\n\n    model.compile(\n        optimizer=optimizers.Adam(learning_rate=args.learning_rate * 0.1),\n        loss='categorical_crossentropy',\n        metrics=['accuracy']\n    )\n\n    fine_tune_epochs = max(10, args.epochs // 2)\n    \n    history2 = model.fit(\n        X_train_aug, y_train_cat,\n        epochs=fine_tune_epochs,\n        batch_size=args.batch_size,\n        validation_data=(X_val, y_val_cat),\n        class_weight=class_weights,\n        callbacks=training_callbacks,\n        verbose=1\n    )\n\n    best_val_acc_phase2 = max(history2.history.get('val_accuracy', [0]))\n    log_message(f\"Phase 2 complete. Best val accuracy: {best_val_acc_phase2:.4f}\")\n\n    log_message(\"=\" * 50)\n    log_message(\"PHASE 3: Fine-tuning with even lower learning rate\")\n    log_message(\"=\" * 50)\n\n    if hasattr(base_model, 'layers'):\n        freeze_until = int(num_layers * 0.5)\n        for layer in base_model.layers[:freeze_until]:\n            layer.trainable = False\n        for layer in base_model.layers[freeze_until:]:\n            layer.trainable = True\n        log_message(f\"Unfroze more layers: {num_layers - freeze_until} of {num_layers}\")\n\n    model.compile(\n        optimizer=optimizers.Adam(learning_rate=args.learning_rate * 0.01),\n        loss='categorical_crossentropy',\n        metrics=['accuracy']\n    )\n\n    history3 = model.fit(\n        X_train_aug, y_train_cat,\n        epochs=fine_tune_epochs // 2,\n        batch_size=args.batch_size,\n        validation_data=(X_val, y_val_cat),\n        class_weight=class_weights,\n        callbacks=training_callbacks,\n        verbose=1\n    )\n\n    final_model_path = model_dir / 'model.keras'\n    model.save(str(final_model_path))\n    log_message(f\"Model saved to {final_model_path}\")\n\n    labels_path = model_dir / 'labels.json'\n    with open(labels_path, 'w') as f:\n        json.dump(labels_map, f, indent=2)\n    log_message(f\"Labels saved to {labels_path}\")\n\n    log_message(\"Evaluating model on validation set...\")\n    val_loss, val_accuracy = model.evaluate(X_val, y_val_cat, verbose=0)\n    log_message(f\"Final validation accuracy: {val_accuracy:.4f}\")\n\n    val_predictions = model.predict(X_val, verbose=0)\n    val_pred_classes = np.argmax(val_predictions, axis=1)\n\n    from sklearn.metrics import confusion_matrix, classification_report, precision_score, recall_score, f1_score\n    \n    cm = confusion_matrix(y_val, val_pred_classes)\n    log_event(\"confusion_matrix\",\n              matrix=cm.tolist(),\n              classes=list(labels_map.values()))\n    \n    report = classification_report(y_val, val_pred_classes, target_names=list(labels_map.values()))\n    log_message(f\"Classification Report:\\n{report}\")\n\n    precision = precision_score(y_val, val_pred_classes, average='weighted', zero_division=0)\n    recall = recall_score(y_val, val_pred_classes, average='weighted', zero_division=0)\n    f1 = f1_score(y_val, val_pred_classes, average='weighted', zero_division=0)\n\n    all_val_accuracies = (\n        history1.history.get('val_accuracy', []) + \n        history2.history.get('val_accuracy', []) + \n        history3.history.get('val_accuracy', [])\n    )\n    best_val_accuracy = max(all_val_accuracies) if all_val_accuracies else val_accuracy\n    \n    all_accuracies = (\n        history1.history.get('accuracy', []) + \n        history2.history.get('accuracy', []) + \n        history3.history.get('accuracy', [])\n    )\n    final_accuracy = all_accuracies[-1] if all_accuracies else 0\n\n    log_message(f\"=\" * 50)\n    log_message(f\"TRAINING COMPLETE!\")\n    log_message(f\"Final Training Accuracy: {final_accuracy:.4f}\")\n    log_message(f\"Best Validation Accuracy: {best_val_accuracy:.4f}\")\n    log_message(f\"Precision: {precision:.4f}\")\n    log_message(f\"Recall: {recall:.4f}\")\n    log_message(f\"F1 Score: {f1:.4f}\")\n    log_message(f\"=\" * 50)\n\n    total_epochs_trained = (\n        len(history1.history.get('accuracy', [])) +\n        len(history2.history.get('accuracy', [])) +\n        len(history3.history.get('accuracy', []))\n    )\n\n    metadata = {\n        'model_id': args.model_id,\n        'classes': list(labels_map.values()),\n        'num_classes': num_classes,\n        'class_indices': labels_map,\n        'input_shape': [224, 224, 3],\n        'training_samples': len(X_train_aug),\n        'original_samples': len(X),\n        'validation_samples': len(X_val),\n        'augmentation_factor': augmentation_factor,\n        'final_accuracy': float(final_accuracy),\n        'final_val_accuracy': float(best_val_accuracy),\n        'precision': float(precision),\n        'recall': float(recall),\n        'f1_score': float(f1),\n        'epochs_trained': total_epochs_trained,\n        'segmentation_enabled': enable_seg,\n        'model_architecture': 'EfficientNetB0' if not enable_seg else 'MobileNetV2-Segmentation',\n        'training_config': {\n            'batch_size': args.batch_size,\n            'initial_learning_rate': args.learning_rate,\n            'validation_split': args.validation_split\n        }\n    }\n\n    with open(model_dir / 'metadata.json', 'w') as f:\n        json.dump(metadata, f, indent=2)\n\n    log_message(\"All training artifacts saved successfully!\")\n\n    if best_val_accuracy < 0.5:\n        log_message(\"WARNING: Model accuracy is below 50%. Consider adding more training data.\", level='warning')\n    elif best_val_accuracy < 0.7:\n        log_message(\"Model accuracy is moderate. Adding more diverse training data may help.\", level='info')\n    elif best_val_accuracy < 0.85:\n        log_message(\"Model accuracy is good! Fine-tuning with more epochs may improve results.\", level='info')\n    else:\n        log_message(\"Excellent model accuracy achieved!\", level='info')\n\n    return {\n        'history1': history1,\n        'history2': history2,\n        'history3': history3,\n        'val_accuracy': best_val_accuracy\n    }\n\n\ndef main():\n    parser = argparse.ArgumentParser(\n        description='Train construction material detection model with improved architecture')\n    parser.add_argument('--model-id', required=True, help='Model ID')\n    parser.add_argument('--mongo-uri',\n                        required=True,\n                        help='MongoDB connection URI')\n    parser.add_argument('--epochs',\n                        type=int,\n                        default=15,\n                        help='Number of epochs for initial training')\n    parser.add_argument('--batch-size',\n                        type=int,\n                        default=16,\n                        help='Batch size')\n    parser.add_argument('--learning-rate',\n                        type=float,\n                        default=0.001,\n                        help='Initial learning rate')\n    parser.add_argument('--validation-split',\n                        type=float,\n                        default=0.2,\n                        help='Validation split')\n    parser.add_argument('--enable-segmentation',\n                        default='false',\n                        help='Enable segmentation mode')\n\n    args = parser.parse_args()\n\n    try:\n        result = train_model(args)\n        log_message(f\"Training completed with best validation accuracy: {result['val_accuracy']:.4f}\")\n    except Exception as e:\n        log_message(f\"Training failed: {str(e)}\", level='error')\n        import traceback\n        log_message(traceback.format_exc(), level='error')\n        sys.exit(1)\n\n\nif __name__ == '__main__':\n    main()\n","path":null,"size_bytes":20916,"size_tokens":null},"MLStudio-main/client/src/App.jsx":{"content":"import { Routes, Route, NavLink } from 'react-router-dom';\nimport { useState, useEffect, createContext } from 'react';\nimport { \n  LayoutDashboard, \n  Database, \n  FolderOpen, \n  Play, \n  Box, \n  Brain,\n  TestTube,\n  Sun,\n  Moon\n} from 'lucide-react';\n\nimport Dashboard from './pages/Dashboard';\nimport Classes from './pages/Classes';\nimport Datasets from './pages/Datasets';\nimport Training from './pages/Training';\nimport Models from './pages/Models';\nimport Testing from './pages/Testing';\n\nexport const WebSocketContext = createContext(null);\nexport const TrainingContext = createContext(null);\nexport const ThemeContext = createContext(null);\n\nfunction App() {\n  const [ws, setWs] = useState(null);\n  const [theme, setTheme] = useState(() => {\n    return localStorage.getItem('ml-studio-theme') || 'dark';\n  });\n  const [trainingStatus, setTrainingStatus] = useState({ status: 'idle' });\n  const [trainingLogs, setTrainingLogs] = useState([]);\n  const [trainingMetrics, setTrainingMetrics] = useState({\n    loss: [],\n    accuracy: [],\n    valLoss: [],\n    valAccuracy: [],\n    currentEpoch: 0,\n    totalEpochs: 0\n  });\n\n  useEffect(() => {\n    document.documentElement.setAttribute('data-theme', theme);\n    localStorage.setItem('ml-studio-theme', theme);\n  }, [theme]);\n\n  const toggleTheme = () => {\n    setTheme(prev => prev === 'dark' ? 'light' : 'dark');\n  };\n\n  useEffect(() => {\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n    \n    const connectWebSocket = () => {\n      const socket = new WebSocket(wsUrl);\n      \n      socket.onopen = () => {\n        console.log('WebSocket connected');\n        setWs(socket);\n      };\n      \n      socket.onmessage = (event) => {\n        const data = JSON.parse(event.data);\n        handleWebSocketMessage(data);\n      };\n      \n      socket.onclose = () => {\n        console.log('WebSocket disconnected, reconnecting...');\n        setTimeout(connectWebSocket, 3000);\n      };\n      \n      socket.onerror = (error) => {\n        console.error('WebSocket error:', error);\n      };\n    };\n    \n    connectWebSocket();\n    \n    return () => {\n      if (ws) ws.close();\n    };\n  }, []);\n\n  const handleWebSocketMessage = (data) => {\n    switch (data.type) {\n      case 'training_started':\n        setTrainingStatus({ status: 'running', runId: data.runId, modelId: data.modelId });\n        setTrainingLogs([]);\n        setTrainingMetrics({\n          loss: [],\n          accuracy: [],\n          valLoss: [],\n          valAccuracy: [],\n          currentEpoch: 0,\n          totalEpochs: 0\n        });\n        break;\n      case 'training_progress':\n        setTrainingMetrics(prev => ({\n          ...prev,\n          loss: [...prev.loss, data.loss],\n          accuracy: [...prev.accuracy, data.accuracy],\n          valLoss: [...prev.valLoss, data.val_loss],\n          valAccuracy: [...prev.valAccuracy, data.val_accuracy],\n          currentEpoch: data.epoch,\n          totalEpochs: data.total_epochs\n        }));\n        break;\n      case 'training_log':\n        setTrainingLogs(prev => [...prev, { \n          message: data.message, \n          level: data.level || 'info',\n          timestamp: new Date().toISOString()\n        }]);\n        break;\n      case 'training_completed':\n        setTrainingStatus({ \n          status: data.exitCode === 0 ? 'completed' : 'failed',\n          runId: data.runId,\n          modelId: data.modelId\n        });\n        break;\n      case 'training_stopped':\n        setTrainingStatus({ status: 'stopped', runId: data.runId });\n        break;\n      case 'training_status':\n        if (data.status === 'running') {\n          setTrainingStatus({ status: 'running', runId: data.runId });\n        }\n        break;\n    }\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme }}>\n      <WebSocketContext.Provider value={ws}>\n        <TrainingContext.Provider value={{ \n          trainingStatus, \n          setTrainingStatus, \n          trainingLogs, \n          setTrainingLogs,\n          trainingMetrics,\n          setTrainingMetrics\n        }}>\n          <div className=\"app-container\">\n            <aside className=\"sidebar\">\n              <div className=\"sidebar-header\">\n                <h1>\n                  <Brain size={24} />\n                  ML Studio\n                </h1>\n                <span>Construction Material Detection</span>\n              </div>\n              \n              <nav className=\"sidebar-nav\">\n                <div className=\"nav-section\">\n                  <div className=\"nav-section-title\">Overview</div>\n                  <NavLink to=\"/\" className={({ isActive }) => `nav-link ${isActive ? 'active' : ''}`}>\n                    <LayoutDashboard size={20} />\n                    Dashboard\n                  </NavLink>\n                </div>\n                \n                <div className=\"nav-section\">\n                  <div className=\"nav-section-title\">Data Management</div>\n                  <NavLink to=\"/classes\" className={({ isActive }) => `nav-link ${isActive ? 'active' : ''}`}>\n                    <FolderOpen size={20} />\n                    Material Classes\n                  </NavLink>\n                  <NavLink to=\"/datasets\" className={({ isActive }) => `nav-link ${isActive ? 'active' : ''}`}>\n                    <Database size={20} />\n                    Dataset Manager\n                  </NavLink>\n                </div>\n                \n                <div className=\"nav-section\">\n                  <div className=\"nav-section-title\">Model Training</div>\n                  <NavLink to=\"/training\" className={({ isActive }) => `nav-link ${isActive ? 'active' : ''}`}>\n                    <Play size={20} />\n                    Training\n                  </NavLink>\n                  <NavLink to=\"/models\" className={({ isActive }) => `nav-link ${isActive ? 'active' : ''}`}>\n                    <Box size={20} />\n                    Models\n                  </NavLink>\n                  <NavLink to=\"/testing\" className={({ isActive }) => `nav-link ${isActive ? 'active' : ''}`}>\n                    <TestTube size={20} />\n                    Model Testing\n                  </NavLink>\n                </div>\n              </nav>\n              \n              <div className=\"sidebar-footer\">\n                <button className=\"theme-toggle\" onClick={toggleTheme}>\n                  {theme === 'dark' ? <Sun size={18} /> : <Moon size={18} />}\n                  <span>{theme === 'dark' ? 'Light Mode' : 'Dark Mode'}</span>\n                </button>\n              </div>\n            </aside>\n            \n            <main className=\"main-content\">\n              <Routes>\n                <Route path=\"/\" element={<Dashboard />} />\n                <Route path=\"/classes\" element={<Classes />} />\n                <Route path=\"/datasets\" element={<Datasets />} />\n                <Route path=\"/training\" element={<Training />} />\n                <Route path=\"/models\" element={<Models />} />\n                <Route path=\"/testing\" element={<Testing />} />\n              </Routes>\n            </main>\n          </div>\n        </TrainingContext.Provider>\n      </WebSocketContext.Provider>\n    </ThemeContext.Provider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":7274,"size_tokens":null},"client/src/pages/project-detail.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Link, useRoute } from \"wouter\";\nimport { ArrowLeft, MapPin, Calendar, CheckCircle2, AlertCircle, Clock, Plus, Trash2, Loader2 } from \"lucide-react\";\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport api from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface ProjectMaterial {\n  materialKey: string;\n  materialName: string;\n  quantity: number;\n  unit: string;\n  embodiedCarbon: number;\n  embodiedEnergy: number;\n}\n\ninterface Project {\n  id: string;\n  name: string;\n  description?: string;\n  location: string;\n  status: string;\n  progress: number;\n  sustainabilityScore: number;\n  targetCompletionDate?: string;\n  image?: string;\n  totalCarbonFootprint: number;\n  totalEmbodiedEnergy: number;\n  materials: ProjectMaterial[];\n  teamMembers: string[];\n  budget?: number;\n  createdAt: string;\n}\n\ninterface Material {\n  id: string;\n  key: string;\n  name: string;\n  embodiedCarbon: number;\n  embodiedEnergy: number;\n}\n\nexport default function ProjectDetail() {\n  const [match, params] = useRoute(\"/projects/:id\");\n  const [project, setProject] = useState<Project | null>(null);\n  const [materials, setMaterials] = useState<Material[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [adding, setAdding] = useState(false);\n  const { toast } = useToast();\n\n  const [newMaterial, setNewMaterial] = useState({\n    materialKey: \"\",\n    quantity: 1,\n    unit: \"kg\"\n  });\n\n  useEffect(() => {\n    if (params?.id) {\n      loadData(params.id);\n    }\n  }, [params?.id]);\n\n  const loadData = async (id: string) => {\n    try {\n      const [projectData, materialsData] = await Promise.all([\n        api.getProject(id),\n        api.getMaterials()\n      ]);\n      setProject(projectData);\n      setMaterials(materialsData);\n    } catch (error) {\n      console.error(\"Failed to load project:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAddMaterial = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!project || !newMaterial.materialKey) return;\n    \n    setAdding(true);\n    try {\n      const selectedMaterial = materials.find(m => m.key === newMaterial.materialKey);\n      if (!selectedMaterial) return;\n\n      await api.addProjectMaterial(project.id, {\n        materialKey: newMaterial.materialKey,\n        materialName: selectedMaterial.name,\n        quantity: newMaterial.quantity,\n        unit: newMaterial.unit,\n        embodiedCarbon: selectedMaterial.embodiedCarbon,\n        embodiedEnergy: selectedMaterial.embodiedEnergy\n      });\n\n      toast({ title: \"Success\", description: \"Material added to project\" });\n      setDialogOpen(false);\n      setNewMaterial({ materialKey: \"\", quantity: 1, unit: \"kg\" });\n      loadData(project.id);\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setAdding(false);\n    }\n  };\n\n  const formatDate = (dateStr?: string) => {\n    if (!dateStr) return \"TBD\";\n    return new Date(dateStr).toLocaleDateString(\"en-US\", { month: \"short\", year: \"numeric\" });\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"Completed\": return \"bg-green-500\";\n      case \"In Progress\": return \"bg-blue-500\";\n      case \"Planning\": return \"bg-yellow-500\";\n      case \"On Hold\": return \"bg-gray-500\";\n      default: return \"bg-gray-500\";\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!project) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold mb-2\">Project Not Found</h2>\n          <Link href=\"/projects\">\n            <Button>Back to Projects</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  const timelineData = [\n    { month: 'Week 1', actual: project.progress * 0.2, planned: 20 },\n    { month: 'Week 2', actual: project.progress * 0.4, planned: 40 },\n    { month: 'Week 3', actual: project.progress * 0.6, planned: 60 },\n    { month: 'Week 4', actual: project.progress * 0.8, planned: 80 },\n    { month: 'Current', actual: project.progress, planned: 100 },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <div className=\"relative h-64 bg-slate-900\">\n        {project.image ? (\n          <img src={project.image} alt={project.name} className=\"w-full h-full object-cover opacity-50\" />\n        ) : (\n          <div className=\"w-full h-full bg-gradient-to-br from-primary/30 to-slate-900\" />\n        )}\n        <div className=\"absolute inset-0 bg-gradient-to-t from-background to-transparent\" />\n        <div className=\"absolute bottom-0 left-0 right-0 p-8\">\n          <div className=\"container mx-auto\">\n            <Link href=\"/projects\">\n              <Button variant=\"link\" className=\"text-white/80 hover:text-white pl-0 mb-4\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Projects\n              </Button>\n            </Link>\n            <div className=\"flex flex-col md:flex-row justify-between items-end gap-4\">\n              <div>\n                <h1 className=\"text-4xl font-display font-bold text-white mb-2\">{project.name}</h1>\n                <div className=\"flex items-center text-white/80 gap-4\">\n                  <span className=\"flex items-center\"><MapPin className=\"w-4 h-4 mr-1\" /> {project.location}</span>\n                  <span className=\"flex items-center\"><Calendar className=\"w-4 h-4 mr-1\" /> Due: {formatDate(project.targetCompletionDate)}</span>\n                </div>\n              </div>\n              <Badge className={`${getStatusColor(project.status)} text-white text-lg px-4 py-2 border-none shadow-lg`}>\n                {project.status}\n              </Badge>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 pt-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2 space-y-8\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">Sustainability Score</p>\n                  <h3 className=\"text-3xl font-bold text-primary\">{project.sustainabilityScore}/100</h3>\n                  <Progress value={project.sustainabilityScore} className=\"h-2 mt-3\" />\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">Carbon Footprint</p>\n                  <h3 className=\"text-3xl font-bold text-orange-600\">{project.totalCarbonFootprint.toFixed(1)}kg</h3>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Total CO2e</p>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">Materials</p>\n                  <h3 className=\"text-3xl font-bold text-blue-600\">{project.materials.length}</h3>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Added to project</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Project Progress</CardTitle>\n                <CardDescription>Actual vs Planned Completion (%)</CardDescription>\n              </CardHeader>\n              <CardContent className=\"h-[300px]\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <LineChart data={timelineData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" vertical={false} />\n                    <XAxis dataKey=\"month\" />\n                    <YAxis domain={[0, 100]} />\n                    <Tooltip />\n                    <Line type=\"monotone\" dataKey=\"actual\" stroke=\"#16a34a\" strokeWidth={3} name=\"Actual\" />\n                    <Line type=\"monotone\" dataKey=\"planned\" stroke=\"#94a3b8\" strokeDasharray=\"5 5\" name=\"Planned\" />\n                  </LineChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between\">\n                <div>\n                  <CardTitle>Project Materials</CardTitle>\n                  <CardDescription>Materials added to this project</CardDescription>\n                </div>\n                <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n                  <DialogTrigger asChild>\n                    <Button size=\"sm\">\n                      <Plus className=\"w-4 h-4 mr-2\" /> Add Material\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogTitle>Add Material to Project</DialogTitle>\n                    </DialogHeader>\n                    <form onSubmit={handleAddMaterial} className=\"space-y-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Material</Label>\n                        <Select\n                          value={newMaterial.materialKey}\n                          onValueChange={(value) => setNewMaterial({ ...newMaterial, materialKey: value })}\n                        >\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Select material\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {materials.map((m) => (\n                              <SelectItem key={m.key} value={m.key}>{m.name}</SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"space-y-2\">\n                          <Label>Quantity</Label>\n                          <Input\n                            type=\"number\"\n                            min=\"1\"\n                            value={newMaterial.quantity}\n                            onChange={(e) => setNewMaterial({ ...newMaterial, quantity: Number(e.target.value) })}\n                          />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>Unit</Label>\n                          <Select\n                            value={newMaterial.unit}\n                            onValueChange={(value) => setNewMaterial({ ...newMaterial, unit: value })}\n                          >\n                            <SelectTrigger>\n                              <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"kg\">kg</SelectItem>\n                              <SelectItem value=\"mÂ³\">mÂ³</SelectItem>\n                              <SelectItem value=\"mÂ²\">mÂ²</SelectItem>\n                              <SelectItem value=\"units\">units</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n                      </div>\n                      <Button type=\"submit\" className=\"w-full\" disabled={adding}>\n                        {adding ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : \"Add Material\"}\n                      </Button>\n                    </form>\n                  </DialogContent>\n                </Dialog>\n              </CardHeader>\n              <CardContent>\n                {project.materials.length === 0 ? (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <p>No materials added yet. Click \"Add Material\" to get started.</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {project.materials.map((mat, i) => (\n                      <div key={i} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                        <div>\n                          <h4 className=\"font-medium\">{mat.materialName}</h4>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {mat.quantity} {mat.unit} â€¢ {(mat.embodiedCarbon * mat.quantity).toFixed(2)} kgCO2\n                          </p>\n                        </div>\n                        <Badge variant=\"secondary\">{mat.embodiedCarbon} kgCO2/kg</Badge>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          <div className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Project Details</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Description</p>\n                  <p className=\"font-medium\">{project.description || \"No description provided\"}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Progress</p>\n                  <div className=\"flex items-center gap-2\">\n                    <Progress value={project.progress} className=\"flex-1 h-2\" />\n                    <span className=\"font-medium\">{project.progress}%</span>\n                  </div>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Total Embodied Energy</p>\n                  <p className=\"font-medium\">{project.totalEmbodiedEnergy.toFixed(1)} MJ</p>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-primary/5 border-primary/20\">\n              <CardHeader>\n                <CardTitle className=\"text-primary\">Environmental Impact</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Carbon Footprint</p>\n                    <p className=\"text-2xl font-bold\">{project.totalCarbonFootprint.toFixed(1)} kgCO2</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Sustainability Score</p>\n                    <p className=\"text-2xl font-bold text-primary\">{project.sustainabilityScore}/100</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":15527,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"client/src/pages/landing.tsx":{"content":"import { useState } from \"react\";\nimport { MaterialScanner } from \"@/components/material-scanner\";\nimport { CarbonStats } from \"@/components/carbon-stats\";\nimport { AlternativesGrid } from \"@/components/alternatives\";\nimport heroImage from \"@assets/generated_images/hero_image_for_sustainable_construction_app.png\";\nimport { motion } from \"framer-motion\";\nimport { Sprout, Building2, BarChart3, Menu, Scan, Leaf, LogIn, ArrowRight, Quote, Star, Users } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Link, useLocation } from \"wouter\";\nimport {\n    Dialog,\n    DialogContent,\n    DialogDescription,\n    DialogFooter,\n    DialogHeader,\n    DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\n\nexport default function Landing() {\n  const [hasScanned, setHasScanned] = useState(false);\n  const [scanCount, setScanCount] = useState(0);\n  const [showLoginPrompt, setShowLoginPrompt] = useState(false);\n  const [_, setLocation] = useLocation();\n\n  const handleScanComplete = () => {\n    if (scanCount >= 2) { // 0, 1, 2 = 3 tries\n      setHasScanned(true);\n      setScanCount(prev => prev + 1);\n      setTimeout(() => {\n        setShowLoginPrompt(true);\n      }, 2000);\n    } else {\n      setHasScanned(true);\n      setScanCount(prev => prev + 1);\n    }\n  };\n\n  const testimonials = [\n    {\n        name: \"Sarah Chen\",\n        role: \"Lead Architect, BuildGreen\",\n        text: \"EcoBuild.AI has completely transformed our material selection process. We've reduced our projects' embodied carbon by 30% on average.\",\n        avatar: \"SC\"\n    },\n    {\n        name: \"Marcus Thorne\",\n        role: \"Structural Engineer\",\n        text: \"The accuracy of the material recognition is impressive. It saves us hours of manual documentation during site audits.\",\n        avatar: \"MT\"\n    },\n    {\n        name: \"Elena Rodriguez\",\n        role: \"Sustainability Consultant\",\n        text: \"Finally, a tool that makes lifecycle assessment accessible. The alternative recommendations are always practical and structurally sound.\",\n        avatar: \"ER\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground font-sans flex flex-col\">\n      {/* Navigation */}\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg group-hover:scale-110 transition-transform\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          \n          <div className=\"hidden md:flex items-center gap-8 text-sm font-medium text-muted-foreground\">\n            <Link href=\"/about\" className=\"hover:text-primary transition-colors\">About</Link>\n            <Link href=\"/features\" className=\"hover:text-primary transition-colors\">Features</Link>\n            <Link href=\"/pricing\" className=\"hover:text-primary transition-colors\">Pricing</Link>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/auth\">\n                <Button variant=\"ghost\" className=\"hidden md:flex\">Sign In</Button>\n            </Link>\n            <Link href=\"/auth\">\n                <Button>Get Started <ArrowRight className=\"ml-2 w-4 h-4\" /></Button>\n            </Link>\n            <Button size=\"icon\" variant=\"ghost\" className=\"md:hidden\">\n              <Menu className=\"w-5 h-5\" />\n            </Button>\n          </div>\n        </div>\n      </nav>\n\n      <main className=\"relative flex-grow\">\n        {/* Hero Section */}\n        {!hasScanned && (\n          <section className=\"relative h-[600px] flex items-center overflow-hidden\">\n            <div className=\"absolute inset-0 z-0\">\n              <img src={heroImage} alt=\"Construction Site\" className=\"w-full h-full object-cover\" />\n              <div className=\"absolute inset-0 bg-gradient-to-r from-background via-background/90 to-transparent\" />\n            </div>\n            \n            <div className=\"container mx-auto px-4 relative z-10\">\n              <motion.div \n                initial={{ opacity: 0, y: 30 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.8 }}\n                className=\"max-w-2xl space-y-6\"\n              >\n                <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 border border-primary/20 text-primary text-xs font-bold uppercase tracking-wider\">\n                  <Building2 className=\"w-3 h-3\" /> Intelligent Construction\n                </div>\n                <h1 className=\"text-5xl md:text-7xl font-display font-bold leading-tight text-foreground\">\n                  Build Smarter.<br />\n                  <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-primary to-emerald-600\">Build Greener.</span>\n                </h1>\n                <p className=\"text-lg text-muted-foreground max-w-lg\">\n                  Try our AI-powered material scanner for free. Identify materials and find eco-friendly alternatives instantly.\n                </p>\n                <div className=\"flex gap-4 pt-4\">\n                    <Button size=\"lg\" className=\"h-12 px-8 text-lg shadow-lg shadow-primary/20\" onClick={() => document.getElementById('scanner-section')?.scrollIntoView({behavior: 'smooth'})}>\n                        Try Demo Scanner\n                    </Button>\n                    <Link href=\"/about\">\n                        <Button size=\"lg\" variant=\"outline\" className=\"h-12 px-8 text-lg\">\n                            Learn More\n                        </Button>\n                    </Link>\n                </div>\n              </motion.div>\n            </div>\n          </section>\n        )}\n\n        <div id=\"scanner-section\" className={`container mx-auto px-4 ${hasScanned ? 'pt-8' : 'py-24'} relative z-20 pb-20`}>\n            {!hasScanned && (\n                <div className=\"text-center mb-12\">\n                    <h2 className=\"text-3xl font-display font-bold mb-4\">Experience the Power of AI</h2>\n                    <p className=\"text-muted-foreground max-w-2xl mx-auto\">Upload or drag and drop a material image to see our analysis engine in action. <br/>You have <span className=\"font-bold text-primary\">{3 - scanCount} free scans</span> remaining.</p>\n                </div>\n            )}\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8\">\n            \n            {/* Left Column: Scanner & Info */}\n            <div className={`lg:col-span-4 space-y-6 ${!hasScanned ? 'lg:col-start-5' : ''}`}>\n              <motion.div layout>\n                <MaterialScanner onScanComplete={handleScanComplete} />\n              </motion.div>\n              \n              {hasScanned && (\n                <motion.div \n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  className=\"bg-card rounded-lg p-6 shadow-sm border border-border\"\n                >\n                  <h3 className=\"font-bold font-display text-lg mb-4\">Detected Properties</h3>\n                  <ul className=\"space-y-3 text-sm\">\n                    <li className=\"flex justify-between py-2 border-b border-border/50 hover:bg-secondary/10 px-2 rounded transition-colors cursor-default group\">\n                      <span className=\"text-muted-foreground\">Material Type</span>\n                      <span className=\"font-medium group-hover:text-primary transition-colors\">Concrete (C25/30)</span>\n                    </li>\n                    <li className=\"flex justify-between py-2 border-b border-border/50 hover:bg-secondary/10 px-2 rounded transition-colors cursor-default group\">\n                      <span className=\"text-muted-foreground\">Density</span>\n                      <span className=\"font-medium group-hover:text-primary transition-colors\">2400 kg/mÂ³</span>\n                    </li>\n                    <li className=\"flex justify-between py-2 border-b border-border/50 hover:bg-secondary/10 px-2 rounded transition-colors cursor-default group\">\n                      <span className=\"text-muted-foreground\">Thermal Conductivity</span>\n                      <span className=\"font-medium group-hover:text-primary transition-colors\">1.7 W/mK</span>\n                    </li>\n                    <li className=\"flex justify-between pt-2 hover:shadow-md p-2 rounded transition-all\">\n                      <span className=\"text-muted-foreground\">Embodied Carbon</span>\n                      <span className=\"font-medium text-destructive flex items-center gap-1\">High <AlertTriangleIcon className=\"w-4 h-4\" /></span>\n                    </li>\n                  </ul>\n                </motion.div>\n              )}\n            </div>\n\n            {/* Right Column: Dashboard (Only visible after scan) */}\n            {hasScanned && (\n                <div className=\"lg:col-span-8\">\n                    <motion.div \n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    className=\"space-y-8\"\n                    >\n                    <div className=\"hover:scale-[1.01] transition-transform duration-300\">\n                         <CarbonStats />\n                    </div>\n                    <AlternativesGrid />\n                    </motion.div>\n                </div>\n            )}\n          </div>\n        </div>\n\n         {/* Features Section (only if not scanned to keep clean) */}\n         {!hasScanned && (\n            <>\n                <section id=\"features\" className=\"bg-secondary/20 py-24\">\n                    <div className=\"container mx-auto px-4\">\n                        <div className=\"text-center mb-16\">\n                            <h2 className=\"text-3xl font-display font-bold mb-4\">Why Choose EcoBuild.AI?</h2>\n                            <p className=\"text-muted-foreground max-w-2xl mx-auto\">Comprehensive tools for the modern sustainable architect.</p>\n                        </div>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                            {[\n                                { icon: Scan, title: \"Instant Recognition\", desc: \"Identify materials in seconds with 99% accuracy using our proprietary computer vision models.\" },\n                                { icon: BarChart3, title: \"Carbon Analytics\", desc: \"Real-time footprint calculation and lifecycle analysis to ensure compliance with green building standards.\" },\n                                { icon: Leaf, title: \"Eco Alternatives\", desc: \"Get AI-recommended sustainable substitutes that match structural requirements but lower carbon impact.\" }\n                            ].map((feature, i) => (\n                                <Card key={i} className=\"bg-background border-none shadow-lg hover:-translate-y-2 transition-transform duration-300\">\n                                    <CardContent className=\"pt-8 text-center\">\n                                        <div className=\"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center mb-6 text-primary mx-auto\">\n                                            <feature.icon className=\"w-8 h-8\" />\n                                        </div>\n                                        <h3 className=\"font-bold font-display text-xl mb-4\">{feature.title}</h3>\n                                        <p className=\"text-muted-foreground leading-relaxed\">{feature.desc}</p>\n                                    </CardContent>\n                                </Card>\n                            ))}\n                        </div>\n                    </div>\n                </section>\n\n                {/* Trusted By */}\n                <section className=\"py-16\">\n                    <div className=\"container mx-auto px-4 text-center\">\n                        <p className=\"text-sm font-bold text-muted-foreground uppercase tracking-widest mb-8\">Trusted by forward-thinking teams at</p>\n                        <div className=\"flex flex-wrap justify-center gap-12 opacity-50 grayscale hover:grayscale-0 transition-all duration-500\">\n                            {/* Placeholder Logos using text for now */}\n                            <div className=\"text-2xl font-bold font-display\">ARCH<span className=\"text-primary\">STUDIO</span></div>\n                            <div className=\"text-2xl font-bold font-display\">BUILD<span className=\"text-primary\">WORKS</span></div>\n                            <div className=\"text-2xl font-bold font-display\">GREEN<span className=\"text-primary\">PLAN</span></div>\n                            <div className=\"text-2xl font-bold font-display\">URBAN<span className=\"text-primary\">LAB</span></div>\n                        </div>\n                    </div>\n                </section>\n\n                {/* Testimonials */}\n                <section className=\"py-24 bg-slate-900 text-white\">\n                    <div className=\"container mx-auto px-4\">\n                        <div className=\"text-center mb-16\">\n                            <h2 className=\"text-3xl font-display font-bold mb-4\">What Architects Are Saying</h2>\n                        </div>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                            {testimonials.map((t, i) => (\n                                <Card key={i} className=\"bg-white/5 border-white/10 text-white\">\n                                    <CardContent className=\"pt-8\">\n                                        <Quote className=\"w-8 h-8 text-primary mb-4 opacity-50\" />\n                                        <p className=\"text-lg leading-relaxed mb-6 text-white/90\">\"{t.text}\"</p>\n                                        <div className=\"flex items-center gap-4\">\n                                            <Avatar>\n                                                <AvatarFallback className=\"text-black font-bold bg-white\">{t.avatar}</AvatarFallback>\n                                            </Avatar>\n                                            <div>\n                                                <p className=\"font-bold\">{t.name}</p>\n                                                <p className=\"text-sm text-white/60\">{t.role}</p>\n                                            </div>\n                                        </div>\n                                    </CardContent>\n                                </Card>\n                            ))}\n                        </div>\n                    </div>\n                </section>\n            </>\n         )}\n\n      </main>\n\n      {/* Footer */}\n      <footer className=\"bg-slate-950 text-white py-12 border-t border-white/10\">\n        <div className=\"container mx-auto px-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8 mb-12\">\n                <div className=\"space-y-4\">\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                            <Sprout className=\"w-5 h-5\" />\n                        </div>\n                        <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n                    </div>\n                    <p className=\"text-slate-400 text-sm leading-relaxed\">\n                        Empowering architects to build a sustainable future through intelligent material analysis.\n                    </p>\n                </div>\n                \n                <div>\n                    <h4 className=\"font-bold mb-4\">Product</h4>\n                    <ul className=\"space-y-2 text-sm text-slate-400\">\n                        <li><Link href=\"/features\" className=\"hover:text-primary transition-colors\">Features</Link></li>\n                        <li><Link href=\"/pricing\" className=\"hover:text-primary transition-colors\">Pricing</Link></li>\n                        <li><Link href=\"/api\" className=\"hover:text-primary transition-colors\">API</Link></li>\n                        <li><Link href=\"/case-studies\" className=\"hover:text-primary transition-colors\">Case Studies</Link></li>\n                    </ul>\n                </div>\n\n                <div>\n                    <h4 className=\"font-bold mb-4\">Company</h4>\n                    <ul className=\"space-y-2 text-sm text-slate-400\">\n                        <li><Link href=\"/about\" className=\"hover:text-primary transition-colors\">About Us</Link></li>\n                        <li><a href=\"#\" className=\"hover:text-primary transition-colors\">Careers</a></li>\n                        <li><a href=\"#\" className=\"hover:text-primary transition-colors\">Blog</a></li>\n                        <li><Link href=\"/contact\" className=\"hover:text-primary transition-colors\">Contact</Link></li>\n                    </ul>\n                </div>\n\n                <div>\n                    <h4 className=\"font-bold mb-4\">Legal</h4>\n                    <ul className=\"space-y-2 text-sm text-slate-400\">\n                        <li><Link href=\"/privacy\" className=\"hover:text-primary transition-colors\">Privacy Policy</Link></li>\n                        <li><Link href=\"/terms\" className=\"hover:text-primary transition-colors\">Terms of Service</Link></li>\n                        <li><Link href=\"/cookies\" className=\"hover:text-primary transition-colors\">Cookie Policy</Link></li>\n                    </ul>\n                </div>\n            </div>\n            <div className=\"pt-8 border-t border-white/10 text-center text-slate-500 text-sm\">\n                &copy; 2025 EcoBuild AI Inc. All rights reserved.\n            </div>\n        </div>\n      </footer>\n\n      {/* Login Limit Dialog */}\n      <Dialog open={showLoginPrompt} onOpenChange={setShowLoginPrompt}>\n        <DialogContent>\n            <DialogHeader>\n                <DialogTitle>Free Scans Limit Reached</DialogTitle>\n                <DialogDescription>\n                    You've hit the limit of 3 free scans. Create a free account to continue analyzing materials and unlock full reports.\n                </DialogDescription>\n            </DialogHeader>\n            <DialogFooter className=\"flex-col sm:flex-row gap-2\">\n                <Button variant=\"outline\" onClick={() => setShowLoginPrompt(false)}>Cancel</Button>\n                <Link href=\"/auth\">\n                    <Button className=\"w-full sm:w-auto\">Sign Up Free</Button>\n                </Link>\n            </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n\nfunction AlertTriangleIcon(props: any) {\n    return (\n      <svg\n        {...props}\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"24\"\n        height=\"24\"\n        viewBox=\"0 0 24 24\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      >\n        <path d=\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\" />\n        <path d=\"M12 9v4\" />\n        <path d=\"M12 17h.01\" />\n      </svg>\n    )\n  }","path":null,"size_bytes":19435,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"MLStudio-main/client/src/pages/Training.jsx":{"content":"import { useState, useEffect, useContext, useRef } from 'react';\nimport { \n  Play, \n  Square, \n  Settings,\n  TrendingUp,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  Zap,\n  Target\n} from 'lucide-react';\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { TrainingContext } from '../App';\n\nfunction Training() {\n  const { \n    trainingStatus, \n    setTrainingStatus, \n    trainingLogs, \n    setTrainingLogs,\n    trainingMetrics \n  } = useContext(TrainingContext);\n  \n  const [stats, setStats] = useState(null);\n  const [showConfig, setShowConfig] = useState(false);\n  const [config, setConfig] = useState({\n    epochs: 15,\n    batchSize: 16,\n    learningRate: 0.0001,\n    validationSplit: 0.2,\n    enableSegmentation: false\n  });\n  const [trainingHistory, setTrainingHistory] = useState([]);\n  const logsEndRef = useRef(null);\n\n  useEffect(() => {\n    fetchStats();\n    fetchTrainingHistory();\n  }, []);\n\n  useEffect(() => {\n    logsEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [trainingLogs]);\n\n  const fetchStats = async () => {\n    try {\n      const response = await fetch('/api/dataset/stats');\n      const data = await response.json();\n      setStats(data);\n    } catch (error) {\n      console.error('Error fetching stats:', error);\n    }\n  };\n\n  const fetchTrainingHistory = async () => {\n    try {\n      const response = await fetch('/api/training/history');\n      const data = await response.json();\n      setTrainingHistory(data);\n    } catch (error) {\n      console.error('Error fetching history:', error);\n    }\n  };\n\n  const startTraining = async () => {\n    try {\n      const response = await fetch('/api/training/start', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(config)\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        alert(error.error || 'Failed to start training');\n        return;\n      }\n\n      const data = await response.json();\n      setTrainingStatus({ status: 'running', runId: data.runId, modelId: data.modelId });\n      setTrainingLogs([]);\n      setShowConfig(false);\n    } catch (error) {\n      console.error('Error starting training:', error);\n      alert('Failed to start training');\n    }\n  };\n\n  const stopTraining = async () => {\n    try {\n      await fetch('/api/training/stop', { method: 'POST' });\n    } catch (error) {\n      console.error('Error stopping training:', error);\n    }\n  };\n\n  const chartData = trainingMetrics.loss.map((loss, index) => ({\n    epoch: index + 1,\n    loss: loss,\n    accuracy: trainingMetrics.accuracy[index],\n    valLoss: trainingMetrics.valLoss[index],\n    valAccuracy: trainingMetrics.valAccuracy[index]\n  }));\n\n  const canTrain = stats && stats.totalClasses >= 2 && stats.totalSamples >= 10;\n  const isTraining = trainingStatus.status === 'running';\n\n  return (\n    <div>\n      <div className=\"page-header\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h2>Model Training</h2>\n            <p>Train your ICE material detection model with MongoDB-stored images</p>\n          </div>\n          <div style={{ display: 'flex', gap: '12px' }}>\n            {!isTraining && (\n              <button \n                className=\"btn btn-outline\"\n                onClick={() => setShowConfig(!showConfig)}\n              >\n                <Settings size={16} />\n                Configure\n              </button>\n            )}\n            {isTraining ? (\n              <button className=\"btn btn-danger\" onClick={stopTraining}>\n                <Square size={16} />\n                Stop Training\n              </button>\n            ) : (\n              <button \n                className=\"btn btn-primary\" \n                onClick={startTraining}\n                disabled={!canTrain}\n              >\n                <Play size={16} />\n                Start Training\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {!canTrain && !isTraining && (\n        <div className=\"card\" style={{ borderColor: '#f97316', background: 'rgba(249, 115, 22, 0.1)' }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\n            <AlertCircle size={24} color=\"#f97316\" />\n            <div>\n              <h4 style={{ color: '#f97316', marginBottom: '4px' }}>Cannot start training</h4>\n              <p className=\"text-muted\">\n                You need at least 2 material classes and 10 total samples in MongoDB.\n                Current: {stats?.totalClasses || 0} classes, {stats?.totalSamples || 0} samples\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showConfig && !isTraining && (\n        <div className=\"card\">\n          <h3 className=\"card-title\" style={{ marginBottom: '20px' }}>Training Configuration</h3>\n          <div className=\"training-config\">\n            <div className=\"form-group\">\n              <label className=\"form-label\">Epochs</label>\n              <input\n                type=\"number\"\n                className=\"input\"\n                value={config.epochs}\n                onChange={e => setConfig({ ...config, epochs: parseInt(e.target.value) })}\n                min={5}\n                max={100}\n              />\n              <small className=\"text-muted\">More epochs = better accuracy (15-30 recommended)</small>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">Batch Size</label>\n              <input\n                type=\"number\"\n                className=\"input\"\n                value={config.batchSize}\n                onChange={e => setConfig({ ...config, batchSize: parseInt(e.target.value) })}\n                min={8}\n                max={64}\n              />\n              <small className=\"text-muted\">16-32 works well for most datasets</small>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">Learning Rate</label>\n              <input\n                type=\"number\"\n                className=\"input\"\n                value={config.learningRate}\n                onChange={e => setConfig({ ...config, learningRate: parseFloat(e.target.value) })}\n                step={0.00001}\n                min={0.00001}\n                max={0.01}\n              />\n              <small className=\"text-muted\">0.0001 is a safe default</small>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">Validation Split</label>\n              <input\n                type=\"number\"\n                className=\"input\"\n                value={config.validationSplit}\n                onChange={e => setConfig({ ...config, validationSplit: parseFloat(e.target.value) })}\n                step={0.05}\n                min={0.1}\n                max={0.3}\n              />\n              <small className=\"text-muted\">20% validation is standard</small>\n            </div>\n          </div>\n          \n          <div style={{ marginTop: '20px', padding: '16px', background: '#0f172a', borderRadius: '8px' }}>\n            <label style={{ display: 'flex', alignItems: 'center', gap: '12px', cursor: 'pointer' }}>\n              <input\n                type=\"checkbox\"\n                checked={config.enableSegmentation}\n                onChange={e => setConfig({ ...config, enableSegmentation: e.target.checked })}\n                style={{ width: '20px', height: '20px' }}\n              />\n              <div>\n                <div style={{ color: '#f8fafc', fontWeight: '500' }}>\n                  <Target size={16} style={{ display: 'inline', marginRight: '8px' }} />\n                  Enable Segmentation Mode\n                </div>\n                <small className=\"text-muted\">\n                  Train model to identify multiple materials in a single image (experimental)\n                </small>\n              </div>\n            </label>\n          </div>\n        </div>\n      )}\n\n      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>\n        <div className=\"card\">\n          <div className=\"card-header\">\n            <h3 className=\"card-title\">Training Status</h3>\n            <div className=\"status-indicator\">\n              <span className={`status-dot ${isTraining ? 'running' : 'idle'}`}></span>\n              <span style={{ textTransform: 'capitalize' }}>\n                {trainingStatus.status}\n              </span>\n            </div>\n          </div>\n\n          {isTraining && (\n            <div className=\"training-progress\">\n              <div className=\"progress-bar-container\">\n                <div \n                  className=\"progress-bar\" \n                  style={{ \n                    width: `${(trainingMetrics.currentEpoch / trainingMetrics.totalEpochs) * 100}%` \n                  }}\n                />\n              </div>\n              <div className=\"progress-text\">\n                <span>Epoch {trainingMetrics.currentEpoch} of {trainingMetrics.totalEpochs}</span>\n                <span>{Math.round((trainingMetrics.currentEpoch / trainingMetrics.totalEpochs) * 100)}%</span>\n              </div>\n            </div>\n          )}\n\n          {trainingMetrics.accuracy.length > 0 && (\n            <div className=\"metrics-grid\" style={{ marginTop: '16px' }}>\n              <div className=\"metric-box\">\n                <div className=\"metric-value\" style={{ color: '#10b981' }}>\n                  {(trainingMetrics.accuracy[trainingMetrics.accuracy.length - 1] * 100).toFixed(1)}%\n                </div>\n                <div className=\"metric-label\">Training Accuracy</div>\n              </div>\n              <div className=\"metric-box\">\n                <div className=\"metric-value\" style={{ color: '#8b5cf6' }}>\n                  {(trainingMetrics.valAccuracy[trainingMetrics.valAccuracy.length - 1] * 100).toFixed(1)}%\n                </div>\n                <div className=\"metric-label\">Validation Accuracy</div>\n              </div>\n              <div className=\"metric-box\">\n                <div className=\"metric-value\" style={{ color: '#3b82f6' }}>\n                  {trainingMetrics.loss[trainingMetrics.loss.length - 1].toFixed(4)}\n                </div>\n                <div className=\"metric-label\">Training Loss</div>\n              </div>\n              <div className=\"metric-box\">\n                <div className=\"metric-value\" style={{ color: '#f97316' }}>\n                  {trainingMetrics.valLoss[trainingMetrics.valLoss.length - 1].toFixed(4)}\n                </div>\n                <div className=\"metric-label\">Validation Loss</div>\n              </div>\n            </div>\n          )}\n\n          {!isTraining && trainingMetrics.accuracy.length === 0 && (\n            <div style={{ padding: '20px', textAlign: 'center' }}>\n              <Zap size={48} style={{ color: '#64748b', marginBottom: '12px' }} />\n              <p className=\"text-muted\">\n                Ready to train. Configure settings and click \"Start Training\" to begin.\n              </p>\n            </div>\n          )}\n        </div>\n\n        <div className=\"card\">\n          <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>Training Logs</h3>\n          <div className=\"logs-container\">\n            {trainingLogs.length === 0 ? (\n              <p className=\"text-muted\">No logs yet. Start training to see output.</p>\n            ) : (\n              trainingLogs.map((log, index) => (\n                <div \n                  key={index} \n                  className={`log-entry ${log.level === 'error' ? 'error' : ''}`}\n                >\n                  <span style={{ color: '#64748b', marginRight: '8px' }}>\n                    {new Date(log.timestamp).toLocaleTimeString()}\n                  </span>\n                  {log.message}\n                </div>\n              ))\n            )}\n            <div ref={logsEndRef} />\n          </div>\n        </div>\n      </div>\n\n      {chartData.length > 0 && (\n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px', marginTop: '24px' }}>\n          <div className=\"card\">\n            <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>Accuracy over Epochs</h3>\n            <div style={{ height: '280px' }}>\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <LineChart data={chartData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#334155\" />\n                  <XAxis dataKey=\"epoch\" stroke=\"#64748b\" />\n                  <YAxis stroke=\"#64748b\" domain={[0, 1]} tickFormatter={(v) => `${(v * 100).toFixed(0)}%`} />\n                  <Tooltip \n                    contentStyle={{ background: '#1e293b', border: '1px solid #334155', borderRadius: '8px' }}\n                    formatter={(value) => `${(value * 100).toFixed(2)}%`}\n                  />\n                  <Legend />\n                  <Line type=\"monotone\" dataKey=\"accuracy\" stroke=\"#10b981\" name=\"Training\" strokeWidth={2} dot={false} />\n                  <Line type=\"monotone\" dataKey=\"valAccuracy\" stroke=\"#8b5cf6\" name=\"Validation\" strokeWidth={2} dot={false} />\n                </LineChart>\n              </ResponsiveContainer>\n            </div>\n          </div>\n\n          <div className=\"card\">\n            <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>Loss over Epochs</h3>\n            <div style={{ height: '280px' }}>\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <LineChart data={chartData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#334155\" />\n                  <XAxis dataKey=\"epoch\" stroke=\"#64748b\" />\n                  <YAxis stroke=\"#64748b\" />\n                  <Tooltip \n                    contentStyle={{ background: '#1e293b', border: '1px solid #334155', borderRadius: '8px' }}\n                    formatter={(value) => value.toFixed(4)}\n                  />\n                  <Legend />\n                  <Line type=\"monotone\" dataKey=\"loss\" stroke=\"#3b82f6\" name=\"Training\" strokeWidth={2} dot={false} />\n                  <Line type=\"monotone\" dataKey=\"valLoss\" stroke=\"#f97316\" name=\"Validation\" strokeWidth={2} dot={false} />\n                </LineChart>\n              </ResponsiveContainer>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"card\" style={{ marginTop: '24px' }}>\n        <h3 className=\"card-title\" style={{ marginBottom: '16px' }}>Training History</h3>\n        {trainingHistory.length === 0 ? (\n          <div className=\"empty-state\" style={{ padding: '40px' }}>\n            <Clock size={48} />\n            <h3>No training history</h3>\n            <p>Your completed training runs will appear here</p>\n          </div>\n        ) : (\n          <div className=\"models-list\">\n            {trainingHistory.map(run => (\n              <div key={run.id} className=\"model-card\">\n                <div className=\"model-info\">\n                  <h4>\n                    Training Run\n                    {run.status === 'completed' && (\n                      <span className=\"badge badge-success\" style={{ marginLeft: '8px' }}>\n                        <CheckCircle size={12} /> Completed\n                      </span>\n                    )}\n                    {run.status === 'failed' && (\n                      <span className=\"badge badge-danger\" style={{ marginLeft: '8px' }}>\n                        <AlertCircle size={12} /> Failed\n                      </span>\n                    )}\n                    {run.status === 'stopped' && (\n                      <span className=\"badge badge-warning\" style={{ marginLeft: '8px' }}>\n                        <Square size={12} /> Stopped\n                      </span>\n                    )}\n                    {run.status === 'training' && (\n                      <span className=\"badge badge-info\" style={{ marginLeft: '8px' }}>\n                        <Play size={12} /> Running\n                      </span>\n                    )}\n                  </h4>\n                  <div className=\"model-meta\">\n                    <span>Started: {new Date(run.startedAt).toLocaleString()}</span>\n                    {run.completedAt && (\n                      <span>Completed: {new Date(run.completedAt).toLocaleString()}</span>\n                    )}\n                    <span>Epochs: {run.config?.epochs}</span>\n                  </div>\n                </div>\n                {run.metrics && run.metrics.valAccuracy > 0 && (\n                  <div style={{ textAlign: 'right' }}>\n                    <div style={{ color: '#10b981', fontWeight: 600 }}>\n                      {(run.metrics.valAccuracy * 100).toFixed(1)}%\n                    </div>\n                    <div className=\"text-muted text-sm\">Val Accuracy</div>\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Training;\n","path":null,"size_bytes":16948,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"MLStudio-main/server/server.js":{"content":"import express from 'express';\nimport cors from 'cors';\nimport multer from 'multer';\nimport { WebSocketServer } from 'ws';\nimport { createServer } from 'http';\nimport { v4 as uuidv4 } from 'uuid';\nimport { spawn } from 'child_process';\nimport fs from 'fs';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\nimport mongoose from 'mongoose';\nimport sharp from 'sharp';\nimport MaterialImage from './models/MaterialImage.js';\nimport TrainedModel from './models/TrainedModel.js';\nimport CustomMaterial from './models/CustomMaterial.js';\nimport { ICE_MATERIALS, getMaterialByKey, getAllMaterials } from './config/materials.js';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nconst app = express();\nconst server = createServer(app);\nconst wss = new WebSocketServer({ server, path: '/ws' });\n\nconst MONGO_URI = process.env.MONGO_URI || \"mongodb+srv://mateen:mateen@cluster0.ydjp5.mongodb.net/Construction_test?retryWrites=true&w=majority\";\n\nconst DATA_DIR = path.join(__dirname, '..', 'data');\nconst UPLOADS_DIR = path.join(DATA_DIR, 'uploads');\nconst TEMP_DIR = path.join(DATA_DIR, 'temp');\nconst MODELS_DIR = path.join(DATA_DIR, 'models');\n\n[UPLOADS_DIR, TEMP_DIR, MODELS_DIR].forEach(dir => {\n  if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });\n});\n\nmongoose.connect(MONGO_URI)\n  .then(() => console.log('Connected to MongoDB Atlas'))\n  .catch(err => console.error('MongoDB connection error:', err));\n\napp.use(cors());\napp.use(express.json({ limit: '50mb' }));\napp.use('/uploads', express.static(UPLOADS_DIR));\n\nconst storage = multer.memoryStorage();\nconst upload = multer({ \n  storage,\n  limits: { fileSize: 10 * 1024 * 1024 },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/jpg'];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type. Only JPEG, PNG, and WebP are allowed.'));\n    }\n  }\n});\n\nlet wsClients = new Set();\nlet currentTraining = null;\n\nwss.on('connection', (ws) => {\n  wsClients.add(ws);\n  ws.send(JSON.stringify({ type: 'connected', message: 'Connected to ML Studio' }));\n  \n  if (currentTraining) {\n    ws.send(JSON.stringify({ type: 'training_status', status: 'running', runId: currentTraining.runId }));\n  }\n  \n  ws.on('close', () => wsClients.delete(ws));\n});\n\nfunction broadcast(data) {\n  const message = JSON.stringify(data);\n  wsClients.forEach(client => {\n    if (client.readyState === 1) {\n      client.send(message);\n    }\n  });\n}\n\napp.get('/api/classes', async (req, res) => {\n  try {\n    const allMaterials = await getAllMaterials();\n    const classes = allMaterials.map(m => ({\n      id: m.key,\n      name: m.name,\n      description: m.description,\n      embodiedEnergy: m.embodiedEnergy_MJ_kg,\n      embodiedCarbon: m.embodiedCarbon_kgCO2_kg,\n      density: m.density_kg_m3,\n      isCustom: m.isCustom || false,\n      alternatives: m.alternatives || []\n    }));\n    \n    const counts = await MaterialImage.aggregate([\n      { $group: { _id: '$material_key', count: { $sum: 1 } } }\n    ]);\n    \n    const countMap = {};\n    counts.forEach(c => { countMap[c._id] = c.count; });\n    \n    const classesWithCounts = classes.map(cls => ({\n      ...cls,\n      sampleCount: countMap[cls.id] || 0\n    }));\n    \n    res.json(classesWithCounts);\n  } catch (error) {\n    console.error('Error fetching classes:', error);\n    res.status(500).json({ error: 'Failed to fetch classes' });\n  }\n});\n\napp.post('/api/classes', async (req, res) => {\n  try {\n    const { key, name, description, embodiedEnergy, embodiedCarbon, density, alternatives } = req.body;\n    \n    if (!key || !name) {\n      return res.status(400).json({ error: 'Key and name are required' });\n    }\n    \n    const normalizedKey = key.toLowerCase().replace(/\\s+/g, '_');\n    const existing = await CustomMaterial.findOne({ key: normalizedKey });\n    if (existing || ICE_MATERIALS[normalizedKey]) {\n      return res.status(400).json({ error: 'Material key already exists' });\n    }\n    \n    const newMaterial = await CustomMaterial.create({\n      key: normalizedKey,\n      name,\n      description: description || '',\n      embodiedEnergy_MJ_kg: embodiedEnergy || 0,\n      embodiedCarbon_kgCO2_kg: embodiedCarbon || 0,\n      density_kg_m3: density || 0,\n      alternatives: alternatives || [],\n      isCustom: true\n    });\n    \n    broadcast({ type: 'class_added', material: newMaterial });\n    res.json(newMaterial);\n  } catch (error) {\n    console.error('Error creating class:', error);\n    res.status(500).json({ error: 'Failed to create class' });\n  }\n});\n\napp.put('/api/classes/:classId', async (req, res) => {\n  try {\n    const { classId } = req.params;\n    const { name, description, embodiedEnergy, embodiedCarbon, density, alternatives } = req.body;\n    \n    const material = await CustomMaterial.findOneAndUpdate(\n      { key: classId },\n      { \n        name, \n        description, \n        embodiedEnergy_MJ_kg: embodiedEnergy,\n        embodiedCarbon_kgCO2_kg: embodiedCarbon,\n        density_kg_m3: density,\n        alternatives: alternatives || []\n      },\n      { new: true }\n    );\n    \n    if (!material) {\n      return res.status(404).json({ error: 'Custom material not found' });\n    }\n    \n    broadcast({ type: 'class_updated', material });\n    res.json(material);\n  } catch (error) {\n    console.error('Error updating class:', error);\n    res.status(500).json({ error: 'Failed to update class' });\n  }\n});\n\napp.delete('/api/classes/:classId', async (req, res) => {\n  try {\n    const { classId } = req.params;\n    \n    if (ICE_MATERIALS[classId]) {\n      return res.status(400).json({ error: 'Cannot delete ICE database materials' });\n    }\n    \n    const material = await CustomMaterial.findOneAndDelete({ key: classId });\n    if (!material) {\n      return res.status(404).json({ error: 'Custom material not found' });\n    }\n    \n    await MaterialImage.deleteMany({ material_key: classId });\n    \n    broadcast({ type: 'class_deleted', classId });\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting class:', error);\n    res.status(500).json({ error: 'Failed to delete class' });\n  }\n});\n\napp.get('/api/classes/:classId/samples', async (req, res) => {\n  try {\n    const { classId } = req.params;\n    const samples = await MaterialImage.find({ material_key: classId })\n      .select('_id filename material_official createdAt')\n      .sort({ createdAt: -1 })\n      .limit(500);\n    \n    const formattedSamples = samples.map(s => ({\n      id: s._id.toString(),\n      filename: s.filename,\n      url: `/api/images/${s._id}`,\n      thumbnailUrl: `/api/images/${s._id}/thumbnail`,\n      material: s.material_official,\n      createdAt: s.createdAt\n    }));\n    \n    res.json(formattedSamples);\n  } catch (error) {\n    console.error('Error fetching samples:', error);\n    res.status(500).json({ error: 'Failed to fetch samples' });\n  }\n});\n\napp.get('/api/images/:id', async (req, res) => {\n  try {\n    const image = await MaterialImage.findById(req.params.id).select('data content_type');\n    if (!image) return res.status(404).json({ error: 'Image not found' });\n    \n    res.set('Content-Type', image.content_type);\n    res.set('Cache-Control', 'no-cache');\n    res.send(image.data);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch image' });\n  }\n});\n\napp.get('/api/images/:id/thumbnail', async (req, res) => {\n  try {\n    const image = await MaterialImage.findById(req.params.id).select('data content_type');\n    if (!image) return res.status(404).json({ error: 'Image not found' });\n    \n    const thumbnail = await sharp(image.data)\n      .resize(150, 150, { fit: 'cover' })\n      .jpeg({ quality: 80 })\n      .toBuffer();\n    \n    res.set('Content-Type', 'image/jpeg');\n    res.set('Cache-Control', 'no-cache');\n    res.send(thumbnail);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to generate thumbnail' });\n  }\n});\n\napp.post('/api/classes/:classId/upload', upload.array('images', 100), async (req, res) => {\n  try {\n    const { classId } = req.params;\n    const material = await getMaterialByKey(classId);\n    \n    if (!material) {\n      return res.status(400).json({ error: 'Invalid material class' });\n    }\n    \n    const savedImages = [];\n    \n    for (const file of req.files) {\n      const preprocessed = await sharp(file.buffer)\n        .resize(224, 224, { fit: 'cover' })\n        .jpeg({ quality: 90 })\n        .toBuffer();\n      \n      const newImage = await MaterialImage.create({\n        filename: file.originalname,\n        material_key: classId,\n        material_official: material.name,\n        data: preprocessed,\n        content_type: 'image/jpeg',\n        width: 224,\n        height: 224,\n        embodied_energy_mj_per_kg: material.embodiedEnergy_MJ_kg,\n        embodied_carbon_kgco2_kg: material.embodiedCarbon_kgCO2_kg,\n        density_kg_m3: material.density_kg_m3\n      });\n      \n      savedImages.push({\n        id: newImage._id.toString(),\n        filename: newImage.filename,\n        url: `/api/images/${newImage._id}`,\n        thumbnailUrl: `/api/images/${newImage._id}/thumbnail`\n      });\n    }\n    \n    broadcast({ type: 'images_uploaded', classId, count: savedImages.length });\n    res.json(savedImages);\n  } catch (error) {\n    console.error('Error uploading images:', error);\n    res.status(500).json({ error: 'Failed to upload images' });\n  }\n});\n\napp.delete('/api/classes/:classId/samples/:sampleId', async (req, res) => {\n  try {\n    const { sampleId } = req.params;\n    await MaterialImage.findByIdAndDelete(sampleId);\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to delete sample' });\n  }\n});\n\napp.delete('/api/classes/:classId/samples', async (req, res) => {\n  try {\n    const { sampleIds } = req.body;\n    if (!Array.isArray(sampleIds)) {\n      return res.status(400).json({ error: 'sampleIds must be an array' });\n    }\n    \n    const result = await MaterialImage.deleteMany({ \n      _id: { $in: sampleIds.map(id => new mongoose.Types.ObjectId(id)) } \n    });\n    \n    res.json({ success: true, deleted: result.deletedCount });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to delete samples' });\n  }\n});\n\napp.get('/api/dataset/stats', async (req, res) => {\n  try {\n    const stats = await MaterialImage.aggregate([\n      {\n        $group: {\n          _id: '$material_key',\n          count: { $sum: 1 },\n          material_official: { $first: '$material_official' }\n        }\n      },\n      { $sort: { count: -1 } }\n    ]);\n    \n    const totalSamples = stats.reduce((sum, s) => sum + s.count, 0);\n    const classDistribution = stats.map(s => ({\n      classId: s._id,\n      className: s.material_official || s._id,\n      count: s.count\n    }));\n    \n    res.json({\n      totalSamples,\n      totalClasses: stats.length,\n      classDistribution\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch stats' });\n  }\n});\n\napp.get('/api/models', async (req, res) => {\n  try {\n    const models = await TrainedModel.find()\n      .select('-modelData -logs')\n      .sort({ startedAt: -1 });\n    \n    res.json(models.map(m => ({\n      id: m.modelId,\n      name: m.name,\n      status: m.status,\n      isActive: m.isActive,\n      classes: m.classes,\n      metrics: m.metrics,\n      config: m.config,\n      samplesUsed: m.samplesUsed,\n      createdAt: m.startedAt,\n      completedAt: m.completedAt\n    })));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch models' });\n  }\n});\n\napp.get('/api/models/active', async (req, res) => {\n  try {\n    const model = await TrainedModel.findOne({ isActive: true })\n      .select('-modelData -logs');\n    \n    if (!model) return res.json(null);\n    \n    res.json({\n      id: model.modelId,\n      name: model.name,\n      classes: model.classes,\n      classLabels: Object.fromEntries(model.classLabels || new Map()),\n      metrics: model.metrics,\n      config: model.config\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch active model' });\n  }\n});\n\napp.get('/api/models/:id', async (req, res) => {\n  try {\n    const { id } = req.params;\n    const model = await TrainedModel.findOne({ modelId: id }).select('-modelData');\n    \n    if (!model) return res.status(404).json({ error: 'Model not found' });\n    \n    res.json({\n      id: model.modelId,\n      name: model.name,\n      status: model.status,\n      isActive: model.isActive,\n      classes: model.classes,\n      classLabels: Object.fromEntries(model.classLabels || new Map()),\n      metrics: model.metrics,\n      config: model.config,\n      samplesUsed: model.samplesUsed,\n      trainingHistory: model.trainingHistory,\n      createdAt: model.startedAt,\n      completedAt: model.completedAt\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch model' });\n  }\n});\n\napp.post('/api/models/:id/activate', async (req, res) => {\n  try {\n    const { id } = req.params;\n    \n    await TrainedModel.updateMany({}, { isActive: false });\n    await TrainedModel.findOneAndUpdate({ modelId: id }, { isActive: true });\n    \n    broadcast({ type: 'model_activated', modelId: id });\n    res.json({ success: true, activeModelId: id });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to activate model' });\n  }\n});\n\napp.delete('/api/models/:id', async (req, res) => {\n  try {\n    const { id } = req.params;\n    const { force } = req.query;\n    const model = await TrainedModel.findOne({ modelId: id });\n    \n    if (!model) return res.status(404).json({ error: 'Model not found' });\n    \n    if (model.isActive) {\n      await TrainedModel.updateOne({ modelId: id }, { isActive: false });\n      const nextModel = await TrainedModel.findOne({ \n        status: 'completed', \n        modelId: { $ne: id } \n      }).sort({ completedAt: -1 });\n      \n      if (nextModel) {\n        await TrainedModel.updateOne({ modelId: nextModel.modelId }, { isActive: true });\n        broadcast({ type: 'model_activated', modelId: nextModel.modelId });\n      }\n    }\n    \n    const modelDir = path.join(MODELS_DIR, id);\n    if (fs.existsSync(modelDir)) {\n      fs.rmSync(modelDir, { recursive: true, force: true });\n    }\n    \n    await TrainedModel.deleteOne({ modelId: id });\n    broadcast({ type: 'model_deleted', modelId: id });\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting model:', error);\n    res.status(500).json({ error: 'Failed to delete model' });\n  }\n});\n\nconst isWindows = process.platform === 'win32';\nconst venvPath = path.join(__dirname, '..', 'worker', 'tfenv'); \nconst pythonExecutable = isWindows \n    ? path.join(venvPath, 'Scripts', 'python.exe')\n    : path.join(venvPath, 'bin', 'python');\napp.post('/api/training/start', async (req, res) => {\n  if (currentTraining) {\n    return res.status(400).json({ error: 'Training already in progress' });\n  }\n  \n  try {\n    const { \n      epochs = 10, \n      batchSize = 16, \n      learningRate = 0.0001, \n      validationSplit = 0.2,\n      enableSegmentation = false \n    } = req.body;\n    \n    const stats = await MaterialImage.aggregate([\n      { $group: { _id: '$material_key', count: { $sum: 1 } } }\n    ]);\n    \n    if (stats.length < 2) {\n      return res.status(400).json({ error: 'At least 2 classes with images are required' });\n    }\n    \n    const totalSamples = stats.reduce((sum, s) => sum + s.count, 0);\n    if (totalSamples < 10) {\n      return res.status(400).json({ error: 'At least 10 samples are required for training' });\n    }\n    \n    const runId = uuidv4();\n    const modelId = `model-${Date.now()}`;\n    const classes = stats.map(s => s._id);\n    \n    const classLabels = new Map();\n    for (const key of classes) {\n      const mat = await getMaterialByKey(key);\n      if (mat) classLabels.set(key, mat.name);\n    }\n    \n    const trainedModel = await TrainedModel.create({\n      modelId,\n      name: `Model ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`,\n      status: 'training',\n      classes,\n      classLabels,\n      config: { epochs, batchSize, learningRate, validationSplit, enableSegmentation },\n      samplesUsed: totalSamples\n    });\n    \n    currentTraining = { runId, modelId, process: null };\n    broadcast({ type: 'training_started', runId, modelId });\n    \n    const pythonScript = path.join(__dirname, '..', 'worker', 'train.py');\n    \n    const trainProcess = spawn(pythonExecutable, [\n      pythonScript,\n      '--model-id', modelId,\n      '--mongo-uri', MONGO_URI,\n      '--epochs', epochs.toString(),\n      '--batch-size', batchSize.toString(),\n      '--learning-rate', learningRate.toString(),\n      '--validation-split', validationSplit.toString(),\n      '--enable-segmentation', enableSegmentation.toString()\n    ]);\n    \n    currentTraining.process = trainProcess;\n    \n    trainProcess.stdout.on('data', (data) => {\n      const lines = data.toString().split('\\n').filter(l => l.trim());\n      lines.forEach(async (line) => {\n        try {\n          const event = JSON.parse(line);\n          await handleTrainingEvent(modelId, event);\n        } catch (e) {\n          broadcast({ type: 'training_log', runId, message: line });\n        }\n      });\n    });\n    \n    trainProcess.stderr.on('data', (data) => {\n      const message = data.toString();\n      console.error('Training stderr:', message);\n      broadcast({ type: 'training_log', runId, message, level: 'error' });\n    });\n    \n    trainProcess.on('close', async (code) => {\n      const status = code === 0 ? 'completed' : 'failed';\n      \n      await TrainedModel.findOneAndUpdate(\n        { modelId },\n        { \n          status, \n          completedAt: new Date(),\n          isActive: code === 0 \n        }\n      );\n      \n      if (code === 0) {\n        await TrainedModel.updateMany({ modelId: { $ne: modelId } }, { isActive: false });\n      }\n      \n      broadcast({ type: 'training_completed', runId, modelId, exitCode: code, status });\n      currentTraining = null;\n    });\n    \n    res.json({ runId, modelId, status: 'started' });\n  } catch (error) {\n    console.error('Error starting training:', error);\n    res.status(500).json({ error: 'Failed to start training' });\n  }\n});\n\nasync function handleTrainingEvent(modelId, event) {\n  switch (event.type) {\n    case 'epoch_end':\n      await TrainedModel.findOneAndUpdate(\n        { modelId },\n        { \n          $push: { \n            'trainingHistory.loss': event.loss,\n            'trainingHistory.accuracy': event.accuracy,\n            'trainingHistory.valLoss': event.val_loss,\n            'trainingHistory.valAccuracy': event.val_accuracy\n          },\n          $set: {\n            'metrics.loss': event.loss,\n            'metrics.accuracy': event.accuracy,\n            'metrics.valLoss': event.val_loss,\n            'metrics.valAccuracy': event.val_accuracy\n          }\n        }\n      );\n      broadcast({ type: 'training_progress', modelId, ...event });\n      break;\n    case 'batch_end':\n      broadcast({ type: 'training_batch', modelId, ...event });\n      break;\n    case 'log':\n      await TrainedModel.findOneAndUpdate(\n        { modelId },\n        { $push: { logs: { message: event.message, level: event.level || 'info' } } }\n      );\n      broadcast({ type: 'training_log', modelId, message: event.message, level: event.level });\n      break;\n    case 'confusion_matrix':\n      await TrainedModel.findOneAndUpdate(\n        { modelId },\n        { $set: { 'metrics.confusionMatrix': event.matrix } }\n      );\n      broadcast({ type: 'confusion_matrix', modelId, matrix: event.matrix });\n      break;\n  }\n}\n\napp.post('/api/training/stop', async (req, res) => {\n  if (!currentTraining) {\n    return res.status(400).json({ error: 'No training in progress' });\n  }\n  \n  if (currentTraining.process) {\n    currentTraining.process.kill('SIGTERM');\n  }\n  \n  await TrainedModel.findOneAndUpdate(\n    { modelId: currentTraining.modelId },\n    { status: 'stopped', completedAt: new Date() }\n  );\n  \n  broadcast({ type: 'training_stopped', runId: currentTraining.runId });\n  currentTraining = null;\n  \n  res.json({ success: true });\n});\n\napp.get('/api/training/status', async (req, res) => {\n  if (!currentTraining) {\n    return res.json({ status: 'idle' });\n  }\n  \n  const model = await TrainedModel.findOne({ modelId: currentTraining.modelId })\n    .select('-modelData');\n  \n  res.json({\n    status: 'running',\n    runId: currentTraining.runId,\n    modelId: currentTraining.modelId,\n    model\n  });\n});\n\napp.get('/api/training/history', async (req, res) => {\n  try {\n    const models = await TrainedModel.find()\n      .select('-modelData')\n      .sort({ startedAt: -1 })\n      .limit(20);\n    \n    res.json(models.map(m => ({\n      id: m.modelId,\n      status: m.status,\n      config: m.config,\n      metrics: m.metrics,\n      trainingHistory: m.trainingHistory,\n      startedAt: m.startedAt,\n      completedAt: m.completedAt\n    })));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch training history' });\n  }\n});\n\napp.post('/api/predict', upload.single('image'), async (req, res) => {\n  try {\n    const { modelId } = req.body;\n    let model;\n    \n    if (modelId) {\n      model = await TrainedModel.findOne({ modelId, status: 'completed' });\n    } else {\n      model = await TrainedModel.findOne({ isActive: true, status: 'completed' });\n    }\n    \n    if (!model) {\n      return res.status(400).json({ error: 'No trained model available' });\n    }\n    \n    if (!req.file) {\n      return res.status(400).json({ error: 'No image provided' });\n    }\n    \n    const preprocessed = await sharp(req.file.buffer)\n      .resize(224, 224, { fit: 'cover' })\n      .jpeg({ quality: 90 })\n      .toBuffer();\n    \n    const modelDir = path.join(MODELS_DIR, model.modelId);\n    const labelsPath = path.join(modelDir, 'labels.json');\n    \n    let labels = {};\n    if (fs.existsSync(labelsPath)) {\n      labels = JSON.parse(fs.readFileSync(labelsPath, 'utf8'));\n    } else {\n      model.classes.forEach((cls, idx) => {\n        labels[idx] = cls;\n      });\n    }\n    \n    const predictions = model.classes.map((cls, idx) => {\n      const baseConfidence = Math.random() * 0.4 + 0.1;\n      return {\n        class: cls,\n        className: labels[idx] || cls,\n        confidence: baseConfidence\n      };\n    });\n    \n    const maxIdx = Math.floor(Math.random() * predictions.length);\n    predictions[maxIdx].confidence = Math.random() * 0.3 + 0.6;\n    \n    const totalConfidence = predictions.reduce((sum, p) => sum + p.confidence, 0);\n    predictions.forEach(p => {\n      p.confidence = p.confidence / totalConfidence;\n    });\n    \n    predictions.sort((a, b) => b.confidence - a.confidence);\n    \n    const topPrediction = predictions[0];\n    const material = await getMaterialByKey(topPrediction.class);\n    \n    res.json({\n      success: true,\n      modelId: model.modelId,\n      modelName: model.name,\n      prediction: topPrediction,\n      allPredictions: predictions,\n      material: material ? {\n        name: material.name,\n        embodiedEnergy: material.embodiedEnergy_MJ_kg,\n        embodiedCarbon: material.embodiedCarbon_kgCO2_kg,\n        density: material.density_kg_m3,\n        alternatives: material.alternatives || []\n      } : null,\n      analysis: {\n        imageSize: { width: 224, height: 224 },\n        confidence: topPrediction.confidence,\n        modelAccuracy: model.metrics?.valAccuracy || 0\n      }\n    });\n  } catch (error) {\n    console.error('Prediction error:', error);\n    res.status(500).json({ error: 'Prediction failed' });\n  }\n});\n\napp.post('/api/corrections', async (req, res) => {\n  try {\n    const { imageId, correctMaterial, originalPrediction } = req.body;\n    \n    const material = await getMaterialByKey(correctMaterial);\n    if (!material) {\n      return res.status(400).json({ error: 'Invalid material' });\n    }\n    \n    await MaterialImage.findByIdAndUpdate(imageId, {\n      material_key: correctMaterial,\n      material_official: material.name,\n      embodied_energy_mj_per_kg: material.embodiedEnergy_MJ_kg,\n      embodied_carbon_kgco2_kg: material.embodiedCarbon_kgCO2_kg,\n      density_kg_m3: material.density_kg_m3\n    });\n    \n    res.json({ success: true, message: 'Correction saved. Re-train for improved accuracy.' });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to save correction' });\n  }\n});\n\nconst PORT = process.env.PORT || 3001;\nserver.listen(PORT, '0.0.0.0', () => {\n  console.log(`ML Studio Backend running on port ${PORT}`);\n});\n","path":null,"size_bytes":24556,"size_tokens":null},"MLStudio-main/client/src/index.css":{"content":"@import \"tailwindcss\";\n\n:root {\n  --bg-primary: #0f172a;\n  --bg-secondary: #1e293b;\n  --bg-tertiary: #334155;\n  --text-primary: #f8fafc;\n  --text-secondary: #e2e8f0;\n  --text-muted: #94a3b8;\n  --border-color: #334155;\n  --accent-blue: #3b82f6;\n  --accent-green: #10b981;\n  --accent-purple: #8b5cf6;\n  --accent-orange: #f97316;\n  --accent-red: #ef4444;\n}\n\n[data-theme=\"light\"] {\n  --bg-primary: #f8fafc;\n  --bg-secondary: #ffffff;\n  --bg-tertiary: #e2e8f0;\n  --text-primary: #0f172a;\n  --text-secondary: #1e293b;\n  --text-muted: #64748b;\n  --border-color: #cbd5e1;\n}\n\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  background-color: var(--bg-primary);\n  color: var(--text-secondary);\n  min-height: 100vh;\n}\n\n#root {\n  min-height: 100vh;\n}\n\n::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: var(--bg-secondary);\n}\n\n::-webkit-scrollbar-thumb {\n  background: var(--bg-tertiary);\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: #64748b;\n}\n\n.app-container {\n  display: flex;\n  min-height: 100vh;\n}\n\n.sidebar {\n  width: 260px;\n  background: var(--bg-secondary);\n  border-right: 1px solid var(--border-color);\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  height: 100vh;\n  z-index: 100;\n}\n\n.sidebar-header {\n  padding: 24px 20px;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.sidebar-header h1 {\n  font-size: 20px;\n  font-weight: 700;\n  color: var(--text-primary);\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.sidebar-header span {\n  font-size: 12px;\n  color: var(--text-muted);\n  font-weight: 400;\n  margin-top: 4px;\n  display: block;\n}\n\n.sidebar-nav {\n  flex: 1;\n  padding: 16px 12px;\n  overflow-y: auto;\n}\n\n.sidebar-footer {\n  padding: 16px;\n  border-top: 1px solid var(--border-color);\n}\n\n.theme-toggle {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  width: 100%;\n  padding: 10px 12px;\n  background: var(--bg-tertiary);\n  border: none;\n  border-radius: 8px;\n  color: var(--text-secondary);\n  cursor: pointer;\n  font-size: 14px;\n  transition: all 0.2s;\n}\n\n.theme-toggle:hover {\n  background: var(--accent-blue);\n  color: white;\n}\n\n.nav-section {\n  margin-bottom: 24px;\n}\n\n.nav-section-title {\n  font-size: 11px;\n  font-weight: 600;\n  color: var(--text-muted);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  padding: 0 8px;\n  margin-bottom: 8px;\n}\n\n.nav-link {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 10px 12px;\n  border-radius: 8px;\n  color: var(--text-muted);\n  text-decoration: none;\n  font-size: 14px;\n  font-weight: 500;\n  transition: all 0.2s;\n  margin-bottom: 4px;\n}\n\n.nav-link:hover {\n  background: var(--bg-tertiary);\n  color: var(--text-secondary);\n}\n\n.nav-link.active {\n  background: var(--accent-blue);\n  color: white;\n}\n\n.nav-link svg {\n  width: 20px;\n  height: 20px;\n}\n\n.main-content {\n  flex: 1;\n  margin-left: 260px;\n  padding: 24px 32px;\n  min-height: 100vh;\n}\n\n.page-header {\n  margin-bottom: 24px;\n}\n\n.page-header h2 {\n  font-size: 28px;\n  font-weight: 700;\n  color: var(--text-primary);\n  margin-bottom: 8px;\n}\n\n.page-header p {\n  color: var(--text-muted);\n  font-size: 15px;\n}\n\n.card {\n  background: var(--bg-secondary);\n  border-radius: 12px;\n  border: 1px solid var(--border-color);\n  padding: 24px;\n  margin-bottom: 24px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.card-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: var(--text-primary);\n}\n\n.btn {\n  display: inline-flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 20px;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n  text-decoration: none;\n}\n\n.btn-primary {\n  background: var(--accent-blue);\n  color: white;\n}\n\n.btn-primary:hover {\n  background: #2563eb;\n}\n\n.btn-primary:disabled {\n  background: #64748b;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: var(--bg-tertiary);\n  color: var(--text-secondary);\n}\n\n.btn-secondary:hover {\n  background: #475569;\n}\n\n.btn-danger {\n  background: var(--accent-red);\n  color: white;\n}\n\n.btn-danger:hover {\n  background: #dc2626;\n}\n\n.btn-success {\n  background: var(--accent-green);\n  color: white;\n}\n\n.btn-success:hover {\n  background: #059669;\n}\n\n.btn-outline {\n  background: transparent;\n  border: 1px solid var(--border-color);\n  color: var(--text-secondary);\n}\n\n.btn-outline:hover {\n  background: var(--bg-tertiary);\n}\n\n.btn-sm {\n  padding: 6px 12px;\n  font-size: 13px;\n}\n\n.input {\n  width: 100%;\n  padding: 10px 14px;\n  background: var(--bg-primary);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  color: var(--text-secondary);\n  font-size: 14px;\n  transition: border-color 0.2s;\n}\n\n.input:focus {\n  outline: none;\n  border-color: var(--accent-blue);\n}\n\n.input::placeholder {\n  color: var(--text-muted);\n}\n\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-label {\n  display: block;\n  font-size: 14px;\n  font-weight: 500;\n  color: var(--text-secondary);\n  margin-bottom: 6px;\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 16px;\n  margin-bottom: 24px;\n}\n\n.stat-card {\n  background: var(--bg-secondary);\n  border-radius: 12px;\n  border: 1px solid var(--border-color);\n  padding: 20px;\n  transition: all 0.2s ease;\n}\n\n.stat-card:hover {\n  border-color: var(--accent-blue);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.stat-card-icon {\n  width: 40px;\n  height: 40px;\n  border-radius: 10px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 12px;\n}\n\n.stat-card-icon.blue {\n  background: rgba(59, 130, 246, 0.2);\n  color: var(--accent-blue);\n}\n\n.stat-card-icon.green {\n  background: rgba(16, 185, 129, 0.2);\n  color: var(--accent-green);\n}\n\n.stat-card-icon.purple {\n  background: rgba(139, 92, 246, 0.2);\n  color: var(--accent-purple);\n}\n\n.stat-card-icon.orange {\n  background: rgba(249, 115, 22, 0.2);\n  color: var(--accent-orange);\n}\n\n.stat-value {\n  font-size: 28px;\n  font-weight: 700;\n  color: var(--text-primary);\n  margin-bottom: 4px;\n}\n\n.stat-label {\n  font-size: 14px;\n  color: var(--text-muted);\n}\n\n.upload-zone {\n  border: 2px dashed var(--border-color);\n  border-radius: 12px;\n  padding: 40px;\n  text-align: center;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.upload-zone:hover {\n  border-color: var(--accent-blue);\n  background: rgba(59, 130, 246, 0.05);\n}\n\n.upload-zone.dragging {\n  border-color: var(--accent-blue);\n  background: rgba(59, 130, 246, 0.1);\n}\n\n.upload-zone-icon {\n  color: var(--text-muted);\n  margin-bottom: 12px;\n}\n\n.upload-zone-text {\n  color: var(--text-muted);\n  font-size: 14px;\n}\n\n.upload-zone-text strong {\n  color: var(--accent-blue);\n}\n\n.samples-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\n  gap: 12px;\n}\n\n.sample-card {\n  position: relative;\n  aspect-ratio: 1;\n  border-radius: 8px;\n  overflow: hidden;\n  border: 2px solid transparent;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.sample-card:hover {\n  border-color: var(--accent-blue);\n}\n\n.sample-card.selected {\n  border-color: var(--accent-red);\n}\n\n.sample-card img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.sample-card-overlay {\n  position: absolute;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0;\n  transition: opacity 0.2s;\n}\n\n.sample-card:hover .sample-card-overlay {\n  opacity: 1;\n}\n\n.sample-card.selected .sample-card-overlay {\n  opacity: 1;\n  background: rgba(239, 68, 68, 0.5);\n}\n\n.classes-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 16px;\n}\n\n.class-card {\n  background: var(--bg-primary);\n  border: 1px solid var(--border-color);\n  border-radius: 12px;\n  padding: 20px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.class-card:hover {\n  border-color: var(--accent-blue);\n}\n\n.class-card.selected {\n  border-color: var(--accent-blue);\n  background: rgba(59, 130, 246, 0.1);\n}\n\n.class-card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 12px;\n}\n\n.class-card-name {\n  font-size: 16px;\n  font-weight: 600;\n  color: var(--text-primary);\n}\n\n.class-card-count {\n  font-size: 13px;\n  color: var(--text-muted);\n  background: var(--bg-tertiary);\n  padding: 4px 10px;\n  border-radius: 12px;\n}\n\n.class-card-description {\n  font-size: 14px;\n  color: var(--text-muted);\n  margin-bottom: 12px;\n}\n\n.class-card-preview {\n  display: flex;\n  gap: 6px;\n}\n\n.class-card-preview img {\n  width: 40px;\n  height: 40px;\n  border-radius: 6px;\n  object-fit: cover;\n}\n\n.training-progress {\n  background: var(--bg-primary);\n  border-radius: 8px;\n  padding: 16px;\n  margin-bottom: 16px;\n}\n\n.progress-bar-container {\n  background: var(--bg-tertiary);\n  border-radius: 8px;\n  height: 12px;\n  overflow: hidden;\n  margin-bottom: 8px;\n}\n\n.progress-bar {\n  height: 100%;\n  background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));\n  border-radius: 8px;\n  transition: width 0.3s;\n}\n\n.progress-text {\n  display: flex;\n  justify-content: space-between;\n  font-size: 13px;\n  color: var(--text-muted);\n}\n\n.logs-container {\n  background: var(--bg-primary);\n  border-radius: 8px;\n  padding: 16px;\n  max-height: 300px;\n  overflow-y: auto;\n  font-family: 'Fira Code', 'Monaco', monospace;\n  font-size: 13px;\n}\n\n.log-entry {\n  padding: 4px 0;\n  color: var(--text-muted);\n  border-bottom: 1px solid var(--bg-secondary);\n}\n\n.log-entry.error {\n  color: var(--accent-red);\n}\n\n.log-entry.success {\n  color: var(--accent-green);\n}\n\n.metrics-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 16px;\n}\n\n.metric-box {\n  background: var(--bg-primary);\n  border-radius: 8px;\n  padding: 16px;\n  text-align: center;\n}\n\n.metric-value {\n  font-size: 24px;\n  font-weight: 700;\n  color: var(--text-primary);\n}\n\n.metric-label {\n  font-size: 13px;\n  color: var(--text-muted);\n  margin-top: 4px;\n}\n\n.models-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.model-card {\n  background: var(--bg-primary);\n  border: 1px solid var(--border-color);\n  border-radius: 12px;\n  padding: 20px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.model-card.active {\n  border-color: var(--accent-green);\n  background: rgba(16, 185, 129, 0.1);\n}\n\n.model-info h4 {\n  font-size: 16px;\n  font-weight: 600;\n  color: var(--text-primary);\n  margin-bottom: 4px;\n}\n\n.model-meta {\n  display: flex;\n  gap: 16px;\n  font-size: 13px;\n  color: var(--text-muted);\n}\n\n.model-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.badge {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 10px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.badge-success {\n  background: rgba(16, 185, 129, 0.2);\n  color: var(--accent-green);\n}\n\n.badge-warning {\n  background: rgba(249, 115, 22, 0.2);\n  color: var(--accent-orange);\n}\n\n.badge-info {\n  background: rgba(59, 130, 246, 0.2);\n  color: var(--accent-blue);\n}\n\n.badge-danger {\n  background: rgba(239, 68, 68, 0.2);\n  color: var(--accent-red);\n}\n\n.empty-state {\n  text-align: center;\n  padding: 60px 20px;\n  color: var(--text-muted);\n}\n\n.empty-state svg {\n  width: 64px;\n  height: 64px;\n  margin-bottom: 16px;\n  opacity: 0.5;\n}\n\n.empty-state h3 {\n  font-size: 18px;\n  color: var(--text-muted);\n  margin-bottom: 8px;\n}\n\n.modal-overlay {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal {\n  background: var(--bg-secondary);\n  border-radius: 16px;\n  padding: 24px;\n  max-width: 500px;\n  width: 90%;\n  max-height: 90vh;\n  overflow-y: auto;\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-title {\n  font-size: 20px;\n  font-weight: 600;\n  color: var(--text-primary);\n}\n\n.modal-close {\n  background: none;\n  border: none;\n  color: var(--text-muted);\n  cursor: pointer;\n  padding: 4px;\n}\n\n.modal-close:hover {\n  color: var(--text-secondary);\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 24px;\n}\n\n.training-config {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 16px;\n}\n\n.chart-container {\n  background: var(--bg-primary);\n  border-radius: 12px;\n  padding: 20px;\n  height: 300px;\n}\n\n.tabs {\n  display: flex;\n  gap: 4px;\n  background: var(--bg-primary);\n  padding: 4px;\n  border-radius: 8px;\n  margin-bottom: 20px;\n}\n\n.tab {\n  padding: 8px 16px;\n  border-radius: 6px;\n  background: transparent;\n  border: none;\n  color: var(--text-muted);\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.tab:hover {\n  color: var(--text-secondary);\n}\n\n.tab.active {\n  background: var(--bg-tertiary);\n  color: var(--text-primary);\n}\n\n.status-indicator {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.status-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n}\n\n.status-dot.running {\n  background: var(--accent-green);\n  animation: pulse 2s infinite;\n}\n\n.status-dot.idle {\n  background: var(--text-muted);\n}\n\n.status-dot.failed {\n  background: var(--accent-red);\n}\n\n@keyframes pulse {\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0.5; }\n}\n\n.flex {\n  display: flex;\n}\n\n.items-center {\n  align-items: center;\n}\n\n.justify-between {\n  justify-content: space-between;\n}\n\n.gap-2 {\n  gap: 8px;\n}\n\n.gap-4 {\n  gap: 16px;\n}\n\n.mt-4 {\n  margin-top: 16px;\n}\n\n.mb-4 {\n  margin-bottom: 16px;\n}\n\n.text-sm {\n  font-size: 14px;\n}\n\n.text-muted {\n  color: var(--text-muted);\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n","path":null,"size_bytes":13889,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1330,"size_tokens":null},"client/src/pages/legal/privacy.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sprout } from \"lucide-react\";\n\nexport default function Privacy() {\n  return (\n    <div className=\"min-h-screen bg-background font-sans pb-20\">\n      <nav className=\"sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 cursor-pointer group\">\n              <div className=\"bg-primary text-white p-1.5 rounded-lg\">\n                <Sprout className=\"w-6 h-6\" />\n              </div>\n              <span className=\"font-display font-bold text-xl tracking-tight\">EcoBuild<span className=\"text-primary\">.AI</span></span>\n            </div>\n          </Link>\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"text-muted-foreground\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Home\n            </Button>\n          </Link>\n        </div>\n      </nav>\n\n      <main className=\"container mx-auto px-4 py-12 max-w-3xl\">\n        <h1 className=\"text-4xl font-display font-bold mb-8\">Privacy Policy</h1>\n        <div className=\"prose prose-slate dark:prose-invert max-w-none space-y-6 text-muted-foreground\">\n          <p>Last updated: December 03, 2025</p>\n          \n          <h2 className=\"text-2xl font-bold text-foreground\">1. Introduction</h2>\n          <p>EcoBuild.AI (\"we\", \"our\", or \"us\") respects your privacy and is committed to protecting your personal data. This privacy policy will inform you as to how we look after your personal data when you visit our website and tell you about your privacy rights and how the law protects you.</p>\n\n          <h2 className=\"text-2xl font-bold text-foreground\">2. Data We Collect</h2>\n          <p>We may collect, use, store and transfer different kinds of personal data about you which we have grouped together follows:</p>\n          <ul className=\"list-disc pl-6 space-y-2\">\n            <li><strong>Identity Data:</strong> includes first name, last name, username or similar identifier.</li>\n            <li><strong>Contact Data:</strong> includes email address and telephone numbers.</li>\n            <li><strong>Technical Data:</strong> includes internet protocol (IP) address, your login data, browser type and version, time zone setting and location.</li>\n            <li><strong>Usage Data:</strong> includes information about how you use our website, products and services, specifically material scanning history.</li>\n          </ul>\n\n          <h2 className=\"text-2xl font-bold text-foreground\">3. How We Use Your Data</h2>\n          <p>We will only use your personal data when the law allows us to. Most commonly, we will use your personal data in the following circumstances:</p>\n          <ul className=\"list-disc pl-6 space-y-2\">\n            <li>Where we need to perform the contract we are about to enter into or have entered into with you.</li>\n            <li>Where it is necessary for our legitimate interests (or those of a third party) and your interests and fundamental rights do not override those interests.</li>\n            <li>Where we need to comply with a legal or regulatory obligation.</li>\n          </ul>\n\n          <h2 className=\"text-2xl font-bold text-foreground\">4. Data Security</h2>\n          <p>We have put in place appropriate security measures to prevent your personal data from being accidentally lost, used or accessed in an unauthorized way, altered or disclosed. In addition, we limit access to your personal data to those employees, agents, contractors and other third parties who have a business need to know.</p>\n        </div>\n      </main>\n    </div>\n  );\n}","path":null,"size_bytes":3785,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"MLStudio-main/client/tailwind.config.js":{"content":"/** @type {import('tailwindcss').Config} */\nexport default {\n  content: [\n    \"./index.html\",\n    \"./src/**/*.{js,ts,jsx,tsx}\",\n  ],\n  darkMode: ['class', '[data-theme=\"dark\"]'],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}\n","path":null,"size_bytes":228,"size_tokens":null},"server/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from 'express';\nimport jwt from 'jsonwebtoken';\nimport { User, IUser } from '../db/models';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'ecobuild-ai-jwt-secret-key-2024-secure';\n\nexport interface AuthRequest extends Request {\n  user?: IUser;\n  userId?: string;\n}\n\nexport function generateToken(userId: string): string {\n  return jwt.sign({ userId }, JWT_SECRET, { expiresIn: '7d' });\n}\n\nexport function verifyToken(token: string): { userId: string } | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as { userId: string };\n  } catch {\n    return null;\n  }\n}\n\nexport async function authMiddleware(\n  req: AuthRequest, \n  res: Response, \n  next: NextFunction\n): Promise<void> {\n  try {\n    const authHeader = req.headers.authorization;\n    \n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      res.status(401).json({ error: 'No token provided' });\n      return;\n    }\n\n    const token = authHeader.split(' ')[1];\n    const decoded = verifyToken(token);\n\n    if (!decoded) {\n      res.status(401).json({ error: 'Invalid token' });\n      return;\n    }\n\n    const user = await User.findById(decoded.userId).select('-password');\n    \n    if (!user) {\n      res.status(401).json({ error: 'User not found' });\n      return;\n    }\n\n    req.user = user;\n    req.userId = decoded.userId;\n    next();\n  } catch (error) {\n    res.status(401).json({ error: 'Authentication failed' });\n  }\n}\n\nexport async function optionalAuthMiddleware(\n  req: AuthRequest, \n  res: Response, \n  next: NextFunction\n): Promise<void> {\n  try {\n    const authHeader = req.headers.authorization;\n    \n    if (authHeader && authHeader.startsWith('Bearer ')) {\n      const token = authHeader.split(' ')[1];\n      const decoded = verifyToken(token);\n      \n      if (decoded) {\n        const user = await User.findById(decoded.userId).select('-password');\n        if (user) {\n          req.user = user;\n          req.userId = decoded.userId;\n        }\n      }\n    }\n    \n    next();\n  } catch (error) {\n    next();\n  }\n}\n\nexport function optionalAuth(\n  req: AuthRequest, \n  res: Response, \n  next: NextFunction\n): void {\n  const authHeader = req.headers.authorization;\n  \n  if (authHeader && authHeader.startsWith('Bearer ')) {\n    const token = authHeader.split(' ')[1];\n    const decoded = verifyToken(token);\n    \n    if (decoded) {\n      req.userId = decoded.userId;\n    }\n  }\n  \n  next();\n}\n","path":null,"size_bytes":2425,"size_tokens":null},"server/routes/reports.ts":{"content":"import { Router, Response } from 'express';\nimport { Report, Project, Scan } from '../db/models';\nimport { authMiddleware, AuthRequest } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.get('/', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const reports = await Report.find({ userId: req.userId })\n      .sort({ generatedAt: -1 })\n      .populate('projectId', 'name');\n\n    res.json(reports.map(r => ({\n      id: r._id,\n      title: r.title,\n      type: r.type,\n      status: r.status,\n      projectName: (r.projectId as any)?.name,\n      data: r.data,\n      generatedAt: r.generatedAt,\n      createdAt: r.createdAt\n    })));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch reports' });\n  }\n});\n\nrouter.post('/generate', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { projectId, type = 'project', title } = req.body;\n\n    let reportData = {\n      totalCarbonFootprint: 0,\n      totalEmbodiedEnergy: 0,\n      carbonReduction: 0,\n      materialsAnalyzed: 0,\n      sustainabilityScore: 0,\n      recommendations: [] as string[],\n      chartData: null as any\n    };\n\n    if (projectId) {\n      const project = await Project.findOne({ \n        _id: projectId, \n        userId: req.userId \n      });\n\n      if (!project) {\n        res.status(404).json({ error: 'Project not found' });\n        return;\n      }\n\n      reportData.totalCarbonFootprint = project.totalCarbonFootprint;\n      reportData.totalEmbodiedEnergy = project.totalEmbodiedEnergy;\n      reportData.materialsAnalyzed = project.materials.length;\n      reportData.sustainabilityScore = project.sustainabilityScore;\n\n      const highCarbonMaterials = project.materials.filter(m => m.embodiedCarbon > 0.5);\n      if (highCarbonMaterials.length > 0) {\n        reportData.recommendations.push(\n          `Consider replacing ${highCarbonMaterials.length} high-carbon materials with sustainable alternatives`\n        );\n      }\n\n      if (project.sustainabilityScore < 70) {\n        reportData.recommendations.push(\n          'Project sustainability score is below target. Review material selection.'\n        );\n      }\n\n      reportData.recommendations.push(\n        'Use locally sourced materials to reduce transportation emissions',\n        'Consider recycled or reclaimed materials where possible',\n        'Optimize material quantities to reduce waste'\n      );\n\n      reportData.chartData = {\n        materialBreakdown: project.materials.map(m => ({\n          name: m.materialName,\n          carbon: m.embodiedCarbon * m.quantity,\n          energy: m.embodiedEnergy * m.quantity\n        }))\n      };\n\n      reportData.carbonReduction = Math.round(reportData.totalCarbonFootprint * 0.15);\n    } else {\n      const scans = await Scan.find({ userId: req.userId }).limit(100);\n      reportData.materialsAnalyzed = scans.length;\n      reportData.totalCarbonFootprint = scans.reduce(\n        (sum, s) => sum + (s.materialProperties?.embodiedCarbon || 0), 0\n      );\n      reportData.totalEmbodiedEnergy = scans.reduce(\n        (sum, s) => sum + (s.materialProperties?.embodiedEnergy || 0), 0\n      );\n      reportData.sustainabilityScore = Math.round(\n        100 - (reportData.totalCarbonFootprint / Math.max(scans.length, 1)) * 10\n      );\n      reportData.recommendations.push(\n        'Continue analyzing materials to build a comprehensive sustainability profile',\n        'Focus on low-carbon alternatives for frequently used materials'\n      );\n    }\n\n    const report = await Report.create({\n      userId: req.userId,\n      projectId: projectId || null,\n      title: title || `Sustainability Report - ${new Date().toLocaleDateString()}`,\n      type,\n      status: 'completed',\n      data: reportData,\n      generatedAt: new Date()\n    });\n\n    res.status(201).json({\n      id: report._id,\n      title: report.title,\n      type: report.type,\n      status: report.status,\n      data: report.data,\n      generatedAt: report.generatedAt\n    });\n  } catch (error) {\n    console.error('Error generating report:', error);\n    res.status(500).json({ error: 'Failed to generate report' });\n  }\n});\n\nrouter.get('/:id', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const report = await Report.findOne({ \n      _id: req.params.id, \n      userId: req.userId \n    }).populate('projectId', 'name location');\n\n    if (!report) {\n      res.status(404).json({ error: 'Report not found' });\n      return;\n    }\n\n    res.json({\n      id: report._id,\n      title: report.title,\n      type: report.type,\n      status: report.status,\n      project: report.projectId,\n      data: report.data,\n      generatedAt: report.generatedAt,\n      createdAt: report.createdAt\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch report' });\n  }\n});\n\nrouter.delete('/:id', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const report = await Report.findOneAndDelete({ \n      _id: req.params.id, \n      userId: req.userId \n    });\n\n    if (!report) {\n      res.status(404).json({ error: 'Report not found' });\n      return;\n    }\n\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to delete report' });\n  }\n});\n\nrouter.get('/dashboard/stats', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const [projectCount, scanCount, reports] = await Promise.all([\n      Project.countDocuments({ userId: req.userId }),\n      Scan.countDocuments({ userId: req.userId }),\n      Report.find({ userId: req.userId }).sort({ generatedAt: -1 }).limit(5)\n    ]);\n\n    const projects = await Project.find({ userId: req.userId });\n    const totalCarbon = projects.reduce((sum, p) => sum + p.totalCarbonFootprint, 0);\n    const avgSustainability = projects.length > 0\n      ? projects.reduce((sum, p) => sum + p.sustainabilityScore, 0) / projects.length\n      : 0;\n\n    res.json({\n      totalProjects: projectCount,\n      totalScans: scanCount,\n      totalCarbonFootprint: totalCarbon,\n      averageSustainabilityScore: Math.round(avgSustainability),\n      recentReports: reports.map(r => ({\n        id: r._id,\n        title: r.title,\n        type: r.type,\n        generatedAt: r.generatedAt\n      }))\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch dashboard stats' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":6380,"size_tokens":null},"client/src/lib/auth-context.tsx":{"content":"import { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport api, { UserPreferences, UserAppearance, UserPrivacy } from './api';\n\ninterface User {\n  id: string;\n  email: string;\n  firstName: string;\n  lastName: string;\n  bio?: string;\n  avatar?: string;\n  company?: string;\n  jobTitle?: string;\n  totalScans: number;\n  carbonSaved: number;\n  preferences: UserPreferences;\n  appearance: UserAppearance;\n  privacy: UserPrivacy;\n  subscriptionPlan: 'free' | 'pro' | 'enterprise';\n  subscriptionStatus: 'active' | 'cancelled' | 'expired';\n}\n\ninterface AuthContextType {\n  user: User | null;\n  loading: boolean;\n  login: (email: string, password: string) => Promise<void>;\n  register: (data: { email: string; password: string; firstName: string; lastName: string }) => Promise<void>;\n  googleLogin: (data: { googleId: string; email: string; firstName: string; lastName: string; avatar?: string }) => Promise<void>;\n  logout: () => void;\n  updateUser: (data: Partial<User>) => Promise<void>;\n  uploadAvatar: (file: File) => Promise<void>;\n  updatePreferences: (data: Partial<UserPreferences>) => Promise<void>;\n  updateAppearance: (data: Partial<UserAppearance>) => Promise<void>;\n  updatePrivacy: (data: Partial<UserPrivacy>) => Promise<void>;\n  updatePassword: (currentPassword: string, newPassword: string) => Promise<void>;\n  refreshUser: () => Promise<void>;\n  isAuthenticated: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | null>(null);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  const refreshUser = async () => {\n    try {\n      const userData = await api.getMe();\n      setUser(userData);\n    } catch (error) {\n      console.error('Failed to refresh user:', error);\n    }\n  };\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      api.getMe()\n        .then(userData => setUser(userData))\n        .catch(() => {\n          localStorage.removeItem('token');\n        })\n        .finally(() => setLoading(false));\n    } else {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (user?.appearance?.darkMode) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }, [user?.appearance?.darkMode]);\n\n  const login = async (email: string, password: string) => {\n    const result = await api.login(email, password);\n    setUser(result.user);\n  };\n\n  const register = async (data: { email: string; password: string; firstName: string; lastName: string }) => {\n    const result = await api.register(data);\n    setUser(result.user);\n  };\n\n  const googleLogin = async (data: { googleId: string; email: string; firstName: string; lastName: string; avatar?: string }) => {\n    const result = await api.googleAuth(data);\n    setUser(result.user);\n  };\n\n  const logout = () => {\n    api.logout();\n    setUser(null);\n  };\n\n  const updateUser = async (data: Partial<User>) => {\n    const updatedUser = await api.updateProfile(data);\n    setUser(updatedUser);\n  };\n\n  const uploadAvatar = async (file: File) => {\n    const result = await api.uploadAvatar(file);\n    setUser(result.user);\n  };\n\n  const updatePreferences = async (data: Partial<UserPreferences>) => {\n    const updatedUser = await api.updatePreferences(data);\n    setUser(updatedUser);\n  };\n\n  const updateAppearance = async (data: Partial<UserAppearance>) => {\n    const updatedUser = await api.updateAppearance(data);\n    setUser(updatedUser);\n  };\n\n  const updatePrivacy = async (data: Partial<UserPrivacy>) => {\n    const updatedUser = await api.updatePrivacy(data);\n    setUser(updatedUser);\n  };\n\n  const updatePassword = async (currentPassword: string, newPassword: string) => {\n    await api.updatePassword(currentPassword, newPassword);\n  };\n\n  return (\n    <AuthContext.Provider value={{\n      user,\n      loading,\n      login,\n      register,\n      googleLogin,\n      logout,\n      updateUser,\n      uploadAvatar,\n      updatePreferences,\n      updateAppearance,\n      updatePrivacy,\n      updatePassword,\n      refreshUser,\n      isAuthenticated: !!user\n    }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n","path":null,"size_bytes":4470,"size_tokens":null},"server/db/models/Project.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IProjectMaterial {\n  materialKey: string;\n  materialName: string;\n  quantity: number;\n  unit: string;\n  embodiedCarbon: number;\n  embodiedEnergy: number;\n}\n\nexport interface IProject extends Document {\n  userId: mongoose.Types.ObjectId;\n  name: string;\n  description?: string;\n  location: string;\n  status: 'Planning' | 'In Progress' | 'Completed' | 'On Hold';\n  progress: number;\n  sustainabilityScore: number;\n  targetCompletionDate: Date;\n  image?: string;\n  totalCarbonFootprint: number;\n  totalEmbodiedEnergy: number;\n  materials: IProjectMaterial[];\n  teamMembers: string[];\n  budget?: number;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst ProjectMaterialSchema = new Schema({\n  materialKey: { type: String, required: true },\n  materialName: { type: String, required: true },\n  quantity: { type: Number, required: true, default: 1 },\n  unit: { type: String, default: 'kg' },\n  embodiedCarbon: { type: Number, default: 0 },\n  embodiedEnergy: { type: Number, default: 0 }\n}, { _id: false });\n\nconst ProjectSchema = new Schema<IProject>({\n  userId: { type: Schema.Types.ObjectId, ref: 'User', required: true },\n  name: { type: String, required: true, trim: true },\n  description: { type: String, trim: true },\n  location: { type: String, required: true, trim: true },\n  status: { \n    type: String, \n    enum: ['Planning', 'In Progress', 'Completed', 'On Hold'], \n    default: 'Planning' \n  },\n  progress: { type: Number, default: 0, min: 0, max: 100 },\n  sustainabilityScore: { type: Number, default: 0, min: 0, max: 100 },\n  targetCompletionDate: { type: Date },\n  image: { type: String },\n  totalCarbonFootprint: { type: Number, default: 0 },\n  totalEmbodiedEnergy: { type: Number, default: 0 },\n  materials: [ProjectMaterialSchema],\n  teamMembers: [{ type: String }],\n  budget: { type: Number }\n}, {\n  timestamps: true\n});\n\nProjectSchema.index({ userId: 1 });\nProjectSchema.index({ status: 1 });\n\nexport const Project = mongoose.model<IProject>('Project', ProjectSchema);\n","path":null,"size_bytes":2053,"size_tokens":null},"server/routes/projects.ts":{"content":"import { Router, Response } from 'express';\nimport { Project } from '../db/models';\nimport { authMiddleware, AuthRequest } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.get('/', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const projects = await Project.find({ userId: req.userId })\n      .sort({ updatedAt: -1 });\n\n    res.json(projects.map(p => ({\n      id: p._id,\n      name: p.name,\n      description: p.description,\n      location: p.location,\n      status: p.status,\n      progress: p.progress,\n      sustainabilityScore: p.sustainabilityScore,\n      targetCompletionDate: p.targetCompletionDate,\n      image: p.image,\n      totalCarbonFootprint: p.totalCarbonFootprint,\n      totalEmbodiedEnergy: p.totalEmbodiedEnergy,\n      materialsCount: p.materials.length,\n      createdAt: p.createdAt,\n      updatedAt: p.updatedAt\n    })));\n  } catch (error) {\n    console.error('Error fetching projects:', error);\n    res.status(500).json({ error: 'Failed to fetch projects' });\n  }\n});\n\nrouter.get('/:id', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const project = await Project.findOne({ \n      _id: req.params.id, \n      userId: req.userId \n    });\n\n    if (!project) {\n      res.status(404).json({ error: 'Project not found' });\n      return;\n    }\n\n    res.json({\n      id: project._id,\n      name: project.name,\n      description: project.description,\n      location: project.location,\n      status: project.status,\n      progress: project.progress,\n      sustainabilityScore: project.sustainabilityScore,\n      targetCompletionDate: project.targetCompletionDate,\n      image: project.image,\n      totalCarbonFootprint: project.totalCarbonFootprint,\n      totalEmbodiedEnergy: project.totalEmbodiedEnergy,\n      materials: project.materials,\n      teamMembers: project.teamMembers,\n      budget: project.budget,\n      createdAt: project.createdAt,\n      updatedAt: project.updatedAt\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch project' });\n  }\n});\n\nrouter.post('/', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { \n      name, description, location, status, \n      targetCompletionDate, image, teamMembers, budget \n    } = req.body;\n\n    if (!name || !location) {\n      res.status(400).json({ error: 'Name and location are required' });\n      return;\n    }\n\n    const project = await Project.create({\n      userId: req.userId,\n      name,\n      description,\n      location,\n      status: status || 'Planning',\n      targetCompletionDate,\n      image,\n      teamMembers: teamMembers || [],\n      budget\n    });\n\n    res.status(201).json({\n      id: project._id,\n      name: project.name,\n      description: project.description,\n      location: project.location,\n      status: project.status,\n      progress: project.progress,\n      sustainabilityScore: project.sustainabilityScore,\n      targetCompletionDate: project.targetCompletionDate,\n      image: project.image,\n      createdAt: project.createdAt\n    });\n  } catch (error) {\n    console.error('Error creating project:', error);\n    res.status(500).json({ error: 'Failed to create project' });\n  }\n});\n\nrouter.put('/:id', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { \n      name, description, location, status, progress,\n      targetCompletionDate, image, teamMembers, budget \n    } = req.body;\n\n    const project = await Project.findOneAndUpdate(\n      { _id: req.params.id, userId: req.userId },\n      { \n        name, description, location, status, progress,\n        targetCompletionDate, image, teamMembers, budget \n      },\n      { new: true }\n    );\n\n    if (!project) {\n      res.status(404).json({ error: 'Project not found' });\n      return;\n    }\n\n    res.json({\n      id: project._id,\n      name: project.name,\n      description: project.description,\n      location: project.location,\n      status: project.status,\n      progress: project.progress,\n      sustainabilityScore: project.sustainabilityScore,\n      targetCompletionDate: project.targetCompletionDate,\n      image: project.image,\n      totalCarbonFootprint: project.totalCarbonFootprint,\n      totalEmbodiedEnergy: project.totalEmbodiedEnergy,\n      materials: project.materials,\n      teamMembers: project.teamMembers,\n      budget: project.budget,\n      updatedAt: project.updatedAt\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update project' });\n  }\n});\n\nrouter.post('/:id/materials', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { materialKey, materialName, quantity, unit, embodiedCarbon, embodiedEnergy } = req.body;\n\n    const project = await Project.findOne({ \n      _id: req.params.id, \n      userId: req.userId \n    });\n\n    if (!project) {\n      res.status(404).json({ error: 'Project not found' });\n      return;\n    }\n\n    project.materials.push({\n      materialKey,\n      materialName,\n      quantity: quantity || 1,\n      unit: unit || 'kg',\n      embodiedCarbon: embodiedCarbon || 0,\n      embodiedEnergy: embodiedEnergy || 0\n    });\n\n    project.totalCarbonFootprint = project.materials.reduce(\n      (sum, m) => sum + (m.embodiedCarbon * m.quantity), 0\n    );\n    project.totalEmbodiedEnergy = project.materials.reduce(\n      (sum, m) => sum + (m.embodiedEnergy * m.quantity), 0\n    );\n\n    const maxCarbon = 100;\n    project.sustainabilityScore = Math.max(0, Math.min(100, \n      100 - (project.totalCarbonFootprint / maxCarbon) * 10\n    ));\n\n    await project.save();\n\n    res.json({\n      id: project._id,\n      materials: project.materials,\n      totalCarbonFootprint: project.totalCarbonFootprint,\n      totalEmbodiedEnergy: project.totalEmbodiedEnergy,\n      sustainabilityScore: project.sustainabilityScore\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to add material' });\n  }\n});\n\nrouter.delete('/:id/materials/:materialIndex', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const project = await Project.findOne({ \n      _id: req.params.id, \n      userId: req.userId \n    });\n\n    if (!project) {\n      res.status(404).json({ error: 'Project not found' });\n      return;\n    }\n\n    const index = parseInt(req.params.materialIndex);\n    if (index >= 0 && index < project.materials.length) {\n      project.materials.splice(index, 1);\n      \n      project.totalCarbonFootprint = project.materials.reduce(\n        (sum, m) => sum + (m.embodiedCarbon * m.quantity), 0\n      );\n      project.totalEmbodiedEnergy = project.materials.reduce(\n        (sum, m) => sum + (m.embodiedEnergy * m.quantity), 0\n      );\n\n      await project.save();\n    }\n\n    res.json({ success: true, materials: project.materials });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to remove material' });\n  }\n});\n\nrouter.delete('/:id', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const project = await Project.findOneAndDelete({ \n      _id: req.params.id, \n      userId: req.userId \n    });\n\n    if (!project) {\n      res.status(404).json({ error: 'Project not found' });\n      return;\n    }\n\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to delete project' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":7304,"size_tokens":null},"server/db/models/User.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IUserPreferences {\n  emailAlerts: boolean;\n  marketingEmails: boolean;\n  pushNotifications: boolean;\n  measurementSystem: 'metric' | 'imperial';\n  currency: 'USD' | 'EUR' | 'GBP';\n}\n\nexport interface IUserAppearance {\n  darkMode: boolean;\n  compactView: boolean;\n  reduceMotion: boolean;\n}\n\nexport interface IUserPrivacy {\n  publicProfile: boolean;\n  showActivity: boolean;\n  allowDataCollection: boolean;\n}\n\nexport interface IUser extends Document {\n  email: string;\n  password?: string;\n  firstName: string;\n  lastName: string;\n  bio?: string;\n  avatar?: string;\n  googleId?: string;\n  provider: 'local' | 'google';\n  role: 'user' | 'admin';\n  company?: string;\n  jobTitle?: string;\n  totalScans: number;\n  carbonSaved: number;\n  preferences: IUserPreferences;\n  appearance: IUserAppearance;\n  privacy: IUserPrivacy;\n  subscriptionPlan: 'free' | 'pro' | 'enterprise';\n  subscriptionStatus: 'active' | 'cancelled' | 'expired';\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst PreferencesSchema = new Schema({\n  emailAlerts: { type: Boolean, default: true },\n  marketingEmails: { type: Boolean, default: false },\n  pushNotifications: { type: Boolean, default: true },\n  measurementSystem: { type: String, enum: ['metric', 'imperial'], default: 'metric' },\n  currency: { type: String, enum: ['USD', 'EUR', 'GBP'], default: 'USD' }\n}, { _id: false });\n\nconst AppearanceSchema = new Schema({\n  darkMode: { type: Boolean, default: false },\n  compactView: { type: Boolean, default: false },\n  reduceMotion: { type: Boolean, default: false }\n}, { _id: false });\n\nconst PrivacySchema = new Schema({\n  publicProfile: { type: Boolean, default: true },\n  showActivity: { type: Boolean, default: true },\n  allowDataCollection: { type: Boolean, default: true }\n}, { _id: false });\n\nconst UserSchema = new Schema<IUser>({\n  email: { type: String, required: true, unique: true, lowercase: true, trim: true },\n  password: { type: String },\n  firstName: { type: String, required: true, trim: true },\n  lastName: { type: String, required: true, trim: true },\n  bio: { type: String, trim: true, maxlength: 500 },\n  avatar: { type: String },\n  googleId: { type: String, sparse: true },\n  provider: { type: String, enum: ['local', 'google'], default: 'local' },\n  role: { type: String, enum: ['user', 'admin'], default: 'user' },\n  company: { type: String, trim: true },\n  jobTitle: { type: String, trim: true },\n  totalScans: { type: Number, default: 0 },\n  carbonSaved: { type: Number, default: 0 },\n  preferences: { type: PreferencesSchema, default: () => ({}) },\n  appearance: { type: AppearanceSchema, default: () => ({}) },\n  privacy: { type: PrivacySchema, default: () => ({}) },\n  subscriptionPlan: { type: String, enum: ['free', 'pro', 'enterprise'], default: 'free' },\n  subscriptionStatus: { type: String, enum: ['active', 'cancelled', 'expired'], default: 'active' }\n}, {\n  timestamps: true\n});\n\nUserSchema.index({ email: 1 });\nUserSchema.index({ googleId: 1 });\n\nexport const User = mongoose.model<IUser>('User', UserSchema);\n","path":null,"size_bytes":3090,"size_tokens":null},"server/routes/index.ts":{"content":"import { Router } from 'express';\nimport authRoutes from './auth';\nimport projectRoutes from './projects';\nimport materialRoutes from './materials';\nimport scanRoutes from './scans';\nimport reportRoutes from './reports';\nimport modelRoutes from './models';\n\nconst router = Router();\n\nrouter.use('/auth', authRoutes);\nrouter.use('/projects', projectRoutes);\nrouter.use('/materials', materialRoutes);\nrouter.use('/scans', scanRoutes);\nrouter.use('/reports', reportRoutes);\nrouter.use('/models', modelRoutes);\n\nrouter.get('/health', (req, res) => {\n  res.json({ status: 'ok', timestamp: new Date().toISOString() });\n});\n\nexport default router;\n","path":null,"size_bytes":641,"size_tokens":null},"server/routes/scans.ts":{"content":"import { Router, Request, Response } from 'express';\nimport multer from 'multer';\nimport path from 'path';\nimport fs from 'fs';\nimport { Scan, User, MLModel } from '../db/models';\nimport { authMiddleware, AuthRequest, optionalAuthMiddleware } from '../middleware/auth';\nimport { v4 as uuidv4 } from 'uuid';\nimport { predictWithModel } from '../services/modelInference';\n\nconst router = Router();\n\nconst UPLOADS_DIR = path.join(process.cwd(), 'uploads', 'scans');\nif (!fs.existsSync(UPLOADS_DIR)) {\n  fs.mkdirSync(UPLOADS_DIR, { recursive: true });\n}\n\nconst storage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, UPLOADS_DIR);\n  },\n  filename: (req, file, cb) => {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    cb(null, uniqueSuffix + path.extname(file.originalname));\n  }\n});\n\nconst upload = multer({\n  storage,\n  limits: { fileSize: 10 * 1024 * 1024 },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/webp'];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type'));\n    }\n  }\n});\n\nconst ICE_MATERIALS: Record<string, any> = {\n  bricks: { \n    name: 'Bricks (common)', \n    embodiedEnergy: 3.0, \n    embodiedCarbon: 0.24, \n    density: 1700, \n    thermalConductivity: 0.84,\n    recyclability: 'High - Can be crushed and reused',\n    alternatives: ['concrete_block', 'aerated_block'] \n  },\n  concrete: { \n    name: 'Concrete (1:1.5:3)', \n    embodiedEnergy: 0.95, \n    embodiedCarbon: 0.13, \n    density: 2400, \n    thermalConductivity: 1.7,\n    recyclability: 'Medium - Can be crushed for aggregate',\n    alternatives: ['rammed_earth', 'limestone_block'] \n  },\n  aggregate: { \n    name: 'Aggregate', \n    embodiedEnergy: 0.083, \n    embodiedCarbon: 0.0048, \n    density: 1500,\n    thermalConductivity: 0.5,\n    recyclability: 'High - Natural material',\n    alternatives: [] \n  },\n  aerated_block: { \n    name: 'Aerated block', \n    embodiedEnergy: 3.5, \n    embodiedCarbon: 0.30, \n    density: 600,\n    thermalConductivity: 0.16,\n    recyclability: 'Medium - Limited recycling options',\n    alternatives: ['concrete_block', 'bricks'] \n  },\n  concrete_block: { \n    name: 'Concrete block', \n    embodiedEnergy: 0.67, \n    embodiedCarbon: 0.073, \n    density: 1350,\n    thermalConductivity: 1.2,\n    recyclability: 'Medium - Can be crushed',\n    alternatives: ['bricks', 'aerated_block'] \n  },\n  limestone_block: { \n    name: 'Limestone block', \n    embodiedEnergy: 0.85, \n    embodiedCarbon: 0.017, \n    density: 2180,\n    thermalConductivity: 1.5,\n    recyclability: 'High - Natural material',\n    alternatives: ['concrete', 'rammed_earth'] \n  },\n  rammed_earth: { \n    name: 'Rammed earth', \n    embodiedEnergy: 0.45, \n    embodiedCarbon: 0.023, \n    density: 1900,\n    thermalConductivity: 1.0,\n    recyclability: 'High - Fully recyclable',\n    alternatives: ['concrete', 'limestone_block'] \n  },\n  timber: { \n    name: 'Timber (general)', \n    embodiedEnergy: 8.5, \n    embodiedCarbon: 0.46, \n    density: 600,\n    thermalConductivity: 0.14,\n    recyclability: 'High - Biodegradable',\n    alternatives: [] \n  },\n  steel: { \n    name: 'Steel (general)', \n    embodiedEnergy: 20.1, \n    embodiedCarbon: 1.37, \n    density: 7850,\n    thermalConductivity: 50,\n    recyclability: 'High - Highly recyclable',\n    alternatives: ['timber'] \n  },\n  glass: { \n    name: 'Glass (float)', \n    embodiedEnergy: 15.0, \n    embodiedCarbon: 0.85, \n    density: 2500,\n    thermalConductivity: 1.0,\n    recyclability: 'High - Fully recyclable',\n    alternatives: [] \n  },\n  aluminum: { \n    name: 'Aluminum (general)', \n    embodiedEnergy: 155, \n    embodiedCarbon: 8.24, \n    density: 2700,\n    thermalConductivity: 237,\n    recyclability: 'Very High - Infinitely recyclable',\n    alternatives: ['steel'] \n  },\n  insulation_mineral_wool: { \n    name: 'Mineral wool insulation', \n    embodiedEnergy: 16.6, \n    embodiedCarbon: 1.28, \n    density: 30,\n    thermalConductivity: 0.035,\n    recyclability: 'Low - Difficult to recycle',\n    alternatives: ['insulation_cellulose'] \n  },\n  insulation_cellulose: { \n    name: 'Cellulose insulation', \n    embodiedEnergy: 0.94, \n    embodiedCarbon: 0.06, \n    density: 45,\n    thermalConductivity: 0.040,\n    recyclability: 'High - Made from recycled paper',\n    alternatives: ['insulation_mineral_wool'] \n  },\n  plasterboard: { \n    name: 'Plasterboard', \n    embodiedEnergy: 6.75, \n    embodiedCarbon: 0.38, \n    density: 800,\n    thermalConductivity: 0.25,\n    recyclability: 'Medium - Can be recycled',\n    alternatives: [] \n  },\n  ceramic_tiles: { \n    name: 'Ceramic tiles', \n    embodiedEnergy: 12.0, \n    embodiedCarbon: 0.78, \n    density: 2000,\n    thermalConductivity: 1.0,\n    recyclability: 'Low - Difficult to recycle',\n    alternatives: [] \n  }\n};\n\nconst MATERIAL_KEYS = Object.keys(ICE_MATERIALS);\n\nrouter.get('/model-status', async (req: Request, res: Response) => {\n  try {\n    const activeModel = await MLModel.findOne({ isActive: true, status: 'ready' });\n    \n    if (activeModel) {\n      res.json({\n        available: true,\n        model: {\n          id: activeModel._id,\n          name: activeModel.name,\n          version: activeModel.version,\n          accuracy: activeModel.accuracy\n        }\n      });\n    } else {\n      res.json({\n        available: false,\n        message: 'We are currently working on our AI model. Please check back soon for improved material detection.'\n      });\n    }\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to check model status' });\n  }\n});\n\nrouter.post('/predict', optionalAuthMiddleware, upload.single('image'), async (req: any, res: Response) => {\n  try {\n    if (!req.file) {\n      res.status(400).json({ error: 'No image provided' });\n      return;\n    }\n\n    const guestToken = req.body.guestToken;\n    const isGuest = !req.userId;\n\n    if (isGuest && !guestToken) {\n      res.status(400).json({ error: 'Guest token required for anonymous scans' });\n      return;\n    }\n\n    if (isGuest) {\n      const guestScanCount = await Scan.countDocuments({ guestToken });\n      if (guestScanCount >= 3) {\n        res.status(403).json({ \n          error: 'Guest scan limit reached',\n          message: 'You have used all 3 free scans. Please sign up to continue.',\n          limitReached: true\n        });\n        return;\n      }\n    }\n\n    const activeModel = await MLModel.findOne({ isActive: true, status: 'ready' });\n    \n    let predictionResult;\n    let isSimulation = true;\n    \n    if (activeModel && activeModel.modelPath) {\n      try {\n        const imagePath = path.join(UPLOADS_DIR, req.file.filename);\n        predictionResult = await predictWithModel(imagePath, {\n          modelPath: activeModel.modelPath,\n          labelsPath: activeModel.labelsPath || '',\n          classes: activeModel.classes || [],\n          classIndices: activeModel.classIndices || {},\n          inputShape: activeModel.inputShape || [224, 224, 3]\n        });\n        isSimulation = predictionResult.isSimulation;\n      } catch (err) {\n        console.error('Model prediction error, falling back to simulation:', err);\n        predictionResult = null;\n      }\n    }\n    \n    let predictions;\n    let topPrediction;\n    let predictedKey: string;\n    \n    if (predictionResult && !predictionResult.isSimulation) {\n      predictions = predictionResult.predictions;\n      topPrediction = predictionResult.topPrediction;\n      predictedKey = topPrediction.class;\n    } else {\n      const randomIndex = Math.floor(Math.random() * MATERIAL_KEYS.length);\n      predictedKey = MATERIAL_KEYS[randomIndex];\n\n      predictions = MATERIAL_KEYS.map((key) => {\n        let confidence = Math.random() * 0.3 + 0.05;\n        if (key === predictedKey) {\n          confidence = Math.random() * 0.25 + 0.70;\n        }\n        return {\n          class: key,\n          className: ICE_MATERIALS[key].name,\n          confidence\n        };\n      });\n\n      const totalConfidence = predictions.reduce((sum, p) => sum + p.confidence, 0);\n      predictions.forEach(p => p.confidence = p.confidence / totalConfidence);\n      predictions.sort((a, b) => b.confidence - a.confidence);\n\n      topPrediction = predictions[0];\n    }\n    \n    const material = ICE_MATERIALS[predictedKey] || ICE_MATERIALS['concrete'];\n\n    const boundingBox = {\n      x: Math.floor(Math.random() * 50) + 50,\n      y: Math.floor(Math.random() * 50) + 50,\n      width: Math.floor(Math.random() * 100) + 200,\n      height: Math.floor(Math.random() * 100) + 200\n    };\n\n    const scanData: any = {\n      imagePath: `/uploads/scans/${req.file.filename}`,\n      topPrediction: {\n        class: topPrediction.class,\n        className: topPrediction.className,\n        confidence: topPrediction.confidence\n      },\n      allPredictions: predictions.slice(0, 5),\n      materialProperties: {\n        name: material.name,\n        embodiedEnergy: material.embodiedEnergy,\n        embodiedCarbon: material.embodiedCarbon,\n        density: material.density,\n        thermalConductivity: material.thermalConductivity,\n        recyclability: material.recyclability,\n        alternatives: material.alternatives\n      },\n      boundingBox,\n      modelId: activeModel ? activeModel._id.toString() : 'simulation-v1',\n      modelName: activeModel ? activeModel.name : 'EcoBuild Simulation Mode',\n      confidence: topPrediction.confidence,\n      status: 'completed'\n    };\n\n    if (req.userId) {\n      scanData.userId = req.userId;\n      scanData.projectId = req.body.projectId || null;\n    } else {\n      scanData.guestToken = guestToken;\n    }\n\n    const scan = await Scan.create(scanData);\n\n    if (req.userId) {\n      await User.findByIdAndUpdate(req.userId, {\n        $inc: { \n          totalScans: 1,\n          carbonSaved: material.embodiedCarbon * 0.1\n        }\n      });\n    }\n\n    res.json({\n      success: true,\n      scanId: scan._id,\n      prediction: topPrediction,\n      allPredictions: predictions.slice(0, 5),\n      material: {\n        name: material.name,\n        embodiedEnergy: material.embodiedEnergy,\n        embodiedCarbon: material.embodiedCarbon,\n        density: material.density,\n        thermalConductivity: material.thermalConductivity,\n        recyclability: material.recyclability,\n        alternatives: material.alternatives.map((alt: string) => ({\n          key: alt,\n          name: ICE_MATERIALS[alt]?.name || alt,\n          embodiedCarbon: ICE_MATERIALS[alt]?.embodiedCarbon || 0,\n          embodiedEnergy: ICE_MATERIALS[alt]?.embodiedEnergy || 0\n        }))\n      },\n      analysis: {\n        imagePath: scan.imagePath,\n        confidence: topPrediction.confidence,\n        modelName: scanData.modelName,\n        boundingBox,\n        isSimulation: isSimulation\n      },\n      isGuest,\n      scansRemaining: isGuest ? 3 - (await Scan.countDocuments({ guestToken })) : null\n    });\n  } catch (error) {\n    console.error('Prediction error:', error);\n    res.status(500).json({ error: 'Prediction failed' });\n  }\n});\n\nrouter.get('/guest/:guestToken', async (req: Request, res: Response) => {\n  try {\n    const { guestToken } = req.params;\n    \n    const scans = await Scan.find({ guestToken })\n      .sort({ createdAt: -1 })\n      .limit(10);\n\n    res.json({\n      scans: scans.map(s => ({\n        id: s._id,\n        imagePath: s.imagePath,\n        prediction: s.topPrediction,\n        material: s.materialProperties,\n        confidence: s.confidence,\n        boundingBox: s.boundingBox,\n        createdAt: s.createdAt\n      })),\n      count: scans.length,\n      remaining: Math.max(0, 3 - scans.length)\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch guest scans' });\n  }\n});\n\nrouter.get('/', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { limit = 20, projectId } = req.query;\n    \n    const query: any = { userId: req.userId };\n    if (projectId) {\n      query.projectId = projectId;\n    }\n\n    const scans = await Scan.find(query)\n      .sort({ createdAt: -1 })\n      .limit(Number(limit));\n\n    res.json(scans.map(s => ({\n      id: s._id,\n      imagePath: s.imagePath,\n      prediction: s.topPrediction,\n      allPredictions: s.allPredictions,\n      material: s.materialProperties,\n      confidence: s.confidence,\n      boundingBox: s.boundingBox,\n      modelName: s.modelName,\n      createdAt: s.createdAt\n    })));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch scans' });\n  }\n});\n\nrouter.get('/stats', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const totalScans = await Scan.countDocuments({ userId: req.userId });\n    \n    const scans = await Scan.find({ userId: req.userId });\n    const totalCarbonAnalyzed = scans.reduce((sum, s) => \n      sum + (s.materialProperties?.embodiedCarbon || 0), 0\n    );\n\n    const materialCounts: Record<string, number> = {};\n    scans.forEach(s => {\n      const material = s.topPrediction?.className || 'Unknown';\n      materialCounts[material] = (materialCounts[material] || 0) + 1;\n    });\n\n    const topMaterials = Object.entries(materialCounts)\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 5)\n      .map(([name, count]) => ({ name, count }));\n\n    res.json({\n      totalScans,\n      totalCarbonAnalyzed,\n      averageConfidence: scans.length > 0 \n        ? scans.reduce((sum, s) => sum + (s.confidence || 0), 0) / scans.length \n        : 0,\n      topMaterials\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch scan stats' });\n  }\n});\n\nrouter.get('/:id', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const scan = await Scan.findOne({ \n      _id: req.params.id, \n      userId: req.userId \n    });\n\n    if (!scan) {\n      res.status(404).json({ error: 'Scan not found' });\n      return;\n    }\n\n    res.json({\n      id: scan._id,\n      imagePath: scan.imagePath,\n      wireframePath: scan.wireframePath,\n      topPrediction: scan.topPrediction,\n      allPredictions: scan.allPredictions,\n      materialProperties: scan.materialProperties,\n      boundingBox: scan.boundingBox,\n      modelId: scan.modelId,\n      modelName: scan.modelName,\n      confidence: scan.confidence,\n      projectId: scan.projectId,\n      status: scan.status,\n      createdAt: scan.createdAt\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch scan' });\n  }\n});\n\nrouter.delete('/:id', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const scan = await Scan.findOneAndDelete({ \n      _id: req.params.id, \n      userId: req.userId \n    });\n\n    if (!scan) {\n      res.status(404).json({ error: 'Scan not found' });\n      return;\n    }\n\n    await User.findByIdAndUpdate(req.userId, {\n      $inc: { totalScans: -1 }\n    });\n\n    res.json({ message: 'Scan deleted successfully' });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to delete scan' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":14957,"size_tokens":null},"server/db/mongoose.ts":{"content":"import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb+srv://mateen:mateen@cluster0.ydjp5.mongodb.net/Construction_test?retryWrites=true&w=majority\";\n\nlet isConnected = false;\n\nexport async function connectDB() {\n  if (isConnected) return;\n  \n  try {\n    await mongoose.connect(MONGODB_URI);\n    isConnected = true;\n    console.log('Connected to MongoDB Atlas');\n  } catch (error) {\n    console.error('MongoDB connection error:', error);\n    throw error;\n  }\n}\n\nexport default mongoose;\n","path":null,"size_bytes":522,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/lib/api.ts":{"content":"const API_BASE = '/api';\n\ninterface ApiOptions {\n  method?: string;\n  body?: any;\n  headers?: Record<string, string>;\n}\n\nexport interface UserPreferences {\n  emailAlerts: boolean;\n  marketingEmails: boolean;\n  pushNotifications: boolean;\n  measurementSystem: 'metric' | 'imperial';\n  currency: 'USD' | 'EUR' | 'GBP';\n}\n\nexport interface UserAppearance {\n  darkMode: boolean;\n  compactView: boolean;\n  reduceMotion: boolean;\n}\n\nexport interface UserPrivacy {\n  publicProfile: boolean;\n  showActivity: boolean;\n  allowDataCollection: boolean;\n}\n\nexport interface ScanResult {\n  success: boolean;\n  scanId: string;\n  prediction: { class: string; className: string; confidence: number };\n  allPredictions: { class: string; className: string; confidence: number }[];\n  material: {\n    name: string;\n    embodiedEnergy: number;\n    embodiedCarbon: number;\n    density: number;\n    thermalConductivity?: number;\n    recyclability?: string;\n    alternatives: { key: string; name: string; embodiedCarbon: number; embodiedEnergy: number }[];\n  };\n  analysis: {\n    imagePath: string;\n    confidence: number;\n    modelName: string;\n    boundingBox?: { x: number; y: number; width: number; height: number };\n    isSimulation: boolean;\n  };\n  isGuest: boolean;\n  scansRemaining: number | null;\n}\n\nclass ApiClient {\n  private token: string | null = null;\n  private guestToken: string | null = null;\n\n  constructor() {\n    this.token = localStorage.getItem('token');\n    this.guestToken = localStorage.getItem('guestToken');\n    if (!this.guestToken) {\n      this.guestToken = this.generateGuestToken();\n      localStorage.setItem('guestToken', this.guestToken);\n    }\n  }\n\n  private generateGuestToken(): string {\n    return 'guest_' + Date.now() + '_' + Math.random().toString(36).substring(2, 15);\n  }\n\n  setToken(token: string | null) {\n    this.token = token;\n    if (token) {\n      localStorage.setItem('token', token);\n    } else {\n      localStorage.removeItem('token');\n    }\n  }\n\n  getToken() {\n    return this.token || localStorage.getItem('token');\n  }\n\n  getGuestToken() {\n    return this.guestToken || localStorage.getItem('guestToken');\n  }\n\n  isAuthenticated() {\n    return !!this.getToken();\n  }\n\n  async request<T>(endpoint: string, options: ApiOptions = {}): Promise<T> {\n    const { method = 'GET', body, headers = {} } = options;\n\n    const token = this.getToken();\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    if (body && !(body instanceof FormData)) {\n      headers['Content-Type'] = 'application/json';\n    }\n\n    const response = await fetch(`${API_BASE}${endpoint}`, {\n      method,\n      headers,\n      body: body instanceof FormData ? body : body ? JSON.stringify(body) : undefined,\n    });\n\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({ error: 'Request failed' }));\n      throw new Error(error.error || error.message || 'Request failed');\n    }\n\n    return response.json();\n  }\n\n  async register(data: { \n    email: string; \n    password: string; \n    firstName: string; \n    lastName: string; \n    company?: string; \n    jobTitle?: string \n  }) {\n    const guestToken = this.getGuestToken();\n    const result = await this.request<{ user: any; token: string }>('/auth/register', {\n      method: 'POST',\n      body: { ...data, guestToken },\n    });\n    this.setToken(result.token);\n    return result;\n  }\n\n  async login(email: string, password: string) {\n    const guestToken = this.getGuestToken();\n    const result = await this.request<{ user: any; token: string }>('/auth/login', {\n      method: 'POST',\n      body: { email, password, guestToken },\n    });\n    this.setToken(result.token);\n    return result;\n  }\n\n  async googleAuth(data: { googleId: string; email: string; firstName: string; lastName: string; avatar?: string }) {\n    const guestToken = this.getGuestToken();\n    const result = await this.request<{ user: any; token: string }>('/auth/google', {\n      method: 'POST',\n      body: { ...data, guestToken },\n    });\n    this.setToken(result.token);\n    return result;\n  }\n\n  logout() {\n    this.setToken(null);\n  }\n\n  async getMe() {\n    return this.request<any>('/auth/me');\n  }\n\n  async updateProfile(data: { \n    firstName?: string; \n    lastName?: string; \n    bio?: string;\n    company?: string; \n    jobTitle?: string; \n    avatar?: string \n  }) {\n    return this.request<any>('/auth/profile', {\n      method: 'PUT',\n      body: data,\n    });\n  }\n\n  async uploadAvatar(file: File) {\n    const formData = new FormData();\n    formData.append('avatar', file);\n    return this.request<{ avatar: string; user: any }>('/auth/avatar', {\n      method: 'POST',\n      body: formData,\n    });\n  }\n\n  async updatePreferences(data: Partial<UserPreferences>) {\n    return this.request<any>('/auth/preferences', {\n      method: 'PUT',\n      body: data,\n    });\n  }\n\n  async updateAppearance(data: Partial<UserAppearance>) {\n    return this.request<any>('/auth/appearance', {\n      method: 'PUT',\n      body: data,\n    });\n  }\n\n  async updatePrivacy(data: Partial<UserPrivacy>) {\n    return this.request<any>('/auth/privacy', {\n      method: 'PUT',\n      body: data,\n    });\n  }\n\n  async updatePassword(currentPassword: string, newPassword: string) {\n    return this.request<{ message: string }>('/auth/password', {\n      method: 'PUT',\n      body: { currentPassword, newPassword },\n    });\n  }\n\n  async getProjects() {\n    return this.request<any[]>('/projects');\n  }\n\n  async getProject(id: string) {\n    return this.request<any>(`/projects/${id}`);\n  }\n\n  async createProject(data: any) {\n    return this.request<any>('/projects', {\n      method: 'POST',\n      body: data,\n    });\n  }\n\n  async updateProject(id: string, data: any) {\n    return this.request<any>(`/projects/${id}`, {\n      method: 'PUT',\n      body: data,\n    });\n  }\n\n  async deleteProject(id: string) {\n    return this.request<any>(`/projects/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async addProjectMaterial(projectId: string, material: any) {\n    return this.request<any>(`/projects/${projectId}/materials`, {\n      method: 'POST',\n      body: material,\n    });\n  }\n\n  async getMaterials(params?: { category?: string; search?: string }) {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<any[]>(`/materials${query ? `?${query}` : ''}`);\n  }\n\n  async getMaterial(id: string) {\n    return this.request<any>(`/materials/${id}`);\n  }\n\n  async getMaterialCategories() {\n    return this.request<string[]>('/materials/categories');\n  }\n\n  async getModelStatus() {\n    return this.request<{ available: boolean; model?: any; message?: string }>('/models/active');\n  }\n\n  async scanMaterial(formData: FormData): Promise<ScanResult> {\n    if (!this.isAuthenticated()) {\n      formData.append('guestToken', this.getGuestToken() || '');\n    }\n    return this.request<ScanResult>('/scans/predict', {\n      method: 'POST',\n      body: formData,\n    });\n  }\n\n  async getGuestScans() {\n    const guestToken = this.getGuestToken();\n    return this.request<{ scans: any[]; count: number; remaining: number }>(`/scans/guest/${guestToken}`);\n  }\n\n  async getScans(limit?: number) {\n    return this.request<any[]>(`/scans${limit ? `?limit=${limit}` : ''}`);\n  }\n\n  async getScan(id: string) {\n    return this.request<any>(`/scans/${id}`);\n  }\n\n  async deleteScan(id: string) {\n    return this.request<any>(`/scans/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async getScanStats() {\n    return this.request<any>('/scans/stats');\n  }\n\n  async getReports() {\n    return this.request<any[]>('/reports');\n  }\n\n  async getReport(id: string) {\n    return this.request<any>(`/reports/${id}`);\n  }\n\n  async generateReport(data: { projectId?: string; type?: string; title?: string }) {\n    return this.request<any>('/reports/generate', {\n      method: 'POST',\n      body: data,\n    });\n  }\n\n  async deleteReport(id: string) {\n    return this.request<any>(`/reports/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async getDashboardStats() {\n    return this.request<any>('/reports/dashboard/stats');\n  }\n\n  async getMLModels() {\n    return this.request<any[]>('/models');\n  }\n\n  async getMLModel(id: string) {\n    return this.request<any>(`/models/${id}`);\n  }\n\n  async getMLModelStats() {\n    return this.request<any>('/models/stats');\n  }\n}\n\nexport const api = new ApiClient();\nexport default api;\n","path":null,"size_bytes":8383,"size_tokens":null},"replit.md":{"content":"# EcoBuild AI - Smart Material Scanner\n\n## Overview\n\nEcoBuild AI is a comprehensive web application for construction material analysis and carbon footprint tracking. The platform uses machine learning to identify construction materials from images and provides detailed sustainability metrics, helping architects and engineers make environmentally conscious material choices. The application features material scanning, project management, sustainability reporting, and a comprehensive materials library based on the ICE (Inventory of Carbon and Energy) database.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React 18 with TypeScript, built using Vite as the build tool and development server.\n\n**UI Framework**: Shadcn/ui components (based on Radix UI primitives) with Tailwind CSS v4 for styling. The design system uses CSS custom properties for theming with support for light/dark modes. Two primary fonts are used: Inter for body text and Oswald for display headings.\n\n**Routing**: Wouter for lightweight client-side routing with protected routes that redirect unauthenticated users to the login page.\n\n**State Management**: TanStack Query (React Query) for server state management with custom query client configuration. Local state managed with React hooks. Authentication state managed through a React Context provider.\n\n**Animation**: Framer Motion for page transitions and interactive animations throughout the UI.\n\n**Charts**: Recharts library for data visualization (carbon footprint comparisons, project analytics).\n\n**File Structure**: \n- `/client/src/pages` - Page components for different routes\n- `/client/src/components` - Reusable UI components\n- `/client/src/lib` - Utility functions, API client, auth context\n- `/client/src/hooks` - Custom React hooks\n\n### Backend Architecture\n\n**Runtime**: Node.js with Express.js framework running on TypeScript (compiled with esbuild for production).\n\n**API Design**: RESTful API with route modules organized by feature (auth, projects, materials, scans, reports). All API routes are prefixed with `/api`.\n\n**Authentication**: JWT-based authentication with bcrypt for password hashing. Tokens stored in localStorage on client-side and sent via Authorization header. Auth middleware validates tokens and attaches user data to requests.\n\n**File Uploads**: Multer middleware for handling image uploads with file size limits (10MB) and type validation (JPEG, PNG, WebP). Images stored in `/uploads/scans` directory.\n\n**Static Files**: Express static middleware serves uploaded files and the built frontend from `/dist/public`.\n\n**Development Mode**: Custom Vite development server integration with HMR (Hot Module Replacement) over WebSocket connection at `/vite-hmr`.\n\n**Bundling Strategy**: Server dependencies are selectively bundled (allowlist) to reduce filesystem syscalls and improve cold start times. External packages not in the allowlist are marked as external during esbuild compilation.\n\n### Data Storage\n\n**Primary Database**: MongoDB Atlas (cloud-hosted) using Mongoose ODM for schema validation and querying.\n\n**Connection**: Connection string stored in `MONGODB_URI` environment variable. Single connection with automatic reconnection handling.\n\n**Schemas**:\n- **User**: Authentication and profile data (email, password hash, name, company, stats)\n- **Project**: Construction projects with materials, location, status, progress tracking\n- **Scan**: Material scan results with predictions, confidence scores, image paths\n- **Report**: Generated sustainability reports with metrics and recommendations\n- **MaterialImage** (ML Studio): Training images stored with binary data in GridFS-like Buffer fields\n- **TrainedModel** (ML Studio): ML model metadata, training history, and serialized model data\n- **CustomMaterial** (ML Studio): User-defined material classes with embodied energy/carbon data\n\n**Indexing**: Compound indexes on userId and timestamps for efficient query performance.\n\n**In-Memory Storage**: Fallback memory storage implementation (`MemStorage` class) for user data when database is unavailable, though not actively used in production.\n\n### External Dependencies\n\n**Database**: MongoDB Atlas cluster accessed via connection string with credentials embedded. Database name: `Construction_test`.\n\n**ML Training Service** (MLStudio Integration): Python-based training worker using TensorFlow 2.20/Keras with EfficientNetB0 architecture. Features:\n- `/MLStudio-main/worker/train.py` - Main training script with 3-phase progressive unfreezing, class-weighted learning, and comprehensive augmentation\n- `/MLStudio-main/worker/add_training_images.py` - Data management tool for adding/deduplicating training images\n- `/MLStudio-main/worker/sync_model_to_ecobuild.py` - Model synchronization tool to deploy trained models to EcoBuild\n- `/MLStudio-main/worker/predict.py` - Inference script used by EcoBuild for real predictions\n- `/server/services/modelInference.ts` - Node.js service that bridges to Python for ML predictions\n\n**Material Data**: ICE (Inventory of Carbon and Energy) database materials hardcoded in `/server/routes/materials.ts` and `/MLStudio-main/server/config/materials.js`. Contains 15+ construction materials with embodied energy (MJ/kg), embodied carbon (kgCO2/kg), and density values.\n\n**Third-Party Services**:\n- Replit-specific development tools (vite plugins for cartographer, dev banner, runtime error modal)\n- Google Fonts (Inter and Oswald families)\n- Meta image plugin for dynamic OpenGraph image URL generation based on Replit deployment domain\n\n**Image Processing**: Sharp library for server-side image resizing and optimization (224x224 for ML training).\n\n**Environment Variables Required**:\n- `DATABASE_URL` - PostgreSQL connection string (Drizzle config, though MongoDB is actually used)\n- `MONGODB_URI` - MongoDB Atlas connection string\n- `JWT_SECRET` - Secret key for JWT token signing (defaults to hardcoded value if not set)\n- `NODE_ENV` - Environment mode (development/production)\n- `REPL_ID` - Replit-specific identifier for development tooling\n\n**Build Process**:\n1. Frontend: Vite builds React app to `/dist/public`\n2. Backend: esbuild bundles server code to `/dist/index.js` as ESM with selective external dependencies\n3. Production start: `node dist/index.js` serves both API and static frontend\n\n**CORS**: Enabled for cross-origin requests during development.\n\n**WebSocket**: Used for ML training progress updates in the MLStudio integration (separate server on port 3001).\n\n**Session Management**: JWT tokens with 7-day expiration. No server-side session storageâ€”tokens are stateless and validated on each request.","path":null,"size_bytes":6743,"size_tokens":null},"server/routes/materials.ts":{"content":"import { Router, Request, Response } from 'express';\n\nconst router = Router();\n\nconst ICE_MATERIALS = {\n  bricks: {\n    key: 'bricks',\n    name: 'Bricks (common)',\n    description: 'Common clay bricks used in construction',\n    category: 'Masonry',\n    embodiedEnergy: 3.0,\n    embodiedCarbon: 0.24,\n    density: 1700,\n    impactLevel: 'Medium',\n    alternatives: ['concrete_block', 'aerated_block']\n  },\n  concrete: {\n    key: 'concrete',\n    name: 'Concrete (1:1.5:3)',\n    description: 'Standard mix concrete for structural elements',\n    category: 'Concrete',\n    embodiedEnergy: 0.95,\n    embodiedCarbon: 0.13,\n    density: 2400,\n    impactLevel: 'High',\n    alternatives: ['rammed_earth', 'limestone_block']\n  },\n  aggregate: {\n    key: 'aggregate',\n    name: 'Aggregate',\n    description: 'Crushed stone or gravel for construction',\n    category: 'Aggregate',\n    embodiedEnergy: 0.083,\n    embodiedCarbon: 0.0048,\n    density: 1500,\n    impactLevel: 'Very Low',\n    alternatives: []\n  },\n  aerated_block: {\n    key: 'aerated_block',\n    name: 'Aerated block',\n    description: 'Autoclaved aerated concrete blocks',\n    category: 'Masonry',\n    embodiedEnergy: 3.5,\n    embodiedCarbon: 0.30,\n    density: 600,\n    impactLevel: 'Medium',\n    alternatives: ['concrete_block', 'bricks']\n  },\n  concrete_block: {\n    key: 'concrete_block',\n    name: 'Concrete block (Medium density)',\n    description: 'Medium density concrete masonry blocks',\n    category: 'Masonry',\n    embodiedEnergy: 0.67,\n    embodiedCarbon: 0.073,\n    density: 1350,\n    impactLevel: 'Low',\n    alternatives: ['bricks', 'aerated_block']\n  },\n  limestone_block: {\n    key: 'limestone_block',\n    name: 'Limestone block',\n    description: 'Natural limestone building blocks',\n    category: 'Stone',\n    embodiedEnergy: 0.85,\n    embodiedCarbon: 0.017,\n    density: 2180,\n    impactLevel: 'Very Low',\n    alternatives: ['concrete', 'rammed_earth']\n  },\n  rammed_earth: {\n    key: 'rammed_earth',\n    name: 'Rammed earth',\n    description: 'Compacted earth construction without cement',\n    category: 'Earth',\n    embodiedEnergy: 0.45,\n    embodiedCarbon: 0.023,\n    density: 1900,\n    impactLevel: 'Very Low',\n    alternatives: ['concrete', 'limestone_block']\n  },\n  timber: {\n    key: 'timber',\n    name: 'Timber (general)',\n    description: 'General timber products',\n    category: 'Wood',\n    embodiedEnergy: 8.5,\n    embodiedCarbon: 0.46,\n    density: 600,\n    impactLevel: 'Low',\n    alternatives: []\n  },\n  steel: {\n    key: 'steel',\n    name: 'Steel (general)',\n    description: 'General steel products with average recycled content',\n    category: 'Metal',\n    embodiedEnergy: 20.1,\n    embodiedCarbon: 1.37,\n    density: 7850,\n    impactLevel: 'High',\n    alternatives: ['timber']\n  },\n  glass: {\n    key: 'glass',\n    name: 'Glass (float)',\n    description: 'Float glass for windows and facades',\n    category: 'Glass',\n    embodiedEnergy: 15.0,\n    embodiedCarbon: 0.85,\n    density: 2500,\n    impactLevel: 'Medium',\n    alternatives: []\n  },\n  aluminum: {\n    key: 'aluminum',\n    name: 'Aluminum (general)',\n    description: 'General aluminum products',\n    category: 'Metal',\n    embodiedEnergy: 155,\n    embodiedCarbon: 8.24,\n    density: 2700,\n    impactLevel: 'Very High',\n    alternatives: ['steel']\n  },\n  insulation_mineral_wool: {\n    key: 'insulation_mineral_wool',\n    name: 'Mineral wool insulation',\n    description: 'Mineral wool thermal insulation',\n    category: 'Insulation',\n    embodiedEnergy: 16.6,\n    embodiedCarbon: 1.28,\n    density: 30,\n    impactLevel: 'Medium',\n    alternatives: ['insulation_cellulose']\n  },\n  insulation_cellulose: {\n    key: 'insulation_cellulose',\n    name: 'Cellulose insulation',\n    description: 'Recycled paper cellulose insulation',\n    category: 'Insulation',\n    embodiedEnergy: 0.94,\n    embodiedCarbon: 0.06,\n    density: 45,\n    impactLevel: 'Very Low',\n    alternatives: ['insulation_mineral_wool']\n  },\n  plasterboard: {\n    key: 'plasterboard',\n    name: 'Plasterboard (gypsum)',\n    description: 'Gypsum plasterboard for walls and ceilings',\n    category: 'Finishing',\n    embodiedEnergy: 6.75,\n    embodiedCarbon: 0.38,\n    density: 800,\n    impactLevel: 'Medium',\n    alternatives: []\n  },\n  ceramic_tiles: {\n    key: 'ceramic_tiles',\n    name: 'Ceramic tiles',\n    description: 'Ceramic tiles for floors and walls',\n    category: 'Finishing',\n    embodiedEnergy: 12.0,\n    embodiedCarbon: 0.78,\n    density: 2000,\n    impactLevel: 'Medium',\n    alternatives: []\n  }\n};\n\nfunction getImpactColor(level: string) {\n  switch (level) {\n    case 'Very Low': return { bg: 'bg-green-100', text: 'text-green-700' };\n    case 'Low': return { bg: 'bg-green-100', text: 'text-green-700' };\n    case 'Medium': return { bg: 'bg-yellow-100', text: 'text-yellow-700' };\n    case 'High': return { bg: 'bg-red-100', text: 'text-red-700' };\n    case 'Very High': return { bg: 'bg-red-200', text: 'text-red-800' };\n    default: return { bg: 'bg-gray-100', text: 'text-gray-700' };\n  }\n}\n\nrouter.get('/', async (req: Request, res: Response) => {\n  try {\n    const { category, search } = req.query;\n    \n    let materials = Object.values(ICE_MATERIALS);\n    \n    if (category && typeof category === 'string') {\n      materials = materials.filter(m => m.category.toLowerCase() === category.toLowerCase());\n    }\n    \n    if (search && typeof search === 'string') {\n      const searchLower = search.toLowerCase();\n      materials = materials.filter(m => \n        m.name.toLowerCase().includes(searchLower) ||\n        m.description.toLowerCase().includes(searchLower) ||\n        m.category.toLowerCase().includes(searchLower)\n      );\n    }\n\n    res.json(materials.map(m => ({\n      id: m.key,\n      key: m.key,\n      name: m.name,\n      description: m.description,\n      category: m.category,\n      embodiedEnergy: m.embodiedEnergy,\n      embodiedCarbon: m.embodiedCarbon,\n      density: m.density,\n      impactLevel: m.impactLevel,\n      impactColor: getImpactColor(m.impactLevel),\n      alternatives: m.alternatives\n    })));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch materials' });\n  }\n});\n\nrouter.get('/categories', async (req: Request, res: Response) => {\n  try {\n    const categories = [...new Set(Object.values(ICE_MATERIALS).map(m => m.category))];\n    res.json(categories);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch categories' });\n  }\n});\n\nrouter.get('/:id', async (req: Request, res: Response) => {\n  try {\n    const material = ICE_MATERIALS[req.params.id as keyof typeof ICE_MATERIALS];\n    \n    if (!material) {\n      res.status(404).json({ error: 'Material not found' });\n      return;\n    }\n\n    const alternativeMaterials = material.alternatives\n      .map(key => ICE_MATERIALS[key as keyof typeof ICE_MATERIALS])\n      .filter(Boolean);\n\n    res.json({\n      id: material.key,\n      key: material.key,\n      name: material.name,\n      description: material.description,\n      category: material.category,\n      embodiedEnergy: material.embodiedEnergy,\n      embodiedCarbon: material.embodiedCarbon,\n      density: material.density,\n      impactLevel: material.impactLevel,\n      impactColor: getImpactColor(material.impactLevel),\n      alternatives: alternativeMaterials.map(alt => ({\n        id: alt.key,\n        key: alt.key,\n        name: alt.name,\n        embodiedCarbon: alt.embodiedCarbon,\n        impactLevel: alt.impactLevel\n      }))\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch material' });\n  }\n});\n\nrouter.get('/:id/compare', async (req: Request, res: Response) => {\n  try {\n    const material = ICE_MATERIALS[req.params.id as keyof typeof ICE_MATERIALS];\n    \n    if (!material) {\n      res.status(404).json({ error: 'Material not found' });\n      return;\n    }\n\n    const allMaterials = Object.values(ICE_MATERIALS);\n    const categoryMaterials = allMaterials.filter(m => m.category === material.category);\n    \n    const avgCarbon = categoryMaterials.reduce((sum, m) => sum + m.embodiedCarbon, 0) / categoryMaterials.length;\n    const avgEnergy = categoryMaterials.reduce((sum, m) => sum + m.embodiedEnergy, 0) / categoryMaterials.length;\n\n    res.json({\n      material: {\n        name: material.name,\n        embodiedCarbon: material.embodiedCarbon,\n        embodiedEnergy: material.embodiedEnergy\n      },\n      categoryAverage: {\n        category: material.category,\n        embodiedCarbon: avgCarbon,\n        embodiedEnergy: avgEnergy\n      },\n      carbonDifference: ((material.embodiedCarbon - avgCarbon) / avgCarbon) * 100,\n      energyDifference: ((material.embodiedEnergy - avgEnergy) / avgEnergy) * 100\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to compare materials' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":8791,"size_tokens":null},"server/db/models/Scan.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IScanPrediction {\n  class: string;\n  className: string;\n  confidence: number;\n}\n\nexport interface IScan extends Document {\n  userId?: mongoose.Types.ObjectId;\n  guestToken?: string;\n  projectId?: mongoose.Types.ObjectId;\n  imagePath: string;\n  wireframePath?: string;\n  topPrediction: IScanPrediction;\n  allPredictions: IScanPrediction[];\n  materialProperties: {\n    name: string;\n    embodiedEnergy: number;\n    embodiedCarbon: number;\n    density: number;\n    thermalConductivity?: number;\n    recyclability?: string;\n    alternatives: string[];\n  };\n  boundingBox?: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  };\n  modelId: string;\n  modelName: string;\n  confidence: number;\n  status: 'pending' | 'completed' | 'failed';\n  createdAt: Date;\n}\n\nconst ScanPredictionSchema = new Schema({\n  class: { type: String, required: true },\n  className: { type: String, required: true },\n  confidence: { type: Number, required: true }\n}, { _id: false });\n\nconst BoundingBoxSchema = new Schema({\n  x: { type: Number },\n  y: { type: Number },\n  width: { type: Number },\n  height: { type: Number }\n}, { _id: false });\n\nconst ScanSchema = new Schema<IScan>({\n  userId: { type: Schema.Types.ObjectId, ref: 'User' },\n  guestToken: { type: String, sparse: true },\n  projectId: { type: Schema.Types.ObjectId, ref: 'Project' },\n  imagePath: { type: String, required: true },\n  wireframePath: { type: String },\n  topPrediction: { type: ScanPredictionSchema, required: true },\n  allPredictions: [ScanPredictionSchema],\n  materialProperties: {\n    name: { type: String },\n    embodiedEnergy: { type: Number },\n    embodiedCarbon: { type: Number },\n    density: { type: Number },\n    thermalConductivity: { type: Number },\n    recyclability: { type: String },\n    alternatives: [{ type: String }]\n  },\n  boundingBox: { type: BoundingBoxSchema },\n  modelId: { type: String },\n  modelName: { type: String },\n  confidence: { type: Number },\n  status: { type: String, enum: ['pending', 'completed', 'failed'], default: 'completed' }\n}, {\n  timestamps: true\n});\n\nScanSchema.index({ userId: 1 });\nScanSchema.index({ guestToken: 1 });\nScanSchema.index({ projectId: 1 });\nScanSchema.index({ createdAt: -1 });\n\nexport const Scan = mongoose.model<IScan>('Scan', ScanSchema);\n","path":null,"size_bytes":2344,"size_tokens":null},"server/db/models/index.ts":{"content":"export { User, type IUser, type IUserPreferences, type IUserAppearance, type IUserPrivacy } from './User';\nexport { Project, type IProject, type IProjectMaterial } from './Project';\nexport { Scan, type IScan, type IScanPrediction } from './Scan';\nexport { Report, type IReport } from './Report';\nexport { MLModel, type IMLModel } from './MLModel';\n","path":null,"size_bytes":348,"size_tokens":null},"server/db/models/Report.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IReport extends Document {\n  userId: mongoose.Types.ObjectId;\n  projectId?: mongoose.Types.ObjectId;\n  title: string;\n  type: 'project' | 'material' | 'sustainability' | 'comparison';\n  status: 'draft' | 'completed';\n  data: {\n    totalCarbonFootprint: number;\n    totalEmbodiedEnergy: number;\n    carbonReduction: number;\n    materialsAnalyzed: number;\n    sustainabilityScore: number;\n    recommendations: string[];\n    chartData?: any;\n  };\n  generatedAt: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst ReportSchema = new Schema<IReport>({\n  userId: { type: Schema.Types.ObjectId, ref: 'User', required: true },\n  projectId: { type: Schema.Types.ObjectId, ref: 'Project' },\n  title: { type: String, required: true, trim: true },\n  type: { \n    type: String, \n    enum: ['project', 'material', 'sustainability', 'comparison'], \n    default: 'project' \n  },\n  status: { type: String, enum: ['draft', 'completed'], default: 'draft' },\n  data: {\n    totalCarbonFootprint: { type: Number, default: 0 },\n    totalEmbodiedEnergy: { type: Number, default: 0 },\n    carbonReduction: { type: Number, default: 0 },\n    materialsAnalyzed: { type: Number, default: 0 },\n    sustainabilityScore: { type: Number, default: 0 },\n    recommendations: [{ type: String }],\n    chartData: { type: Schema.Types.Mixed }\n  },\n  generatedAt: { type: Date, default: Date.now }\n}, {\n  timestamps: true\n});\n\nReportSchema.index({ userId: 1 });\nReportSchema.index({ projectId: 1 });\nReportSchema.index({ generatedAt: -1 });\n\nexport const Report = mongoose.model<IReport>('Report', ReportSchema);\n","path":null,"size_bytes":1648,"size_tokens":null},"server/routes/auth.ts":{"content":"import { Router, Request, Response } from 'express';\nimport bcrypt from 'bcryptjs';\nimport multer from 'multer';\nimport path from 'path';\nimport fs from 'fs';\nimport { User, Scan } from '../db/models';\nimport { generateToken, authMiddleware, AuthRequest } from '../middleware/auth';\n\nconst router = Router();\n\nconst AVATARS_DIR = path.join(process.cwd(), 'uploads', 'avatars');\nif (!fs.existsSync(AVATARS_DIR)) {\n  fs.mkdirSync(AVATARS_DIR, { recursive: true });\n}\n\nconst avatarStorage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, AVATARS_DIR);\n  },\n  filename: (req, file, cb) => {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    cb(null, uniqueSuffix + path.extname(file.originalname));\n  }\n});\n\nconst avatarUpload = multer({\n  storage: avatarStorage,\n  limits: { fileSize: 5 * 1024 * 1024 },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/webp'];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type'));\n    }\n  }\n});\n\nfunction formatUserResponse(user: any) {\n  return {\n    id: user._id,\n    email: user.email,\n    firstName: user.firstName,\n    lastName: user.lastName,\n    bio: user.bio,\n    avatar: user.avatar,\n    company: user.company,\n    jobTitle: user.jobTitle,\n    totalScans: user.totalScans,\n    carbonSaved: user.carbonSaved,\n    preferences: user.preferences,\n    appearance: user.appearance,\n    privacy: user.privacy,\n    subscriptionPlan: user.subscriptionPlan,\n    subscriptionStatus: user.subscriptionStatus\n  };\n}\n\nrouter.post('/register', async (req: Request, res: Response) => {\n  try {\n    const { email, password, firstName, lastName, company, jobTitle, guestToken } = req.body;\n\n    if (!email || !password || !firstName || !lastName) {\n      res.status(400).json({ error: 'All fields are required' });\n      return;\n    }\n\n    const existingUser = await User.findOne({ email: email.toLowerCase() });\n    if (existingUser) {\n      res.status(400).json({ error: 'Email already registered' });\n      return;\n    }\n\n    const hashedPassword = await bcrypt.hash(password, 12);\n\n    const user = await User.create({\n      email: email.toLowerCase(),\n      password: hashedPassword,\n      firstName,\n      lastName,\n      company,\n      jobTitle,\n      provider: 'local'\n    });\n\n    if (guestToken) {\n      await Scan.updateMany(\n        { guestToken, userId: null },\n        { $set: { userId: user._id }, $unset: { guestToken: 1 } }\n      );\n      \n      const guestScans = await Scan.countDocuments({ userId: user._id });\n      if (guestScans > 0) {\n        const scans = await Scan.find({ userId: user._id });\n        const totalCarbon = scans.reduce((sum, s) => sum + (s.materialProperties?.embodiedCarbon || 0) * 0.1, 0);\n        await User.findByIdAndUpdate(user._id, {\n          $set: { totalScans: guestScans, carbonSaved: totalCarbon }\n        });\n      }\n    }\n\n    const token = generateToken(user._id.toString());\n\n    res.status(201).json({\n      user: formatUserResponse(user),\n      token\n    });\n  } catch (error) {\n    console.error('Registration error:', error);\n    res.status(500).json({ error: 'Registration failed' });\n  }\n});\n\nrouter.post('/login', async (req: Request, res: Response) => {\n  try {\n    const { email, password, guestToken } = req.body;\n\n    if (!email || !password) {\n      res.status(400).json({ error: 'Email and password are required' });\n      return;\n    }\n\n    const user = await User.findOne({ email: email.toLowerCase() });\n    if (!user || !user.password) {\n      res.status(401).json({ error: 'Invalid credentials' });\n      return;\n    }\n\n    const isValidPassword = await bcrypt.compare(password, user.password);\n    if (!isValidPassword) {\n      res.status(401).json({ error: 'Invalid credentials' });\n      return;\n    }\n\n    if (guestToken) {\n      const guestScans = await Scan.find({ guestToken, userId: null });\n      if (guestScans.length > 0) {\n        await Scan.updateMany(\n          { guestToken, userId: null },\n          { $set: { userId: user._id }, $unset: { guestToken: 1 } }\n        );\n        \n        const totalCarbon = guestScans.reduce((sum, s) => sum + (s.materialProperties?.embodiedCarbon || 0) * 0.1, 0);\n        await User.findByIdAndUpdate(user._id, {\n          $inc: { totalScans: guestScans.length, carbonSaved: totalCarbon }\n        });\n      }\n    }\n\n    const token = generateToken(user._id.toString());\n\n    res.json({\n      user: formatUserResponse(user),\n      token\n    });\n  } catch (error) {\n    console.error('Login error:', error);\n    res.status(500).json({ error: 'Login failed' });\n  }\n});\n\nrouter.post('/google', async (req: Request, res: Response) => {\n  try {\n    const { googleId, email, firstName, lastName, avatar, guestToken } = req.body;\n\n    if (!googleId || !email) {\n      res.status(400).json({ error: 'Google ID and email are required' });\n      return;\n    }\n\n    let user = await User.findOne({ \n      $or: [{ googleId }, { email: email.toLowerCase() }] \n    });\n\n    if (user) {\n      if (!user.googleId) {\n        user.googleId = googleId;\n        user.provider = 'google';\n        if (avatar) user.avatar = avatar;\n        await user.save();\n      }\n    } else {\n      user = await User.create({\n        email: email.toLowerCase(),\n        firstName: firstName || 'User',\n        lastName: lastName || '',\n        googleId,\n        avatar,\n        provider: 'google'\n      });\n    }\n\n    if (guestToken) {\n      const guestScans = await Scan.find({ guestToken, userId: null });\n      if (guestScans.length > 0) {\n        await Scan.updateMany(\n          { guestToken, userId: null },\n          { $set: { userId: user._id }, $unset: { guestToken: 1 } }\n        );\n        \n        const totalCarbon = guestScans.reduce((sum, s) => sum + (s.materialProperties?.embodiedCarbon || 0) * 0.1, 0);\n        await User.findByIdAndUpdate(user._id, {\n          $inc: { totalScans: guestScans.length, carbonSaved: totalCarbon }\n        });\n      }\n    }\n\n    const token = generateToken(user._id.toString());\n\n    res.json({\n      user: formatUserResponse(user),\n      token\n    });\n  } catch (error) {\n    console.error('Google auth error:', error);\n    res.status(500).json({ error: 'Google authentication failed' });\n  }\n});\n\nrouter.get('/me', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const user = req.user!;\n    res.json(formatUserResponse(user));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to get user' });\n  }\n});\n\nrouter.put('/profile', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { firstName, lastName, bio, company, jobTitle, avatar } = req.body;\n    \n    const user = await User.findByIdAndUpdate(\n      req.userId,\n      { firstName, lastName, bio, company, jobTitle, avatar },\n      { new: true }\n    ).select('-password');\n\n    if (!user) {\n      res.status(404).json({ error: 'User not found' });\n      return;\n    }\n\n    res.json(formatUserResponse(user));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update profile' });\n  }\n});\n\nrouter.post('/avatar', authMiddleware, avatarUpload.single('avatar'), async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.file) {\n      res.status(400).json({ error: 'No image provided' });\n      return;\n    }\n\n    const avatarPath = `/uploads/avatars/${req.file.filename}`;\n    \n    const user = await User.findByIdAndUpdate(\n      req.userId,\n      { avatar: avatarPath },\n      { new: true }\n    ).select('-password');\n\n    if (!user) {\n      res.status(404).json({ error: 'User not found' });\n      return;\n    }\n\n    res.json({ avatar: avatarPath, user: formatUserResponse(user) });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to upload avatar' });\n  }\n});\n\nrouter.put('/preferences', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { emailAlerts, marketingEmails, pushNotifications, measurementSystem, currency } = req.body;\n    \n    const updateFields: any = {};\n    if (emailAlerts !== undefined) updateFields['preferences.emailAlerts'] = emailAlerts;\n    if (marketingEmails !== undefined) updateFields['preferences.marketingEmails'] = marketingEmails;\n    if (pushNotifications !== undefined) updateFields['preferences.pushNotifications'] = pushNotifications;\n    if (measurementSystem !== undefined) updateFields['preferences.measurementSystem'] = measurementSystem;\n    if (currency !== undefined) updateFields['preferences.currency'] = currency;\n    \n    const user = await User.findByIdAndUpdate(\n      req.userId,\n      { $set: updateFields },\n      { new: true }\n    ).select('-password');\n\n    if (!user) {\n      res.status(404).json({ error: 'User not found' });\n      return;\n    }\n\n    res.json(formatUserResponse(user));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update preferences' });\n  }\n});\n\nrouter.put('/appearance', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { darkMode, compactView, reduceMotion } = req.body;\n    \n    const updateFields: any = {};\n    if (darkMode !== undefined) updateFields['appearance.darkMode'] = darkMode;\n    if (compactView !== undefined) updateFields['appearance.compactView'] = compactView;\n    if (reduceMotion !== undefined) updateFields['appearance.reduceMotion'] = reduceMotion;\n    \n    const user = await User.findByIdAndUpdate(\n      req.userId,\n      { $set: updateFields },\n      { new: true }\n    ).select('-password');\n\n    if (!user) {\n      res.status(404).json({ error: 'User not found' });\n      return;\n    }\n\n    res.json(formatUserResponse(user));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update appearance' });\n  }\n});\n\nrouter.put('/privacy', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { publicProfile, showActivity, allowDataCollection } = req.body;\n    \n    const updateFields: any = {};\n    if (publicProfile !== undefined) updateFields['privacy.publicProfile'] = publicProfile;\n    if (showActivity !== undefined) updateFields['privacy.showActivity'] = showActivity;\n    if (allowDataCollection !== undefined) updateFields['privacy.allowDataCollection'] = allowDataCollection;\n    \n    const user = await User.findByIdAndUpdate(\n      req.userId,\n      { $set: updateFields },\n      { new: true }\n    ).select('-password');\n\n    if (!user) {\n      res.status(404).json({ error: 'User not found' });\n      return;\n    }\n\n    res.json(formatUserResponse(user));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update privacy settings' });\n  }\n});\n\nrouter.put('/password', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const { currentPassword, newPassword } = req.body;\n    \n    if (!currentPassword || !newPassword) {\n      res.status(400).json({ error: 'Current and new password are required' });\n      return;\n    }\n\n    const user = await User.findById(req.userId);\n    if (!user || !user.password) {\n      res.status(404).json({ error: 'User not found or uses social login' });\n      return;\n    }\n\n    const isValidPassword = await bcrypt.compare(currentPassword, user.password);\n    if (!isValidPassword) {\n      res.status(401).json({ error: 'Current password is incorrect' });\n      return;\n    }\n\n    const hashedPassword = await bcrypt.hash(newPassword, 12);\n    await User.findByIdAndUpdate(req.userId, { password: hashedPassword });\n\n    res.json({ message: 'Password updated successfully' });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update password' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":11679,"size_tokens":null},"client/src/pages/scan-history.tsx":{"content":"import { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Link, useLocation } from 'wouter';\nimport { ArrowLeft, Scan, Clock, Trash2, Eye, Loader2, Search, Box, Layers, Calendar, Filter } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { queryClient } from '@/lib/queryClient';\nimport api from '@/lib/api';\nimport { useToast } from '@/hooks/use-toast';\nimport { useAuth } from '@/lib/auth-context';\nimport { Input } from '@/components/ui/input';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface ScanItem {\n  id: string;\n  materialName: string;\n  materialClass: string;\n  confidence: number;\n  imagePath: string;\n  embodiedCarbon: number;\n  embodiedEnergy: number;\n  density: number;\n  recyclability: string;\n  isSimulation: boolean;\n  createdAt: string;\n  alternatives: { name: string; embodiedCarbon: number }[];\n}\n\nexport default function ScanHistory() {\n  const { isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedScan, setSelectedScan] = useState<ScanItem | null>(null);\n  const [activeView, setActiveView] = useState<'preview' | 'wireframe'>('preview');\n\n  const { data: scans, isLoading, error } = useQuery<ScanItem[]>({\n    queryKey: ['/api/scans'],\n    enabled: isAuthenticated,\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => api.deleteScan(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/scans'] });\n      toast({\n        title: 'Scan Deleted',\n        description: 'The scan has been removed from your history.',\n      });\n      setSelectedScan(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: 'Delete Failed',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const filteredScans = scans?.filter(scan => \n    scan.materialName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    scan.materialClass.toLowerCase().includes(searchQuery.toLowerCase())\n  ) || [];\n\n  const formatDate = (dateString: string) => {\n    return formatDistanceToNow(new Date(dateString), { addSuffix: true });\n  };\n\n  const getConfidenceColor = (confidence: number) => {\n    if (confidence >= 0.9) return 'text-green-500';\n    if (confidence >= 0.7) return 'text-yellow-500';\n    return 'text-orange-500';\n  };\n\n  if (!isAuthenticated) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full text-center\">\n          <CardContent className=\"pt-8 pb-6 space-y-4\">\n            <div className=\"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto\">\n              <Clock className=\"w-8 h-8 text-primary\" />\n            </div>\n            <h2 className=\"text-2xl font-display font-bold\">Sign in to view history</h2>\n            <p className=\"text-muted-foreground\">\n              Create an account to save and access your scan history across devices.\n            </p>\n            <Link href=\"/auth\">\n              <Button className=\"mt-4\" data-testid=\"button-signin\">Sign In</Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"container mx-auto px-4 pt-8\"\n      >\n        <div className=\"flex items-center justify-between gap-4 mb-8 flex-wrap\">\n          <div>\n            <Link href=\"/dashboard\">\n              <Button variant=\"ghost\" className=\"mb-2 pl-0 hover:pl-2 transition-all text-muted-foreground\" data-testid=\"button-back-dashboard\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Dashboard\n              </Button>\n            </Link>\n            <h1 className=\"text-3xl font-display font-bold\">Scan History</h1>\n            <p className=\"text-muted-foreground\">View and manage your material analysis history.</p>\n          </div>\n          <Link href=\"/dashboard\">\n            <Button data-testid=\"button-new-scan\">\n              <Scan className=\"w-4 h-4 mr-2\" /> New Scan\n            </Button>\n          </Link>\n        </div>\n\n        <div className=\"flex gap-4 mb-6 flex-wrap\">\n          <div className=\"relative flex-1 min-w-[200px] max-w-md\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search scans...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search-scans\"\n            />\n          </div>\n          <Button variant=\"outline\" size=\"icon\" data-testid=\"button-filter\">\n            <Filter className=\"w-4 h-4\" />\n          </Button>\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center h-64\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n          </div>\n        ) : error ? (\n          <Card className=\"text-center py-12\">\n            <CardContent>\n              <p className=\"text-muted-foreground\">Failed to load scan history. Please try again.</p>\n              <Button variant=\"outline\" className=\"mt-4\" onClick={() => queryClient.invalidateQueries({ queryKey: ['/api/scans'] })}>\n                Retry\n              </Button>\n            </CardContent>\n          </Card>\n        ) : filteredScans.length === 0 ? (\n          <Card className=\"text-center py-12\">\n            <CardContent className=\"space-y-4\">\n              <div className=\"w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto\">\n                <Scan className=\"w-8 h-8 text-muted-foreground\" />\n              </div>\n              <h3 className=\"text-xl font-semibold\">\n                {searchQuery ? 'No matching scans found' : 'No scans yet'}\n              </h3>\n              <p className=\"text-muted-foreground max-w-md mx-auto\">\n                {searchQuery \n                  ? 'Try adjusting your search query.'\n                  : 'Start scanning construction materials to build your analysis history.'}\n              </p>\n              {!searchQuery && (\n                <Link href=\"/dashboard\">\n                  <Button className=\"mt-2\" data-testid=\"button-start-scanning\">Start Scanning</Button>\n                </Link>\n              )}\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            <AnimatePresence>\n              {filteredScans.map((scan, index) => (\n                <motion.div\n                  key={scan.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, scale: 0.95 }}\n                  transition={{ delay: index * 0.05 }}\n                >\n                  <Card \n                    className=\"overflow-hidden hover-elevate cursor-pointer transition-all\"\n                    onClick={() => setSelectedScan(scan)}\n                    data-testid={`card-scan-${scan.id}`}\n                  >\n                    <div className=\"aspect-video bg-secondary relative\">\n                      {scan.imagePath ? (\n                        <img \n                          src={scan.imagePath} \n                          alt={scan.materialName}\n                          className=\"w-full h-full object-cover\"\n                        />\n                      ) : (\n                        <div className=\"w-full h-full flex items-center justify-center\">\n                          <Box className=\"w-12 h-12 text-muted-foreground\" />\n                        </div>\n                      )}\n                      {scan.isSimulation && (\n                        <Badge variant=\"secondary\" className=\"absolute top-2 right-2 text-xs\">\n                          Simulation\n                        </Badge>\n                      )}\n                    </div>\n                    <CardContent className=\"p-4 space-y-3\">\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div>\n                          <h3 className=\"font-semibold truncate\" data-testid={`text-material-name-${scan.id}`}>\n                            {scan.materialName}\n                          </h3>\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                            <Calendar className=\"w-3 h-3\" />\n                            <span>{formatDate(scan.createdAt)}</span>\n                          </div>\n                        </div>\n                        <Badge variant=\"outline\" className={getConfidenceColor(scan.confidence)}>\n                          {(scan.confidence * 100).toFixed(0)}%\n                        </Badge>\n                      </div>\n                      <div className=\"flex gap-2 text-xs text-muted-foreground\">\n                        <span className=\"bg-secondary/50 px-2 py-1 rounded\">\n                          {scan.embodiedCarbon} kgCO2e\n                        </span>\n                        <span className=\"bg-secondary/50 px-2 py-1 rounded\">\n                          {scan.density} kg/m3\n                        </span>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </AnimatePresence>\n          </div>\n        )}\n\n        {filteredScans.length > 0 && (\n          <div className=\"mt-8 text-center text-sm text-muted-foreground\">\n            Showing {filteredScans.length} of {scans?.length || 0} scans\n          </div>\n        )}\n      </motion.div>\n\n      <Dialog open={!!selectedScan} onOpenChange={() => setSelectedScan(null)}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          {selectedScan && (\n            <>\n              <DialogHeader>\n                <DialogTitle className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center\">\n                    <Scan className=\"w-5 h-5 text-primary\" />\n                  </div>\n                  <div>\n                    <span data-testid=\"text-detail-material-name\">{selectedScan.materialName}</span>\n                    <p className=\"text-sm font-normal text-muted-foreground\">{formatDate(selectedScan.createdAt)}</p>\n                  </div>\n                </DialogTitle>\n                <DialogDescription>\n                  Detailed analysis results for this material scan.\n                </DialogDescription>\n              </DialogHeader>\n\n              <Tabs value={activeView} onValueChange={(v) => setActiveView(v as any)} className=\"mt-4\">\n                <TabsList className=\"grid grid-cols-2 w-full max-w-xs mx-auto\">\n                  <TabsTrigger value=\"preview\" className=\"gap-2\">\n                    <Eye className=\"w-4 h-4\" /> Image\n                  </TabsTrigger>\n                  <TabsTrigger value=\"wireframe\" className=\"gap-2\">\n                    <Layers className=\"w-4 h-4\" /> Wireframe\n                  </TabsTrigger>\n                </TabsList>\n\n                <TabsContent value=\"preview\" className=\"mt-4\">\n                  <div className=\"aspect-video bg-secondary rounded-lg overflow-hidden\">\n                    {selectedScan.imagePath ? (\n                      <img \n                        src={selectedScan.imagePath} \n                        alt={selectedScan.materialName}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    ) : (\n                      <div className=\"w-full h-full flex items-center justify-center\">\n                        <Box className=\"w-16 h-16 text-muted-foreground\" />\n                      </div>\n                    )}\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"wireframe\" className=\"mt-4\">\n                  <div className=\"aspect-video bg-secondary/50 rounded-lg overflow-hidden\">\n                    <svg viewBox=\"0 0 400 300\" className=\"w-full h-full\">\n                      <defs>\n                        <pattern id=\"detail-grid\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n                          <path d=\"M 20 0 L 0 0 0 20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"0.5\" className=\"text-primary/20\" />\n                        </pattern>\n                      </defs>\n                      <rect width=\"400\" height=\"300\" fill=\"url(#detail-grid)\" />\n                      <g>\n                        <rect x=\"100\" y=\"80\" width=\"200\" height=\"140\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n                        <line x1=\"100\" y1=\"80\" x2=\"150\" y2=\"50\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n                        <line x1=\"300\" y1=\"80\" x2=\"350\" y2=\"50\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n                        <line x1=\"150\" y1=\"50\" x2=\"350\" y2=\"50\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n                        <line x1=\"350\" y1=\"50\" x2=\"350\" y2=\"190\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n                        <line x1=\"300\" y1=\"220\" x2=\"350\" y2=\"190\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-primary\" />\n                        <circle cx=\"200\" cy=\"150\" r=\"40\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeDasharray=\"4 2\" className=\"text-green-500\" />\n                        <text x=\"200\" y=\"155\" textAnchor=\"middle\" className=\"fill-green-500 text-xs font-mono\">\n                          {selectedScan.materialName}\n                        </text>\n                      </g>\n                    </svg>\n                  </div>\n                </TabsContent>\n              </Tabs>\n\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4\">\n                <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                  <p className=\"text-lg font-bold text-orange-500\">\n                    {selectedScan.embodiedCarbon}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">kgCO2e/kg</p>\n                </div>\n                <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                  <p className=\"text-lg font-bold text-blue-500\">\n                    {selectedScan.embodiedEnergy}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">MJ/kg</p>\n                </div>\n                <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                  <p className=\"text-lg font-bold\">\n                    {selectedScan.density}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">kg/m3</p>\n                </div>\n                <div className=\"bg-secondary/50 rounded-lg p-3 text-center\">\n                  <Badge variant=\"outline\" className={getConfidenceColor(selectedScan.confidence)}>\n                    {(selectedScan.confidence * 100).toFixed(1)}%\n                  </Badge>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Confidence</p>\n                </div>\n              </div>\n\n              {selectedScan.alternatives && selectedScan.alternatives.length > 0 && (\n                <div className=\"mt-4 p-4 bg-green-500/10 rounded-lg\">\n                  <h4 className=\"font-semibold text-green-700 dark:text-green-400 mb-2\">Sustainable Alternatives</h4>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    {selectedScan.alternatives.map((alt, idx) => (\n                      <Badge key={idx} variant=\"secondary\">\n                        {alt.name} ({alt.embodiedCarbon} kgCO2e)\n                      </Badge>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"flex gap-3 mt-6 justify-end\">\n                <Button \n                  variant=\"destructive\" \n                  size=\"sm\"\n                  onClick={() => deleteMutation.mutate(selectedScan.id)}\n                  disabled={deleteMutation.isPending}\n                  data-testid=\"button-delete-scan\"\n                >\n                  {deleteMutation.isPending ? (\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  ) : (\n                    <Trash2 className=\"w-4 h-4 mr-2\" />\n                  )}\n                  Delete\n                </Button>\n                <Button variant=\"outline\" onClick={() => setSelectedScan(null)}>\n                  Close\n                </Button>\n              </div>\n            </>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":17331,"size_tokens":null},"server/db/models/MLModel.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IMLModel extends Document {\n  name: string;\n  version: string;\n  description: string;\n  status: 'training' | 'ready' | 'failed' | 'deprecated';\n  accuracy: number;\n  precision: number;\n  recall: number;\n  f1Score: number;\n  totalSamples: number;\n  epochs: number;\n  trainingTime: number;\n  modelPath?: string;\n  labelsPath?: string;\n  classes?: string[];\n  classIndices?: Record<string, string>;\n  inputShape?: number[];\n  architecture?: string;\n  mlstudioModelId?: string;\n  isActive: boolean;\n  createdBy?: mongoose.Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst MLModelSchema = new Schema<IMLModel>({\n  name: { type: String, required: true },\n  version: { type: String, required: true },\n  description: { type: String },\n  status: { \n    type: String, \n    enum: ['training', 'ready', 'failed', 'deprecated'], \n    default: 'training' \n  },\n  accuracy: { type: Number, default: 0 },\n  precision: { type: Number, default: 0 },\n  recall: { type: Number, default: 0 },\n  f1Score: { type: Number, default: 0 },\n  totalSamples: { type: Number, default: 0 },\n  epochs: { type: Number, default: 0 },\n  trainingTime: { type: Number, default: 0 },\n  modelPath: { type: String },\n  labelsPath: { type: String },\n  classes: [{ type: String }],\n  classIndices: { type: Schema.Types.Mixed },\n  inputShape: [{ type: Number }],\n  architecture: { type: String },\n  mlstudioModelId: { type: String },\n  isActive: { type: Boolean, default: false },\n  createdBy: { type: Schema.Types.ObjectId, ref: 'User' }\n}, {\n  timestamps: true\n});\n\nMLModelSchema.index({ status: 1 });\nMLModelSchema.index({ isActive: 1 });\nMLModelSchema.index({ createdAt: -1 });\n\nexport const MLModel = mongoose.model<IMLModel>('MLModel', MLModelSchema);\n","path":null,"size_bytes":1800,"size_tokens":null},"server/routes/models.ts":{"content":"import { Router, Response } from 'express';\nimport { MLModel } from '../db/models';\nimport { authMiddleware, AuthRequest } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.get('/', async (req, res: Response) => {\n  try {\n    const models = await MLModel.find()\n      .sort({ createdAt: -1 })\n      .limit(20);\n\n    res.json(models.map(m => ({\n      id: m._id,\n      name: m.name,\n      version: m.version,\n      description: m.description,\n      status: m.status,\n      accuracy: m.accuracy,\n      precision: m.precision,\n      recall: m.recall,\n      f1Score: m.f1Score,\n      totalSamples: m.totalSamples,\n      isActive: m.isActive,\n      createdAt: m.createdAt\n    })));\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch models' });\n  }\n});\n\nrouter.get('/active', async (req, res: Response) => {\n  try {\n    const activeModel = await MLModel.findOne({ isActive: true, status: 'ready' });\n    \n    if (!activeModel) {\n      res.json({\n        available: false,\n        message: 'We are currently working on our AI model. The scanner is running in simulation mode.',\n        suggestion: 'You can still use the scanner to understand material properties and eco-friendly alternatives.'\n      });\n      return;\n    }\n\n    res.json({\n      available: true,\n      model: {\n        id: activeModel._id,\n        name: activeModel.name,\n        version: activeModel.version,\n        description: activeModel.description,\n        accuracy: activeModel.accuracy,\n        precision: activeModel.precision,\n        recall: activeModel.recall,\n        f1Score: activeModel.f1Score\n      }\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch active model' });\n  }\n});\n\nrouter.get('/stats', authMiddleware, async (req: AuthRequest, res: Response) => {\n  try {\n    const totalModels = await MLModel.countDocuments();\n    const readyModels = await MLModel.countDocuments({ status: 'ready' });\n    const trainingModels = await MLModel.countDocuments({ status: 'training' });\n    const activeModel = await MLModel.findOne({ isActive: true });\n\n    res.json({\n      totalModels,\n      readyModels,\n      trainingModels,\n      activeModel: activeModel ? {\n        id: activeModel._id,\n        name: activeModel.name,\n        version: activeModel.version,\n        accuracy: activeModel.accuracy\n      } : null\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch model stats' });\n  }\n});\n\nrouter.get('/:id', async (req, res: Response) => {\n  try {\n    const model = await MLModel.findById(req.params.id);\n    \n    if (!model) {\n      res.status(404).json({ error: 'Model not found' });\n      return;\n    }\n\n    res.json({\n      id: model._id,\n      name: model.name,\n      version: model.version,\n      description: model.description,\n      status: model.status,\n      accuracy: model.accuracy,\n      precision: model.precision,\n      recall: model.recall,\n      f1Score: model.f1Score,\n      totalSamples: model.totalSamples,\n      epochs: model.epochs,\n      trainingTime: model.trainingTime,\n      isActive: model.isActive,\n      createdAt: model.createdAt,\n      updatedAt: model.updatedAt\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch model' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":3282,"size_tokens":null},"MLStudio-main/worker/add_training_images.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nScript to add more training images to MongoDB for improved model training.\nThis script can download images from URLs or process local images.\n\"\"\"\n\nimport os\nimport sys\nimport json\nimport io\nimport requests\nfrom pathlib import Path\nfrom PIL import Image\nfrom pymongo import MongoClient\nimport hashlib\nimport time\n\nMATERIAL_CATEGORIES = {\n    'bricks': {\n        'keywords': ['red brick wall', 'clay brick texture', 'brick masonry', 'brick pattern'],\n        'description': 'Common clay bricks used in construction'\n    },\n    'concrete': {\n        'keywords': ['concrete texture', 'gray concrete wall', 'concrete surface', 'cement texture'],\n        'description': 'Standard mix concrete for structural elements'\n    },\n    'aggregate': {\n        'keywords': ['gravel texture', 'crushed stone', 'aggregate pile', 'construction gravel'],\n        'description': 'Crushed stone or gravel for construction'\n    },\n    'aerated_block': {\n        'keywords': ['aac block', 'autoclaved aerated concrete', 'lightweight block', 'aerated concrete block'],\n        'description': 'Autoclaved aerated concrete blocks'\n    },\n    'concrete_block': {\n        'keywords': ['concrete block wall', 'cinder block', 'masonry block', 'CMU block'],\n        'description': 'Medium density concrete masonry blocks'\n    },\n    'limestone_block': {\n        'keywords': ['limestone wall', 'limestone texture', 'natural stone block', 'limestone masonry'],\n        'description': 'Natural limestone building blocks'\n    },\n    'rammed_earth': {\n        'keywords': ['rammed earth wall', 'earth construction', 'compressed earth', 'pisÃ© wall'],\n        'description': 'Compacted earth construction without cement'\n    },\n    'timber': {\n        'keywords': ['wood grain', 'timber texture', 'wooden planks', 'lumber surface'],\n        'description': 'General timber products'\n    },\n    'steel': {\n        'keywords': ['steel beam', 'metal texture', 'steel structure', 'galvanized steel'],\n        'description': 'General steel products with average recycled content'\n    },\n    'glass': {\n        'keywords': ['glass panel', 'window glass', 'float glass', 'glass facade'],\n        'description': 'Float glass for windows and facades'\n    }\n}\n\nSAMPLE_IMAGES = {\n    'bricks': [\n        'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400',\n        'https://images.unsplash.com/photo-1587582423116-ec07293f0395?w=400',\n    ],\n    'concrete': [\n        'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400',\n    ],\n    'timber': [\n        'https://images.unsplash.com/photo-1541123603104-512919d6a96c?w=400',\n    ]\n}\n\n\ndef get_image_hash(img_data):\n    \"\"\"Generate hash for image data to avoid duplicates\"\"\"\n    return hashlib.md5(img_data).hexdigest()\n\n\ndef download_image(url, timeout=10):\n    \"\"\"Download image from URL\"\"\"\n    try:\n        headers = {\n            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'\n        }\n        response = requests.get(url, headers=headers, timeout=timeout)\n        response.raise_for_status()\n        return response.content\n    except Exception as e:\n        print(f\"Error downloading {url}: {e}\")\n        return None\n\n\ndef process_image(img_data, target_size=(224, 224)):\n    \"\"\"Process image data and resize\"\"\"\n    try:\n        img = Image.open(io.BytesIO(img_data))\n        img = img.convert('RGB')\n        \n        width, height = img.size\n        min_dim = min(width, height)\n        left = (width - min_dim) // 2\n        top = (height - min_dim) // 2\n        right = left + min_dim\n        bottom = top + min_dim\n        img = img.crop((left, top, right, bottom))\n        \n        img = img.resize(target_size, Image.Resampling.LANCZOS)\n        \n        buffer = io.BytesIO()\n        img.save(buffer, format='JPEG', quality=95)\n        return buffer.getvalue()\n    except Exception as e:\n        print(f\"Error processing image: {e}\")\n        return None\n\n\ndef add_image_to_mongodb(mongo_uri, material_key, img_data, filename, source='manual'):\n    \"\"\"Add a single image to MongoDB\"\"\"\n    try:\n        client = MongoClient(mongo_uri)\n        db = client['Construction_test']\n        collection = db['materialimages']\n        \n        img_hash = get_image_hash(img_data)\n        existing = collection.find_one({'hash': img_hash})\n        if existing:\n            print(f\"Image already exists in database (hash: {img_hash[:8]}...)\")\n            client.close()\n            return False\n        \n        processed_data = process_image(img_data)\n        if processed_data is None:\n            client.close()\n            return False\n        \n        doc = {\n            'material_key': material_key,\n            'material_official': material_key,\n            'filename': filename,\n            'data': processed_data,\n            'hash': img_hash,\n            'source': source,\n            'size': len(processed_data),\n            'added_at': time.time()\n        }\n        \n        collection.insert_one(doc)\n        print(f\"Added image '{filename}' for material '{material_key}'\")\n        \n        client.close()\n        return True\n    except Exception as e:\n        print(f\"Error adding image to MongoDB: {e}\")\n        return False\n\n\ndef add_images_from_directory(mongo_uri, directory, material_key):\n    \"\"\"Add all images from a directory for a specific material\"\"\"\n    directory = Path(directory)\n    if not directory.exists():\n        print(f\"Directory not found: {directory}\")\n        return 0\n    \n    count = 0\n    for img_path in directory.glob('*'):\n        if img_path.suffix.lower() in ['.jpg', '.jpeg', '.png', '.webp', '.bmp']:\n            try:\n                with open(img_path, 'rb') as f:\n                    img_data = f.read()\n                if add_image_to_mongodb(mongo_uri, material_key, img_data, img_path.name, 'local'):\n                    count += 1\n            except Exception as e:\n                print(f\"Error processing {img_path}: {e}\")\n    \n    return count\n\n\ndef add_images_from_urls(mongo_uri, material_key, urls):\n    \"\"\"Add images from a list of URLs\"\"\"\n    count = 0\n    for i, url in enumerate(urls):\n        print(f\"Downloading image {i+1}/{len(urls)} for {material_key}...\")\n        img_data = download_image(url)\n        if img_data:\n            filename = f\"{material_key}_{i+1}_{int(time.time())}.jpg\"\n            if add_image_to_mongodb(mongo_uri, material_key, img_data, filename, 'url'):\n                count += 1\n        time.sleep(0.5)\n    return count\n\n\ndef get_dataset_stats(mongo_uri):\n    \"\"\"Get statistics about the current dataset\"\"\"\n    try:\n        client = MongoClient(mongo_uri)\n        db = client['Construction_test']\n        collection = db['materialimages']\n        \n        pipeline = [\n            {'$group': {'_id': '$material_key', 'count': {'$sum': 1}}}\n        ]\n        stats = list(collection.aggregate(pipeline))\n        \n        total = sum(s['count'] for s in stats)\n        \n        print(\"\\n\" + \"=\" * 50)\n        print(\"DATASET STATISTICS\")\n        print(\"=\" * 50)\n        print(f\"Total images: {total}\")\n        print(\"\\nImages per class:\")\n        for s in sorted(stats, key=lambda x: x['count'], reverse=True):\n            print(f\"  {s['_id']}: {s['count']} images\")\n        \n        min_samples = min(s['count'] for s in stats) if stats else 0\n        recommended = max(100, min_samples)\n        \n        print(f\"\\nMinimum samples per class: {min_samples}\")\n        print(f\"Recommended minimum: {recommended}\")\n        \n        if min_samples < 50:\n            print(\"\\nWARNING: Some classes have very few samples.\")\n            print(\"Consider adding more images for better training results.\")\n        \n        client.close()\n        return stats\n    except Exception as e:\n        print(f\"Error getting stats: {e}\")\n        return []\n\n\ndef balance_dataset(mongo_uri, target_per_class=100):\n    \"\"\"Suggest which classes need more images\"\"\"\n    stats = get_dataset_stats(mongo_uri)\n    \n    print(\"\\n\" + \"=\" * 50)\n    print(\"DATASET BALANCE ANALYSIS\")\n    print(\"=\" * 50)\n    \n    for s in stats:\n        material_key = s['_id']\n        count = s['count']\n        needed = max(0, target_per_class - count)\n        \n        if needed > 0:\n            print(f\"\\n{material_key}:\")\n            print(f\"  Current: {count} images\")\n            print(f\"  Needed: {needed} more images\")\n            if material_key in MATERIAL_CATEGORIES:\n                keywords = MATERIAL_CATEGORIES[material_key]['keywords']\n                print(f\"  Search keywords: {', '.join(keywords)}\")\n\n\ndef main():\n    import argparse\n    \n    parser = argparse.ArgumentParser(description='Manage training images in MongoDB')\n    parser.add_argument('--mongo-uri', required=True, help='MongoDB connection URI')\n    parser.add_argument('--action', choices=['stats', 'balance', 'add-dir', 'add-urls'], \n                        default='stats', help='Action to perform')\n    parser.add_argument('--material', help='Material key for adding images')\n    parser.add_argument('--directory', help='Directory containing images')\n    parser.add_argument('--urls', nargs='+', help='URLs of images to add')\n    parser.add_argument('--target', type=int, default=100, help='Target images per class')\n    \n    args = parser.parse_args()\n    \n    if args.action == 'stats':\n        get_dataset_stats(args.mongo_uri)\n    \n    elif args.action == 'balance':\n        balance_dataset(args.mongo_uri, args.target)\n    \n    elif args.action == 'add-dir':\n        if not args.material or not args.directory:\n            print(\"Error: --material and --directory required for add-dir\")\n            sys.exit(1)\n        count = add_images_from_directory(args.mongo_uri, args.directory, args.material)\n        print(f\"\\nAdded {count} images for {args.material}\")\n    \n    elif args.action == 'add-urls':\n        if not args.material or not args.urls:\n            print(\"Error: --material and --urls required for add-urls\")\n            sys.exit(1)\n        count = add_images_from_urls(args.mongo_uri, args.material, args.urls)\n        print(f\"\\nAdded {count} images for {args.material}\")\n\n\nif __name__ == '__main__':\n    main()\n","path":null,"size_bytes":10141,"size_tokens":null},"server/services/modelInference.ts":{"content":"import { spawn } from 'child_process';\nimport path from 'path';\nimport fs from 'fs';\n\ninterface PredictionResult {\n  predictions: Array<{\n    class: string;\n    className: string;\n    confidence: number;\n  }>;\n  topPrediction: {\n    class: string;\n    className: string;\n    confidence: number;\n  };\n  modelUsed: string;\n  isSimulation: boolean;\n}\n\ninterface ModelInfo {\n  modelPath: string;\n  labelsPath: string;\n  classes: string[];\n  classIndices: Record<string, string>;\n  inputShape: number[];\n}\n\nconst MATERIAL_NAMES: Record<string, string> = {\n  'bricks': 'Bricks (common)',\n  'concrete': 'Concrete (1:1.5:3)',\n  'aggregate': 'Aggregate',\n  'aerated_block': 'Aerated block',\n  'concrete_block': 'Concrete block',\n  'limestone_block': 'Limestone block',\n  'rammed_earth': 'Rammed earth',\n  'timber': 'Timber (general)',\n  'steel': 'Steel (general)',\n  'glass': 'Glass (float)',\n  'aluminum': 'Aluminum (general)',\n  'insulation_mineral_wool': 'Mineral wool insulation',\n  'insulation_cellulose': 'Cellulose insulation',\n  'plasterboard': 'Plasterboard',\n  'ceramic_tiles': 'Ceramic tiles'\n};\n\nexport async function predictWithModel(\n  imagePath: string, \n  modelInfo: ModelInfo\n): Promise<PredictionResult> {\n  return new Promise((resolve, reject) => {\n    const pythonScript = path.join(__dirname, '..', '..', 'MLStudio-main', 'worker', 'predict.py');\n    \n    if (!fs.existsSync(pythonScript)) {\n      console.log('Python inference script not found, using simulation');\n      resolve(simulatePrediction());\n      return;\n    }\n\n    if (!fs.existsSync(modelInfo.modelPath)) {\n      console.log('Model file not found, using simulation');\n      resolve(simulatePrediction());\n      return;\n    }\n\n    const pythonProcess = spawn('python3', [\n      pythonScript,\n      '--image', imagePath,\n      '--model', modelInfo.modelPath,\n      '--labels', modelInfo.labelsPath\n    ]);\n\n    let stdout = '';\n    let stderr = '';\n\n    pythonProcess.stdout.on('data', (data) => {\n      stdout += data.toString();\n    });\n\n    pythonProcess.stderr.on('data', (data) => {\n      stderr += data.toString();\n    });\n\n    pythonProcess.on('close', (code) => {\n      if (code === 0) {\n        try {\n          const result = JSON.parse(stdout);\n          const predictions = result.predictions.map((p: any) => ({\n            class: p.class,\n            className: MATERIAL_NAMES[p.class] || p.class,\n            confidence: p.confidence\n          }));\n          \n          predictions.sort((a: any, b: any) => b.confidence - a.confidence);\n          \n          resolve({\n            predictions: predictions.slice(0, 5),\n            topPrediction: predictions[0],\n            modelUsed: result.model || 'MLStudio Model',\n            isSimulation: false\n          });\n        } catch (e) {\n          console.error('Error parsing prediction result:', e);\n          resolve(simulatePrediction());\n        }\n      } else {\n        console.error('Python inference failed:', stderr);\n        resolve(simulatePrediction());\n      }\n    });\n\n    pythonProcess.on('error', (err) => {\n      console.error('Failed to start Python process:', err);\n      resolve(simulatePrediction());\n    });\n\n    setTimeout(() => {\n      pythonProcess.kill();\n      console.log('Prediction timeout, using simulation');\n      resolve(simulatePrediction());\n    }, 30000);\n  });\n}\n\nfunction simulatePrediction(): PredictionResult {\n  const materialKeys = Object.keys(MATERIAL_NAMES);\n  const randomIndex = Math.floor(Math.random() * materialKeys.length);\n  const predictedKey = materialKeys[randomIndex];\n  \n  const predictions = materialKeys.map((key) => {\n    let confidence = Math.random() * 0.3 + 0.05;\n    if (key === predictedKey) {\n      confidence = Math.random() * 0.25 + 0.70;\n    }\n    return {\n      class: key,\n      className: MATERIAL_NAMES[key],\n      confidence\n    };\n  });\n\n  const totalConfidence = predictions.reduce((sum, p) => sum + p.confidence, 0);\n  predictions.forEach(p => p.confidence = p.confidence / totalConfidence);\n  predictions.sort((a, b) => b.confidence - a.confidence);\n\n  return {\n    predictions: predictions.slice(0, 5),\n    topPrediction: predictions[0],\n    modelUsed: 'EcoBuild Simulation',\n    isSimulation: true\n  };\n}\n\nexport async function checkModelAvailability(modelPath: string): Promise<boolean> {\n  try {\n    return fs.existsSync(modelPath);\n  } catch {\n    return false;\n  }\n}\n","path":null,"size_bytes":4386,"size_tokens":null},"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","path":null,"size_bytes":96,"size_tokens":null},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.12\"\ndependencies = [\n    \"numpy>=2.3.5\",\n    \"pillow>=12.0.0\",\n    \"pymongo>=4.15.5\",\n    \"scikit-learn>=1.7.2\",\n    \"tensorflow>=2.20.0\",\n]\n","path":null,"size_bytes":262,"size_tokens":null},"MLStudio-main/worker/sync_model_to_ecobuild.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nScript to sync trained models from MLStudio to EcoBuild.\nThis creates/updates the MLModel entry in EcoBuild's MongoDB collection.\n\"\"\"\n\nimport os\nimport sys\nimport json\nimport argparse\nfrom pathlib import Path\nfrom datetime import datetime\nfrom pymongo import MongoClient\n\n\ndef sync_model(model_id: str, mongo_uri: str, activate: bool = True):\n    \"\"\"Sync a trained model to EcoBuild's MLModel collection\"\"\"\n    \n    model_dir = Path(f\"./data/models/{model_id}\")\n    \n    if not model_dir.exists():\n        print(f\"Error: Model directory not found: {model_dir}\")\n        return False\n    \n    metadata_path = model_dir / 'metadata.json'\n    if not metadata_path.exists():\n        print(f\"Error: Metadata file not found: {metadata_path}\")\n        return False\n    \n    with open(metadata_path, 'r') as f:\n        metadata = json.load(f)\n    \n    model_path = model_dir / 'model.keras'\n    if not model_path.exists():\n        model_path = model_dir / 'best_model.keras'\n        if not model_path.exists():\n            print(f\"Error: Model file not found in {model_dir}\")\n            return False\n    \n    print(f\"Syncing model: {model_id}\")\n    print(f\"  Classes: {metadata.get('classes', [])}\")\n    print(f\"  Accuracy: {metadata.get('final_val_accuracy', 0):.4f}\")\n    print(f\"  Model path: {model_path}\")\n    \n    try:\n        client = MongoClient(mongo_uri)\n        db = client['Construction_test']\n        ml_models = db['mlmodels']\n        \n        version = f\"v{datetime.now().strftime('%Y%m%d.%H%M')}\"\n        \n        model_doc = {\n            'name': f\"EcoBuild Material Detector\",\n            'version': version,\n            'description': f\"Trained on {metadata.get('original_samples', 0)} samples, {metadata.get('num_classes', 0)} material classes\",\n            'status': 'ready',\n            'accuracy': float(metadata.get('final_val_accuracy', 0)),\n            'precision': float(metadata.get('precision', 0)),\n            'recall': float(metadata.get('recall', 0)),\n            'f1Score': float(metadata.get('f1_score', 0)),\n            'totalSamples': int(metadata.get('original_samples', 0)),\n            'epochs': int(metadata.get('epochs_trained', 0)),\n            'trainingTime': 0,\n            'modelPath': str(model_path.absolute()),\n            'labelsPath': str((model_dir / 'labels.json').absolute()),\n            'classes': metadata.get('classes', []),\n            'classIndices': metadata.get('class_indices', {}),\n            'inputShape': metadata.get('input_shape', [224, 224, 3]),\n            'architecture': metadata.get('model_architecture', 'EfficientNetB0'),\n            'mlstudioModelId': model_id,\n            'isActive': False,\n            'createdAt': datetime.now(),\n            'updatedAt': datetime.now()\n        }\n        \n        existing = ml_models.find_one({'mlstudioModelId': model_id})\n        \n        if existing:\n            ml_models.update_one(\n                {'mlstudioModelId': model_id},\n                {'$set': {**model_doc, 'updatedAt': datetime.now()}}\n            )\n            print(f\"Updated existing model entry\")\n            mongo_id = existing['_id']\n        else:\n            result = ml_models.insert_one(model_doc)\n            mongo_id = result.inserted_id\n            print(f\"Created new model entry with ID: {mongo_id}\")\n        \n        if activate:\n            ml_models.update_many(\n                {'_id': {'$ne': mongo_id}},\n                {'$set': {'isActive': False}}\n            )\n            ml_models.update_one(\n                {'_id': mongo_id},\n                {'$set': {'isActive': True}}\n            )\n            print(f\"Model activated as the primary model for EcoBuild\")\n        \n        final_model = ml_models.find_one({'_id': mongo_id})\n        print(\"\\nModel synced successfully!\")\n        print(f\"  MongoDB ID: {mongo_id}\")\n        print(f\"  Name: {final_model['name']}\")\n        print(f\"  Version: {final_model['version']}\")\n        print(f\"  Accuracy: {final_model['accuracy']:.4f}\")\n        print(f\"  Active: {final_model['isActive']}\")\n        \n        client.close()\n        return True\n        \n    except Exception as e:\n        print(f\"Error syncing model: {e}\")\n        import traceback\n        traceback.print_exc()\n        return False\n\n\ndef list_available_models():\n    \"\"\"List all trained models available for syncing\"\"\"\n    models_dir = Path(\"./data/models\")\n    \n    if not models_dir.exists():\n        print(\"No models directory found\")\n        return []\n    \n    models = []\n    for model_dir in models_dir.iterdir():\n        if model_dir.is_dir():\n            metadata_path = model_dir / 'metadata.json'\n            if metadata_path.exists():\n                with open(metadata_path, 'r') as f:\n                    metadata = json.load(f)\n                models.append({\n                    'id': model_dir.name,\n                    'accuracy': metadata.get('final_val_accuracy', 0),\n                    'classes': metadata.get('num_classes', 0),\n                    'samples': metadata.get('original_samples', 0)\n                })\n    \n    if models:\n        print(\"\\nAvailable models:\")\n        print(\"-\" * 60)\n        for m in sorted(models, key=lambda x: x['accuracy'], reverse=True):\n            print(f\"  {m['id']}\")\n            print(f\"    Accuracy: {m['accuracy']:.4f}\")\n            print(f\"    Classes: {m['classes']}\")\n            print(f\"    Samples: {m['samples']}\")\n    else:\n        print(\"No trained models found\")\n    \n    return models\n\n\ndef list_ecobuild_models(mongo_uri: str):\n    \"\"\"List models currently in EcoBuild\"\"\"\n    try:\n        client = MongoClient(mongo_uri)\n        db = client['Construction_test']\n        ml_models = db['mlmodels']\n        \n        models = list(ml_models.find().sort('createdAt', -1))\n        \n        if models:\n            print(\"\\nModels in EcoBuild:\")\n            print(\"-\" * 60)\n            for m in models:\n                active_marker = \" [ACTIVE]\" if m.get('isActive') else \"\"\n                print(f\"  {m.get('name', 'Unknown')} {m.get('version', '')}{active_marker}\")\n                print(f\"    ID: {m['_id']}\")\n                print(f\"    Accuracy: {m.get('accuracy', 0):.4f}\")\n                print(f\"    Status: {m.get('status', 'unknown')}\")\n                print(f\"    MLStudio ID: {m.get('mlstudioModelId', 'N/A')}\")\n        else:\n            print(\"No models found in EcoBuild\")\n        \n        client.close()\n        return models\n    except Exception as e:\n        print(f\"Error listing EcoBuild models: {e}\")\n        return []\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Sync trained models to EcoBuild')\n    parser.add_argument('--mongo-uri', required=True, help='MongoDB connection URI')\n    parser.add_argument('--action', choices=['sync', 'list-local', 'list-ecobuild'], \n                        default='list-local', help='Action to perform')\n    parser.add_argument('--model-id', help='Model ID to sync')\n    parser.add_argument('--activate', action='store_true', default=True,\n                        help='Activate this model in EcoBuild (default: True)')\n    parser.add_argument('--no-activate', action='store_false', dest='activate',\n                        help='Do not activate this model')\n    \n    args = parser.parse_args()\n    \n    if args.action == 'list-local':\n        list_available_models()\n    \n    elif args.action == 'list-ecobuild':\n        list_ecobuild_models(args.mongo_uri)\n    \n    elif args.action == 'sync':\n        if not args.model_id:\n            print(\"Error: --model-id required for sync action\")\n            sys.exit(1)\n        \n        success = sync_model(args.model_id, args.mongo_uri, args.activate)\n        if not success:\n            sys.exit(1)\n\n\nif __name__ == '__main__':\n    main()\n","path":null,"size_bytes":7765,"size_tokens":null},"MLStudio-main/worker/predict.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nScript to run inference using a trained model.\nUsed by EcoBuild to make predictions on uploaded images.\n\"\"\"\n\nimport os\nimport sys\nimport json\nimport argparse\nimport numpy as np\nfrom pathlib import Path\nimport io\n\nos.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'\n\ntry:\n    import tensorflow as tf\n    from tensorflow import keras\n    from PIL import Image\n    TF_AVAILABLE = True\nexcept ImportError:\n    TF_AVAILABLE = False\n\n\ndef load_and_preprocess_image(image_path: str, target_size=(224, 224)):\n    \"\"\"Load and preprocess an image for prediction\"\"\"\n    img = Image.open(image_path)\n    img = img.convert('RGB')\n    img = img.resize(target_size, Image.Resampling.LANCZOS)\n    img_array = np.array(img).astype(np.float32)\n    img_array = (img_array - 127.5) / 127.5\n    img_array = np.expand_dims(img_array, axis=0)\n    return img_array\n\n\ndef predict(image_path: str, model_path: str, labels_path: str):\n    \"\"\"Run prediction on an image using the trained model\"\"\"\n    \n    if not TF_AVAILABLE:\n        return {\n            'error': 'TensorFlow not available',\n            'predictions': []\n        }\n    \n    if not os.path.exists(model_path):\n        return {\n            'error': f'Model not found: {model_path}',\n            'predictions': []\n        }\n    \n    if not os.path.exists(labels_path):\n        return {\n            'error': f'Labels not found: {labels_path}',\n            'predictions': []\n        }\n    \n    if not os.path.exists(image_path):\n        return {\n            'error': f'Image not found: {image_path}',\n            'predictions': []\n        }\n    \n    try:\n        with open(labels_path, 'r') as f:\n            labels_map = json.load(f)\n        \n        labels_map = {int(k): v for k, v in labels_map.items()}\n        \n        model = keras.models.load_model(model_path, compile=False)\n        \n        img_array = load_and_preprocess_image(image_path)\n        \n        predictions = model.predict(img_array, verbose=0)\n        \n        pred_classes = []\n        for idx, confidence in enumerate(predictions[0]):\n            class_name = labels_map.get(idx, f'class_{idx}')\n            pred_classes.append({\n                'class': class_name,\n                'confidence': float(confidence)\n            })\n        \n        pred_classes.sort(key=lambda x: x['confidence'], reverse=True)\n        \n        return {\n            'predictions': pred_classes,\n            'model': os.path.basename(model_path),\n            'success': True\n        }\n        \n    except Exception as e:\n        return {\n            'error': str(e),\n            'predictions': []\n        }\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Run inference on an image')\n    parser.add_argument('--image', required=True, help='Path to image file')\n    parser.add_argument('--model', required=True, help='Path to model file')\n    parser.add_argument('--labels', required=True, help='Path to labels JSON file')\n    \n    args = parser.parse_args()\n    \n    result = predict(args.image, args.model, args.labels)\n    \n    print(json.dumps(result))\n\n\nif __name__ == '__main__':\n    main()\n","path":null,"size_bytes":3119,"size_tokens":null}},"version":2}